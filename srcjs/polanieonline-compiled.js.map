{
"version":3,
"file":"srcjs/stendhal-compiled.js",
"lineCount":4508,
"mappings":"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",
"sources":[" [synthetic:es6/util/arrayiterator] "," [synthetic:es6/util/makeiterator] "," [synthetic:util/objectcreate] "," [synthetic:util/defineproperty] "," [synthetic:util/global] "," [synthetic:util/polyfill] "," [synthetic:es6/util/setprototypeof] "," [synthetic:es6/util/inherits] "," [synthetic:es6/util/restarguments] "," [synthetic:es6/promise/promise] "," [synthetic:es6/array/fill] "," [synthetic:es6/typedarray/fill] "," [synthetic:es6/object/is] "," [synthetic:es6/array/includes] "," [synthetic:es6/string/includes] "," [synthetic:util/checkstringargs] "," [synthetic:es6/symbol] "," [synthetic:es6/util/iteratorfromarray] "," [synthetic:es6/array/keys] ","build/js/marauroa.js","build/js/client-framework.js","build/js/message-factory.js","build/js/perception.js","build/js/rpfactory.js","build/js/inflate.js","build/js/deserializer.js","srcjs/stendhal/config.js","build/js/build.js","srcjs/jsxgraph-util.js","srcjs/stendhal/data/cache.js","srcjs/stendhal/data/cstatus.js","srcjs/stendhal/data/group.js","srcjs/stendhal/data/map.js","srcjs/stendhal/data/sha3.js","srcjs/stendhal/data/sprites.js","srcjs/stendhal/entity/entity.js","srcjs/stendhal/entity/unknown.js","srcjs/stendhal/entity/blood.js","srcjs/stendhal/entity/corpse.js","srcjs/stendhal/entity/chest.js","srcjs/stendhal/entity/food.js","srcjs/stendhal/entity/gate.js","srcjs/stendhal/entity/invisibleentity.js","srcjs/stendhal/entity/item.js","srcjs/stendhal/entity/portal.js","srcjs/stendhal/entity/activeentity.js","srcjs/stendhal/entity/gameboard.js","srcjs/stendhal/entity/rpentity.js","srcjs/stendhal/entity/player.js","srcjs/stendhal/entity/creature.js","srcjs/stendhal/entity/domesticanimal.js","srcjs/stendhal/entity/npc.js","srcjs/stendhal/entity/sign.js","srcjs/stendhal/entity/growingspawner.js","srcjs/stendhal/entity/door.js","srcjs/stendhal/entity/useableentity.js","srcjs/stendhal/entity/visibleentity.js","srcjs/stendhal/entity/walkblocker.js","srcjs/stendhal/entity/zone.js","srcjs/stendhal/entity/ground.js","srcjs/stendhal/ui/setdragimage-ie.js","srcjs/stendhal/ui/buddylist.js","srcjs/stendhal/ui/chatlog.js","srcjs/stendhal/ui/gamewindow.js","srcjs/stendhal/ui/html.js","srcjs/stendhal/ui/minimap.js","srcjs/stendhal/ui/keyhandler.js","srcjs/stendhal/ui/sound.js","srcjs/stendhal/ui/stats.js","srcjs/stendhal/ui/chatinput.js","srcjs/stendhal/actions.js","srcjs/stendhal/events.js","srcjs/stendhal/ui/popup.js","srcjs/stendhal/ui/itemcontainer.js","srcjs/stendhal/ui/menu.js","srcjs/stendhal/ui/outfitdialog.js","srcjs/stendhal/ui/travellog.js","srcjs/stendhal/ui/settings.js","srcjs/stendhal/main.js"],
"sourcesContent":["/*\n * Copyright 2016 The Closure Compiler Authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Utility method for creating an iterator for Arrays.\n */\n'require base';\n\n/**\n * Returns an internal iterator from the given array.\n * @param {!IArrayLike<T>} array\n * @return {function():!IIterableResult<T>}\n * @template T\n */\n$jscomp.arrayIteratorImpl = function(array) {\n  var index = 0;\n  return function() {\n    if (index < array.length) {\n      return {\n        done: false,\n        value: array[index++],\n      };\n    } else {\n      return {done: true};\n    }\n  };\n};\n\n/**\n * Returns an internal iterator from the given array.\n * @param {!Array<T>} array\n * @return {!Iterator<T>}\n * @template T\n */\n$jscomp.arrayIterator = function(array) {\n  return /** @type {!Iterator<T>} */ ({next: $jscomp.arrayIteratorImpl(array)});\n};\n\n","/*\n * Copyright 2016 The Closure Compiler Authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Polyfill for for-of loops.\n */\n'require es6/util/arrayiterator';\n\n/**\n * Creates an iterator for the given iterable.  This iterator should never\n * be exposed to user code.\n *\n * @param {string|!Iterable<T>|!Iterator<T>|!Arguments} iterable\n * @return {!Iterator<T>}\n * @template T\n * @suppress {reportUnknownTypes}\n */\n$jscomp.makeIterator = function(iterable) {\n  // NOTE: Disabling typechecking because [] not allowed on @struct.\n  var iteratorFunction = typeof Symbol != 'undefined' && Symbol.iterator &&\n      (/** @type {?} */ (iterable)[Symbol.iterator]);\n  return iteratorFunction ? iteratorFunction.call(iterable) :\n      $jscomp.arrayIterator(/** @type {!Array} */ (iterable));\n};\n","/*\n * Copyright 2017 The Closure Compiler Authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Provides a partial internal polyfill for Object.create.\n */\n'require util/defines';\n\n\n/**\n * Polyfill for Object.create() method:\n * https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/create\n *\n * Does not implement the second argument.\n * @param {!Object} prototype\n * @return {!Object}\n */\n$jscomp.objectCreate =\n    ($jscomp.ASSUME_ES5 || typeof Object.create == 'function') ?\n    Object.create :\n    function(prototype) {\n      /** @constructor */\n      var ctor = function() {};\n      ctor.prototype = prototype;\n      return new ctor();\n    };\n","/*\n * Copyright 2016 The Closure Compiler Authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Provides methods to polyfill native objects.\n * @suppress {reportUnknownTypes}\n */\n'require util/defines';\n\n\n/**\n * Polyfill for Object.defineProperty() method:\n * https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/defineProperty\n *\n * Refuses to define properties on Array.prototype and Object.prototype,\n * since we can't make them non-enumerable and this messes up peoples' for\n * loops.  Beyond this, we simply assign values and not worry\n * about enumerability or writeability.\n *\n * @type {(typeof Object.defineProperty)}\n * @suppress {reportUnknownTypes}\n */\n$jscomp.defineProperty =\n    $jscomp.ASSUME_ES5 || typeof Object.defineProperties == 'function' ?\n    Object.defineProperty :\n    function(target, property, descriptor) {\n      if (target == Array.prototype ||\n          // b/155133192\n          /** @type {?} */ (target) == Object.prototype) {\n        return target;\n      }\n\n      /**\n       * NOTE: This is currently never called with a descriptor outside\n       * the control of the compiler.  If we ever decide to polyfill either\n       * Object.defineProperty or Reflect.defineProperty for ES3, we should\n       * explicitly check for `get` or `set` on the descriptor and throw a\n       * TypeError, since it's impossible to properly polyfill it.\n       */\n      target[property] = descriptor.value;\n      return target;\n    };\n","/*\n * Copyright 2016 The Closure Compiler Authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Runtime code to store the global object.\n * @suppress {uselessCode}\n */\n'require base';\n\n/**\n * Locate and return a reference to the global object.\n *\n * NOTE: This method is marked with `noinline`, because `RemoveUnusedCode` has\n * trouble removing the loop it contains if it gets inlined into the global\n * scope.\n * @param {?Object} passedInThis\n * @return {!Global} The global object.\n * @suppress {undefinedVars|reportUnknownTypes}\n * @noinline\n */\n$jscomp.getGlobal = function(passedInThis) {\n  var possibleGlobals = [\n    // Web Audio Worklets do not have any way to refer to their global object\n    // other than `globalThis`.\n    // This use of `globalThis` does not prevent removal of the `globalThis`\n    // polyfill, because the usage is guarded by a typeof check.\n    'object' == typeof globalThis && globalThis,\n    // Rhino (used by older Google Docs Script projects) has no `window` or\n    // `self`, but `this` from the global scope is the global object. Also,\n    // some GWT tests running on Rhino do have a `window` and `self` but, for\n    // unknown reasons, see runtime exceptions when we return `window` instead\n    // of `passedInThis`.\n    // NOTE: If the compiler's output is wrapped in a strict-mode function,\n    // this file's code won't actually be executing in global scope, so this\n    // value will be undefined.\n    passedInThis,\n    // Browser windows always have `window`\n    'object' == typeof window && window,\n    // WebWorkers have `self`\n    'object' == typeof self && self,\n    // NodeJS has `global`\n    'object' == typeof global && global,\n  ];\n  for (var i = 0; i < possibleGlobals.length; ++i) {\n    var maybeGlobal = possibleGlobals[i];\n    // It can happen that an environment has, for example, both `global` and\n    // `window` defined in the global scope, but one of them isn't actually\n    // the global object, so check that it really seems to be the global object.\n    // We use `Math` to check for this because it's only 4 characters long,\n    // exists in all possible JS environments, and doesn't have the problematic\n    // equality behavior of `NaN`.\n    if (maybeGlobal && maybeGlobal['Math'] == Math) {\n      return /** @type {!Global} */ (maybeGlobal);\n    }\n  }\n  // Throw an exception if we cannot find the global object.\n  // We have to be sneaky about it, otherwise the compiler will think this code\n  // has a side effect (throwing an exception) that prevents it from being\n  // removed, even when all usages of `$jscomp.global` get removed.\n  // Casting through unknown is necessary to keep the compiler from rejecting\n  // this code.\n  return /** @type {!Global} */ (\n      /** @type {?} */ ({\n        valueOf: function() {\n          throw new Error('Cannot find global object');\n        }\n      }.valueOf()));\n};\n\n\n/**\n * The global object.\n * @const {!Global}\n */\n$jscomp.global = $jscomp.getGlobal(this);\n","/*\n * Copyright 2016 The Closure Compiler Authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Provides methods to polyfill native objects.\n * @suppress {uselessCode}\n */\n'require util/defineproperty';\n'require util/defines';\n'require util/global';\n'require util/shouldpolyfill';\n\n/** @const {!Object<string, ?>} map from classes (Map) to polyfills */\n$jscomp.polyfills = {};\n\n/**\n * Maps a property to an obfuscated look-up string for that property. Only used\n * when `$jscomp.ISOLATE_POLYFILLS is enabled.\n *\n * When compiling with polyfill isolation enabled, to polyfill an\n * `owner.prototype.method` the `$jscomp.polyfill` library function:\n * <ol>\n * <li> creates an obfuscated string for `method`\n * <li> adds the obfuscated string as a new property on the `owner` object\n * <li> assigns the polyfill implementation of `method` to this new obfuscated\n * property on the `owner` object. </li>\n *</ol>\n *\n * This maps the original property name `method` to the new obfuscated property\n * name.\n * @const {!Object<string, symbol>}\n */\n$jscomp.propertyToPolyfillSymbol = {};\n\n/** @const {string} */\n$jscomp.POLYFILL_PREFIX = '$jscp$';\n\n/**\n * Returns the polyfill function of the given property if present, otherwise\n * returns the actual property.\n *\n * This is a variable instead of a $jscomp.* property to make it simpler for\n * the compiler to avoid prematurely deleting it during optimizations.\n *\n * @param {*} target the receiver for the property access, e.g. `my.str` in\n *     `my.str.includes`\n * @param {string} property the name of the property, e.g. `includes` in\n *     `my.str.includes`\n * @return {?} if an obfuscated symbol for the property was added onto the\n *     target, then this function returns the polyfill for the property.\n *     Otherwise simply looks up the property on the target and returns it as\n *     `target[key]`.\n * @noinline prevent inlining so IsolatePolyfills can find this declaration.\n * @suppress {reportUnknownTypes}\n */\nvar $jscomp$lookupPolyfilledValue = function(target, property) {\n  /** @const */\n  var obfuscatedName = $jscomp.propertyToPolyfillSymbol[property];\n  if (obfuscatedName == null) {\n    return target[property];\n  }\n\n  // NOTE: this will throw if `target` is null or undefined.\n  /** @const */\n  var polyfill = target[obfuscatedName];\n\n  // Checking `polyfill !== undefined` is sufficient because $jscomp.polyfill\n  // never installs nullish polyfills. Otherwise we'd have to check something\n  // like `key in target`.\n  return polyfill !== undefined ? polyfill : target[property];\n};\n\n/**\n * @param {string} target Qualified name of the class or method to polyfill,\n *     e.g. 'Array.prototype.includes' or 'Map'.\n * @param {?function(*): *} polyfill A function that takes the current browser\n *     implementation of the target and returns an optional new polyfill\n *     implementation.  If null is returned, then no polyfill will be added.  A\n *     null argument for this parameter indicates that the function will not be\n *     polyfilled, and is only useful for `build_polyfill_table.js` bookkeeping.\n * @param {string} fromLang The language level in which the target is expected\n *     to already be present in the browser.  The compiler requires that\n *     `languageOut < fromLang` before injecting a polyfill (i.e. if the\n *     specified output language already includes the feature then there's no\n *     need to polyfill it).\n * @param {string} toLang The language level required by the polyfill\n *     implementation.  The compiler will issue an error if a polyfill is\n *     required, but `languageOut < toLang`.  Additionally, the\n *     `build_polyfill_table.js` script audits the polyfill dependency tree to\n *     ensure that no polyfill with a lower `toLang` depends on one with a\n *     higher `toLang`.\n * @noinline\n * NOTE: We prevent inlining so RemoveUnusedPolyfills can always recognize this\n * call.\n */\n$jscomp.polyfill = function(target, polyfill, fromLang, toLang) {\n  if (!polyfill) return;\n  if ($jscomp.ISOLATE_POLYFILLS) {\n    $jscomp.polyfillIsolated(target, polyfill, fromLang, toLang);\n  } else {\n    $jscomp.polyfillUnisolated(target, polyfill, fromLang, toLang);\n  }\n};\n\n/**\n * @param {string} target Qualified name of the class or method to polyfill,\n * @param {function(*): *} polyfill A function that takes the current browser\n *     implementation of the target and returns an optional new polyfill\n *     implementation.\n * @param {string} fromLang The language level in which the target is expected\n *     to already be present in the browser.\n * @param {string} toLang The language level required by the polyfill\n *     implementation.\n * @suppress {reportUnknownTypes}\n * @see $jscomp.polyfill for more documentation\n */\n$jscomp.polyfillUnisolated = function(target, polyfill, fromLang, toLang) {\n  var obj = $jscomp.global;\n  var split = target.split('.');\n  for (var i = 0; i < split.length - 1; i++) {\n    var key = split[i];\n    if (!(key in obj)) return;\n    obj = obj[key];\n  }\n  var property = split[split.length - 1];\n  var orig = obj[property];\n  var impl = polyfill(orig);\n  if (impl == orig || impl == null) return;\n  $jscomp.defineProperty(\n      obj, property, {configurable: true, writable: true, value: impl});\n};\n\n/**\n * Defines a polyfill for the given class or method under an obfuscated name.\n *\n * The main differences between this method and $jscomp.polyfillUnisolated are:\n *  - classes are defined on $jscomp.polyfills, not window.\n *  - methods (Array.prototype.includes) are defined on Array.prototype under\n *    an obfuscated name Array.prototype.$jscp$907312$includes or a Symbol, if\n * native.\n *  - this method installs our polyfill even when an existing implementation is\n *    found, as it might be an untrusted polyfill. The exception is that if\n *    Symbol is detected to be native, we assume any implementations of ES6\n *    classes/methods are also native and not polyfills.\n *\n * @param {string} target Qualified name of the class or method to polyfill,\n * @param {function(*): *} polyfill A function that takes the current browser\n *     implementation of the target and returns an optional new polyfill\n *     implementation.\n * @param {string} fromLang The language level in which the target is expected\n *     to already be present in the browser.\n * @param {string} toLang The language level required by the polyfill\n *     implementation.\n * @suppress {reportUnknownTypes}\n * @see $jscomp.polyfill for more parameter documentation\n */\n$jscomp.polyfillIsolated = function(target, polyfill, fromLang, toLang) {\n  var split = target.split('.');\n  var isSimpleName = split.length === 1;\n  var root = split[0];\n\n  // Look up the parent object. For classes this is just $jscomp.global.\n  // For methods/properties this may be a polyfill (Promise) or may a native\n  // object (Array.prototype).\n  var ownerObject;\n  if (!isSimpleName && root in $jscomp.polyfills) {\n    // Handle Symbol.asyncIterator and Promise.prototype.finally\n    ownerObject = $jscomp.polyfills;\n  } else {\n    // Handle Promise, Array.of, and String.prototype.startsWith\n    ownerObject = $jscomp.global;\n  }\n\n  for (var i = 0; i < split.length - 1; i++) {\n    var key = split[i];\n    if (!(key in ownerObject)) return;\n    ownerObject = ownerObject[key];\n  }\n\n  var property = split[split.length - 1];\n  // If Symbol is native and the target is in the ES6 spec, use the native imp.\n  // We assume the method/class was not polyfilled since polyfills typically\n  // back off in the presence of an existing implementation.\n  var nativeImpl = $jscomp.IS_SYMBOL_NATIVE && fromLang === 'es6' ?\n      ownerObject[property] :\n      null;\n  var impl = polyfill(nativeImpl);\n\n  if (impl == null) {\n    return;\n  }\n\n  if (isSimpleName) {\n    // Note: `impl` may be the actual native class instead of a\n    // polyfill. Add it to $jscomp.polyfills anyway. The IsolatePolyfills pass\n    // unconditionally replaces `Symbol` with `$jscomp.polyfills['Symbol']`.\n\n    // Use $jscomp.polyfills instead of ownerObject. For simple names like\n    // Promise and Symbol, ownerObject is the global object, and we want to\n    // avoid adding new global variables.\n    $jscomp.defineProperty(\n        $jscomp.polyfills, property,\n        {configurable: true, writable: true, value: impl});\n  } else if (impl !== nativeImpl) {\n    // Skip installing an obfuscated property if we have found a native version\n    // of the method we're polyfilling. $jscomp$lookupPolyfilledValue will fall\n    // back to the native version anyway.\n    if ($jscomp.propertyToPolyfillSymbol[property] === undefined) {\n      var BIN_ID = (Math.random() * 1e9) >>> 0;\n      $jscomp.propertyToPolyfillSymbol[property] = $jscomp.IS_SYMBOL_NATIVE ?\n          // use bracket access to avoid injecting the Symbol polyfill\n          $jscomp.global['Symbol'](property) :\n          $jscomp.POLYFILL_PREFIX + BIN_ID + '$' + property;\n    }\n\n    /** @const {symbol} */\n    var obfuscatedName = $jscomp.propertyToPolyfillSymbol[property];\n\n    // Define the polyfilled method on its owner but under an obfuscated\n    // name to avoid collisions. The owner will be a native class like `Promise`\n    // or a native class's prototype like `Array.prototype`.\n    $jscomp.defineProperty(\n        ownerObject, obfuscatedName,\n        {configurable: true, writable: true, value: impl});\n  }\n};\n","/*\n * Copyright 2017 The Closure Compiler Authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview\n * @suppress {uselessCode}\n */\n\n'require util/defines';\n'require util/polyfill';\n'require util/shouldpolyfill';\n\n/**\n * @suppress {missingProperties,reportUnknownTypes}\n * @return {boolean}\n */\n$jscomp.underscoreProtoCanBeSet = function() {\n  var x = {a: true};\n  var y = {};\n  try {\n    y.__proto__ = x;\n    return y.a;\n  } catch (e) {\n    // __proto__ property is readonly (possibly IE 10?)\n  }\n  return false;\n};\n\n/**\n * If we can implement it, this will be a function that attempts to set the\n * prototype of an object, otherwise it will be `null`.\n *\n * It returns the first argument if successful. Throws a `TypeError` if the\n * object is not extensible.\n *\n * @type {null|function(!Object, ?Object): !Object}\n */\n$jscomp.setPrototypeOf = ($jscomp.TRUST_ES6_POLYFILLS &&\n                          typeof Object.setPrototypeOf == 'function') ?\n    Object.setPrototypeOf :\n    $jscomp.underscoreProtoCanBeSet() ? function(target, proto) {\n      target.__proto__ = proto;\n      if (target.__proto__ !== proto) {\n        throw new TypeError(target + ' is not extensible');\n      }\n      return target;\n    } : null;\n","/*\n * Copyright 2016 The Closure Compiler Authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Polyfill for ES6 extends keyword.\n * @suppress {uselessCode}\n */\n'require base';\n'require util/objectcreate';\n'require es6/util/setprototypeof';\n\n\n/**\n * Inherit the prototype methods and static methods from one constructor\n * into another.\n *\n * This wires up the prototype chain (like goog.inherits) and copies static\n * properties, for ES6-to-ES{3,5} transpilation.\n *\n * Usage:\n * <pre>\n *   function ParentClass() {}\n *\n *   // Regular method.\n *   ParentClass.prototype.foo = function(a) {};\n *\n *   // Static method.\n *   ParentClass.bar = function() {};\n *\n *   function ChildClass() {\n *     ParentClass.call(this);\n *   }\n *   $jscomp.inherits(ChildClass, ParentClass);\n *\n *   var child = new ChildClass();\n *   child.foo();\n *   ChildClass.bar();  // Static inheritance.\n * </pre>\n *\n * @param {!Function} childCtor Child class.\n * @param {!Function} parentCtor Parent class.\n * @suppress {strictMissingProperties} 'superClass_' is not defined on Function\n */\n$jscomp.inherits = function(childCtor, parentCtor) {\n  childCtor.prototype = $jscomp.objectCreate(parentCtor.prototype);\n  /** @override */ childCtor.prototype.constructor = childCtor;\n  if ($jscomp.setPrototypeOf) {\n    // avoid null dereference warning\n    /** @const {!Function} */\n    var setPrototypeOf = $jscomp.setPrototypeOf;\n    setPrototypeOf(childCtor, parentCtor);\n  } else {\n    // setPrototypeOf is not available so we need to copy the static\n    // methods to the child\n    for (var p in parentCtor) {\n      if (p == 'prototype') {\n        // Don't copy parentCtor.prototype to childCtor.\n        continue;\n      }\n      if (Object.defineProperties) {\n        var descriptor = Object.getOwnPropertyDescriptor(parentCtor, p);\n        if (descriptor) {\n          Object.defineProperty(childCtor, p, descriptor);\n        }\n      } else {\n        // Pre-ES5 browser. Just copy with an assignment.\n        childCtor[p] = parentCtor[p];\n      }\n    }\n  }\n\n  childCtor.superClass_ = parentCtor.prototype;\n};\n","/*\n * Copyright 2021 The Closure Compiler Authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Provides a method to return the rest arguments from a\n * function's arguments. Should be called using `apply`, using the start index\n * as the value for `this` and the original function's arguments array as the\n * arguments, to avoid issues with V8 function optimization backoff cause by\n * passing arguments around as a function parameter (apply is special-cased).\n *\n * @suppress {reportUnknownTypes, uselessCode}\n */\n\n'require base';\n\n/**\n * @this {number}\n * @return {!Array<?>}\n * @noinline\n */\n$jscomp.getRestArguments = function() {\n  var startIndex = Number(this);\n  var restArgs = [];\n  for (var i = startIndex; i < arguments.length; i++) {\n    restArgs[i - startIndex] = arguments[i];\n  }\n  return restArgs;\n};\n","/*\n * Copyright 2016 The Closure Compiler Authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n'require base';\n'require es6/util/makeiterator';\n'require util/defines';\n'require util/global';\n'require util/polyfill';\n\n\n$jscomp.polyfill('Promise',\n    /**\n     * @param {*} NativePromise\n     * @return {*}\n     * @suppress {reportUnknownTypes}\n     */\n    function(NativePromise) {\n  function platformSupportsPromiseRejectionEvents() {\n    return typeof $jscomp.global['PromiseRejectionEvent'] !== 'undefined';\n  }\n\n  function globalPromiseIsNative() {\n    return $jscomp.global['Promise'] &&\n        $jscomp.global['Promise'].toString().indexOf('[native code]') !== -1;\n  }\n\n  function shouldForcePolyfillPromise() {\n    // Only force polyfill if the global promise is native.\n    return ($jscomp.FORCE_POLYFILL_PROMISE ||\n      $jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION &&\n      !platformSupportsPromiseRejectionEvents()) && globalPromiseIsNative();\n  }\n\n  // TODO(bradfordcsmith): Do we need to add checks for standards conformance?\n  //     e.g. The version of FireFox we currently use for testing has a Promise\n  //     that fails to reject attempts to fulfill it with itself, but that\n  //     isn't reasonably testable here.\n  if (NativePromise && !shouldForcePolyfillPromise()) {\n    return NativePromise;\n  }\n\n  /**\n    * Schedules code to be executed asynchronously.\n    * @constructor\n    * @struct\n    */\n  function AsyncExecutor() {\n    /**\n     * Batch of functions to execute.\n     *\n     * Will be `null` initially and immediately after a batch finishes\n     * executing.\n     * @private {?Array<function()>}\n     */\n    this.batch_ = null;\n  }\n\n  /**\n   * Schedule a function to execute asynchronously.\n   *\n   * -   The function will execute:\n   *     -   After the current call stack has completed executing.\n   *     -   After any functions previously scheduled using this object.\n   * -   The return value will be ignored.\n   * -   An exception thrown by the method will be caught and asynchronously\n   *     rethrown when it cannot interrupt any other code. This class provides\n   *     no way to catch such exceptions.\n   * @param {function():?} f\n   */\n  AsyncExecutor.prototype.asyncExecute = function(f) {\n    if (this.batch_ == null) {\n      // no batch created yet, or last batch was fully executed\n      this.batch_ = [];\n      var self = this;\n      this.asyncExecuteFunction(function() { self.executeBatch_(); });\n    }\n    this.batch_.push(f);\n  };\n\n  // NOTE: We want to make sure AsyncExecutor will work as expected even if\n  // testing code should override setTimeout()\n  /** @const {function(!Function, number)} */\n  var nativeSetTimeout = $jscomp.global['setTimeout'];\n\n  /**\n   * Schedule a function to execute asynchronously as soon as possible.\n   *\n   * NOTE: May be overridden for testing.\n   * @package\n   * @param {function()} f\n   */\n  AsyncExecutor.prototype.asyncExecuteFunction = function(f) {\n    nativeSetTimeout(f, 0);\n  };\n\n  /**\n   * Execute scheduled jobs in a batch until all are executed or the batch\n   * execution time limit has been reached.\n   * @private\n   */\n  AsyncExecutor.prototype.executeBatch_ = function() {\n    while (this.batch_ && this.batch_.length) {\n      var /** !Array<?function()> */ executingBatch = this.batch_;\n      // Executions scheduled while executing this batch go into a new one to\n      // avoid the batch array getting too big.\n      this.batch_ = [];\n      for (var i = 0; i < executingBatch.length; ++i) {\n        var f = /** @type {function()} */ (executingBatch[i]);\n        executingBatch[i] = null;  // free memory\n        try {\n          f();\n        } catch (error) {\n          this.asyncThrow_(error);\n        }\n      }\n    }\n    // All jobs finished executing, so force scheduling a new batch next\n    // time asyncExecute() is called.\n    this.batch_ = null;\n  };\n\n  /**\n   * @private\n   * @param {*} exception\n   */\n  AsyncExecutor.prototype.asyncThrow_ = function(exception) {\n    this.asyncExecuteFunction(function() { throw exception; });\n  };\n\n  /**\n   * @enum {number}\n   */\n  var PromiseState = {\n    /** The Promise is waiting for resolution. */\n    PENDING: 0,\n\n    /** The Promise has been resolved with a fulfillment value. */\n    FULFILLED: 1,\n\n    /** The Promise has been resolved with a rejection reason. */\n    REJECTED: 2\n  };\n\n\n  /**\n   * @see https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise\n   * @param {function(\n   *             function((TYPE|IThenable<TYPE>|Thenable|null)=),\n   *             function(*=))} executor\n   * @constructor\n   * @extends {Promise<TYPE>}\n   * @template TYPE\n   */\n  var PolyfillPromise = function(executor) {\n    /** @private {PromiseState} */\n    this.state_ = PromiseState.PENDING;\n\n    /**\n     * The settled result of the Promise. Immutable once set with either a\n     * fulfillment value or rejection reason.\n     * @private {*}\n     */\n    this.result_ = undefined;\n\n    /**\n     * These functions must be asynchronously executed when this promise\n     * settles.\n     * @private {?Array<function()>}\n     */\n    this.onSettledCallbacks_ = [];\n\n    /**\n     * Whether the rejection has any handler when the promise is rejected.\n     * @private {boolean}\n     */\n    this.isRejectionHandled_ = false;\n\n    var resolveAndReject = this.createResolveAndReject_();\n    try {\n      executor(resolveAndReject.resolve, resolveAndReject.reject);\n    } catch (e) {\n      resolveAndReject.reject(e);\n    }\n  };\n\n\n  /**\n   * Create a pair of functions for resolving or rejecting this Promise.\n   *\n   * <p>After the resolve or reject function has been called once, later calls\n   * do nothing.\n   * @private\n   * @return {{\n   *     resolve: function((TYPE|IThenable<TYPE>|Thenable|null)=),\n   *     reject:  function(*=)\n   * }}\n   */\n  PolyfillPromise.prototype.createResolveAndReject_ = function() {\n    var thisPromise = this;\n    var alreadyCalled = false;\n    /**\n     * @param {function(this:PolyfillPromise<TYPE>, T=)} method\n     * @return {function(T=)}\n     * @template T\n     */\n    function firstCallWins(method) {\n      return function(/** T= */ x) {\n        if (!alreadyCalled) {\n          alreadyCalled = true;\n          method.call(thisPromise, x);\n        }\n      };\n    }\n    return {\n      resolve: firstCallWins(this.resolveTo_),\n      reject: firstCallWins(this.reject_)\n    };\n  };\n\n\n  /**\n   * @private\n   * @param {*=} value\n   */\n  PolyfillPromise.prototype.resolveTo_ = function(value) {\n    if (value === this) {\n      this.reject_(new TypeError('A Promise cannot resolve to itself'));\n    } else if (value instanceof PolyfillPromise) {\n      this.settleSameAsPromise_(/** @type {!PolyfillPromise} */ (value));\n    } else if (isObject(value)) {\n      this.resolveToNonPromiseObj_(/** @type {!Object} */ (value));\n    } else {\n      this.fulfill_(value);\n    }\n  };\n\n\n  /**\n   * @private\n   * @param {!Object} obj\n   * @suppress {strictMissingProperties} obj.then\n   */\n  PolyfillPromise.prototype.resolveToNonPromiseObj_ = function(obj) {\n    var thenMethod = undefined;\n\n    try {\n      thenMethod = obj.then;\n    } catch (error) {\n      this.reject_(error);\n      return;\n    }\n    if (typeof thenMethod == 'function') {\n      this.settleSameAsThenable_(thenMethod, /** @type {!Thenable} */ (obj));\n    } else {\n      this.fulfill_(obj);\n    }\n  };\n\n\n  /**\n   * @param {*} value anything\n   * @return {boolean}\n   */\n  function isObject(value) {\n    switch (typeof value) {\n      case 'object':\n        return value != null;\n      case 'function':\n        return true;\n      default:\n        return false;\n    }\n  }\n\n  /**\n   * Reject this promise for the given reason.\n   * @private\n   * @param {*=} reason\n   * @throws {!Error} if this promise is already fulfilled or rejected.\n   */\n  PolyfillPromise.prototype.reject_ = function(reason) {\n    this.settle_(PromiseState.REJECTED, reason);\n  };\n\n  /**\n   * Fulfill this promise with the given value.\n   * @private\n   * @param {!TYPE} value\n   * @throws {!Error} when this promise is already fulfilled or rejected.\n   */\n  PolyfillPromise.prototype.fulfill_ = function(value) {\n    this.settle_(PromiseState.FULFILLED, value);\n  };\n\n  /**\n   * Fulfill or reject this promise with the given value/reason.\n   * @private\n   * @param {!PromiseState} settledState (FULFILLED or REJECTED)\n   * @param {*} valueOrReason\n   * @throws {!Error} when this promise is already fulfilled or rejected.\n   */\n  PolyfillPromise.prototype.settle_ = function(settledState, valueOrReason) {\n    if (this.state_ != PromiseState.PENDING) {\n      throw new Error(\n          'Cannot settle(' + settledState + ', ' + valueOrReason +\n          '): Promise already settled in state' + this.state_);\n    }\n    this.state_ = settledState;\n    this.result_ = valueOrReason;\n    if (this.state_ === PromiseState.REJECTED) {\n      this.scheduleUnhandledRejectionCheck_();\n    }\n    this.executeOnSettledCallbacks_();\n  };\n\n  PolyfillPromise.prototype.scheduleUnhandledRejectionCheck_ = function() {\n    var self = this;\n    nativeSetTimeout(function() {\n      if (self.notifyUnhandledRejection_()) {\n        // console may not exist on IE 9.\n        var nativeConsole = $jscomp.global['console'];\n        if (typeof nativeConsole !== 'undefined') {\n          nativeConsole.error(self.result_);\n        }\n      }\n    }, 1);\n  };\n\n  /**\n   * Dispatches `unhandledrejection` event if the rejection is unhandled.\n   * @return {boolean} False means the fallback handler does not need to run. It\n   *     is either because rejection handlers are detected or one of the\n   *     `unhandledjrection` event handlers call `preventDefault()`.\n   *     True otherwise.\n   * @private\n   * @suppress {missingProperties}\n   */\n  PolyfillPromise.prototype.notifyUnhandledRejection_ = function() {\n    if (this.isRejectionHandled_) {\n      return false;\n    }\n    var NativeCustomEvent = $jscomp.global['CustomEvent'];\n    var NativeEvent = $jscomp.global['Event'];\n    var nativeDispatchEvent = $jscomp.global['dispatchEvent'];\n    if (typeof nativeDispatchEvent === 'undefined') {\n      return true;\n    }\n\n    var event;\n    if (typeof NativeCustomEvent === 'function') {\n      event =\n          new NativeCustomEvent('unhandledrejection', {cancelable: true});\n    } else if (typeof NativeEvent === 'function') {\n      // CustomEvent is not available in FireFox < 48 in workers.\n      // https://developer.mozilla.org/en-US/docs/Web/API/CustomEvent\n      event = new NativeEvent('unhandledrejection', {cancelable: true});\n    } else {\n      // IE does not support CustomEvent constructor.\n      event = $jscomp.global['document'].createEvent('CustomEvent');\n      event.initCustomEvent(\n          'unhandledrejection', /** canBubbleArg */ false,\n          /** cancelableArg */ true, event);\n    }\n    event.promise = this;\n    event.reason = this.result_;\n\n    return nativeDispatchEvent(event);\n  };\n\n  PolyfillPromise.prototype.executeOnSettledCallbacks_ = function() {\n    if (this.onSettledCallbacks_ != null) {\n      for (var i = 0; i < this.onSettledCallbacks_.length; ++i) {\n        asyncExecutor.asyncExecute(this.onSettledCallbacks_[i]);\n      }\n      this.onSettledCallbacks_ = null;  // free memory\n    }\n  };\n\n  /**\n   * All promise async execution is managed by a single executor for the\n   * sake of efficiency.\n   * @const {!AsyncExecutor}\n   */\n  var asyncExecutor = new AsyncExecutor();\n\n  /**\n   * Arrange to settle this promise in the same way as the given thenable.\n   * @private\n   * @param {!PolyfillPromise} promise\n   */\n  PolyfillPromise.prototype.settleSameAsPromise_ = function(promise) {\n    var methods = this.createResolveAndReject_();\n\n    // Calling then() would create an unnecessary extra promise.\n    promise.callWhenSettled_(methods.resolve, methods.reject);\n  };\n\n  /**\n   * Arrange to settle this promise in the same way as the given thenable.\n   * @private\n   * @param {function(\n   *     function((TYPE|IThenable<TYPE>|Thenable|null)=),\n   *     function(*=))\n   * } thenMethod\n   * @param {!Thenable} thenable\n   */\n  PolyfillPromise.prototype.settleSameAsThenable_ = function(\n      thenMethod, thenable) {\n    var methods = this.createResolveAndReject_();\n\n    // Don't trust an unknown thenable implementation not to throw exceptions.\n    try {\n      thenMethod.call(thenable, methods.resolve, methods.reject);\n    } catch (error) {\n      methods.reject(error);\n    }\n  };\n\n  /** @override */\n  PolyfillPromise.prototype.then = function(onFulfilled, onRejected) {\n    var resolveChild;\n    var rejectChild;\n    var childPromise = new PolyfillPromise(function(resolve, reject) {\n      resolveChild = resolve;\n      rejectChild = reject;\n    });\n    function createCallback(paramF, defaultF) {\n      // The spec says to ignore non-function values for onFulfilled and\n      // onRejected\n      if (typeof paramF == 'function') {\n        return function(x) {\n          try {\n            resolveChild(paramF(x));\n          } catch (error) {\n            rejectChild(error);\n          }\n        };\n      } else {\n        return defaultF;\n      }\n    }\n\n    this.callWhenSettled_(\n        createCallback(onFulfilled, resolveChild),\n        createCallback(onRejected, rejectChild));\n    return childPromise;\n  };\n\n  /** @override */\n  PolyfillPromise.prototype.catch = function(onRejected) {\n    return this.then(undefined, onRejected);\n  };\n\n\n  PolyfillPromise.prototype.callWhenSettled_ = function(\n      onFulfilled, onRejected) {\n    var /** !PolyfillPromise */ thisPromise = this;\n    function callback() {\n      switch (thisPromise.state_) {\n        case PromiseState.FULFILLED:\n          onFulfilled(thisPromise.result_);\n          break;\n        case PromiseState.REJECTED:\n          onRejected(thisPromise.result_);\n          break;\n        default:\n          throw new Error('Unexpected state: ' + thisPromise.state_);\n      }\n    }\n    if (this.onSettledCallbacks_ == null) {\n      // we've already settled\n      asyncExecutor.asyncExecute(callback);\n    } else {\n      this.onSettledCallbacks_.push(callback);\n    }\n    this.isRejectionHandled_ = true;\n  };\n\n  // called locally, so give it a name\n  function resolvingPromise(opt_value) {\n    if (opt_value instanceof PolyfillPromise) {\n      return opt_value;\n    } else {\n      return new PolyfillPromise(function(resolve, reject) {\n        resolve(opt_value);\n      });\n    }\n  }\n  PolyfillPromise['resolve'] = resolvingPromise;\n\n\n  PolyfillPromise['reject'] = function(opt_reason) {\n    return new PolyfillPromise(function(resolve, reject) {\n      reject(opt_reason);\n    });\n  };\n\n\n  PolyfillPromise['race'] = function(thenablesOrValues) {\n    return new PolyfillPromise(function(resolve, reject) {\n      var /** !Iterator<*> */ iterator =\n          $jscomp.makeIterator(thenablesOrValues);\n      for (var /** !IIterableResult<*> */ iterRec = iterator.next();\n           !iterRec.done;\n           iterRec = iterator.next()) {\n        // Using resolvingPromise() allows us to treat all elements the same\n        // way.\n        // NOTE: resolvingPromise(promise) always returns the argument\n        // unchanged.\n        // Using .callWhenSettled_() instead of .then() avoids creating an\n        // unnecessary extra promise.\n        resolvingPromise(iterRec.value).callWhenSettled_(resolve, reject);\n      }\n    });\n  };\n\n\n  PolyfillPromise['all'] = function(thenablesOrValues) {\n    var /** !Iterator<*> */ iterator = $jscomp.makeIterator(thenablesOrValues);\n    var /** !IIterableResult<*> */ iterRec = iterator.next();\n\n    if (iterRec.done) {\n      return resolvingPromise([]);\n    } else {\n      return new PolyfillPromise(function(resolveAll, rejectAll) {\n        var resultsArray = [];\n        var unresolvedCount = 0;\n\n        function onFulfilled(i) {\n          return function(ithResult) {\n            resultsArray[i] = ithResult;\n            unresolvedCount--;\n            if (unresolvedCount == 0) {\n              resolveAll(resultsArray);\n            }\n          };\n        }\n\n        do {\n          resultsArray.push(undefined);\n          unresolvedCount++;\n          // Using resolvingPromise() allows us to treat all elements the same\n          // way.\n          // NOTE: resolvingPromise(promise) always returns the argument\n          // unchanged. Using .callWhenSettled_() instead of .then() avoids\n          // creating an unnecessary extra promise.\n          resolvingPromise(iterRec.value)\n              .callWhenSettled_(\n                  onFulfilled(resultsArray.length - 1), rejectAll);\n          iterRec = iterator.next();\n        } while (!iterRec.done);\n      });\n    }\n  };\n\n  return PolyfillPromise;\n}, 'es6', 'es3');\n","/*\n * Copyright 2016 The Closure Compiler Authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n'require util/polyfill';\n\n$jscomp.polyfill('Array.prototype.fill', function(orig) {\n  if (orig) return orig;\n\n  /**\n   * Fills elements of an array with a constant value.\n   *\n   * @this {!IArrayLike<VALUE>}\n   * @param {VALUE} value Value to fill.\n   * @param {number=} opt_start Start index, or zero if omitted.\n   * @param {number=} opt_end End index, or length if omitted.\n   * @return {!IArrayLike<VALUE>} The array, with the fill performed in-place.\n   * @template VALUE\n   * @suppress {reportUnknownTypes, strictPrimitiveOperators}\n   */\n  var polyfill = function(value, opt_start, opt_end) {\n    var length = this.length || 0;\n    if (opt_start < 0) {\n      opt_start = Math.max(0, length + /** @type {number} */ (opt_start));\n    }\n    if (opt_end == null || opt_end > length) opt_end = length;\n    opt_end = Number(opt_end);\n    if (opt_end < 0) opt_end = Math.max(0, length + opt_end);\n    for (var i = Number(opt_start || 0); i < opt_end; i++) {\n      this[i] = value;\n    }\n    return this;\n  };\n\n  return polyfill;\n}, 'es6', 'es3');\n","/*\n * Copyright 2020 The Closure Compiler Authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n'require es6/array/fill';\n'require util/polyfill';\n\n/**\n * @param {*} orig\n * @return {*}\n */\n$jscomp.typedArrayFill = function(orig) {\n  if (orig) return orig;\n  return Array.prototype.fill;\n};\n\n$jscomp.polyfill(\n    'Int8Array.prototype.fill', $jscomp.typedArrayFill, 'es6', 'es5');\n$jscomp.polyfill(\n    'Uint8Array.prototype.fill', $jscomp.typedArrayFill, 'es6', 'es5');\n$jscomp.polyfill(\n    'Uint8ClampedArray.prototype.fill', $jscomp.typedArrayFill, 'es6', 'es5');\n$jscomp.polyfill(\n    'Int16Array.prototype.fill', $jscomp.typedArrayFill, 'es6', 'es5');\n$jscomp.polyfill(\n    'Uint16Array.prototype.fill', $jscomp.typedArrayFill, 'es6', 'es5');\n$jscomp.polyfill(\n    'Int32Array.prototype.fill', $jscomp.typedArrayFill, 'es6', 'es5');\n$jscomp.polyfill(\n    'Uint32Array.prototype.fill', $jscomp.typedArrayFill, 'es6', 'es5');\n$jscomp.polyfill(\n    'Float32Array.prototype.fill', $jscomp.typedArrayFill, 'es6', 'es5');\n$jscomp.polyfill(\n    'Float64Array.prototype.fill', $jscomp.typedArrayFill, 'es6', 'es5');\n","/*\n * Copyright 2016 The Closure Compiler Authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n'require util/polyfill';\n\n$jscomp.polyfill('Object.is', function(orig) {\n  if (orig) return orig;\n\n  /**\n   * Polyfill for Object.is() method:\n   * https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/is\n   *\n   * Determines whether two values are the same value (that is,\n   * functionally equivalent).  This is the same as ===-equality,\n   * except for two cases: 0 is not the same as -0, and NaN is\n   * the same as NaN.\n   *\n   * @param {*} left\n   * @param {*} right\n   * @return {boolean}\n   */\n  var polyfill = function(left, right) {\n    if (left === right) {\n      // Handle the 0 === -0 exception\n      return (left !== 0) || (1 / left === 1 / /** @type {number} */ (right));\n    } else {\n      // Handle the NaN !== NaN exception\n      return (left !== left) && (right !== right);\n    }\n  };\n\n  return polyfill;\n}, 'es6', 'es3');\n","/*\n * Copyright 2017 The Closure Compiler Authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n'require es6/object/is';\n'require util/polyfill';\n\n$jscomp.polyfill('Array.prototype.includes', function(orig) {\n  if (orig) return orig;\n\n  /**\n   * Polyfills Array.prototype.includes.\n   *\n   * @see https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/includes\n   *\n   * @this {!IArrayLike<T>}\n   * @param {T} searchElement\n   * @param {number=} opt_fromIndex\n   * @return {boolean}\n   * @template T\n   * @suppress {reportUnknownTypes}\n   */\n  var includes = function(searchElement, opt_fromIndex) {\n    var array = this;\n    if (array instanceof String) {\n      array = /** @type {!IArrayLike} */ (String(array));\n    }\n    var len = array.length;\n    var i = opt_fromIndex || 0;\n    if (i < 0) {\n      i = Math.max(i + len, 0);\n    }\n    for (; i < len; i++) {\n      var element = array[i];\n      if (element === searchElement || Object.is(element, searchElement)) {\n        return true;\n      }\n    }\n    return false;\n  };\n\n  return includes;\n}, 'es7', 'es3');\n","/*\n * Copyright 2016 The Closure Compiler Authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n'require util/checkstringargs';\n'require util/polyfill';\n\n$jscomp.polyfill('String.prototype.includes', function(orig) {\n  if (orig) return orig;\n\n  /**\n   * Searches for a substring, starting at the given position.\n   *\n   * <p>Polyfills the instance method String.prototype.includes().\n   *\n   * @this {string}\n   * @param {string} searchString\n   * @param {number=} opt_position\n   * @return {boolean}\n   */\n  var polyfill = function(searchString, opt_position) {\n    'use strict';\n    var string = $jscomp.checkStringArgs(this, searchString, 'includes');\n    return string.indexOf(searchString, opt_position || 0) !== -1;\n  };\n\n  return polyfill;\n}, 'es6', 'es3');\n","/*\n * Copyright 2016 The Closure Compiler Authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n'require base';\n\n\n/**\n * Throws if the argument is a RegExp, or if thisArg is undefined.\n * @param {?} thisArg The 'this' arg, which must be defined.\n * @param {*} arg The first argument of the function, which mustn't be a RegExp.\n * @param {string} func Name of the function, for reporting.\n * @return {string} The thisArg, coerced to a string.\n * @suppress {reportUnknownTypes}\n */\n$jscomp.checkStringArgs = function(thisArg, arg, func) {\n  if (thisArg == null) {\n    throw new TypeError(\n        \"The 'this' value for String.prototype.\" + func +\n        ' must not be null or undefined');\n  }\n  if (arg instanceof RegExp) {\n    throw new TypeError(\n        'First argument to String.prototype.' + func +\n        ' must not be a regular expression');\n  }\n  return thisArg + '';\n};\n","/*\n * Copyright 2016 The Closure Compiler Authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Symbol polyfill.\n * @suppress {uselessCode}\n */\n\n'require es6/util/arrayiterator';\n'require util/defineproperty';\n'require util/global';\n'require util/polyfill';\n\n/**\n * Initializes the Symbol function.\n * @noinline\n */\n// TODO(rishipal): Remove this function\n$jscomp.initSymbol = function() {};\n\n$jscomp.polyfill('Symbol', function(orig) {\n  if (orig) return orig;  // no polyfill needed\n\n  /**\n   * @struct @constructor\n   * @param {string} id\n   * @param {string=} opt_description\n   */\n  var SymbolClass = function(id, opt_description) {\n    /** @private @const {string} */\n    this.$jscomp$symbol$id_ = id;\n\n    /** @const {string|undefined} */\n    this.description;\n\n    // description is read-only.\n    $jscomp.defineProperty(\n        this, 'description',\n        {configurable: true, writable: true, value: opt_description});\n  };\n\n\n  /** @override */\n  SymbolClass.prototype.toString = function() {\n    return this.$jscomp$symbol$id_;\n  };\n\n\n  /**\n   * Identifier for this compiled binary.\n   * @const {number}\n   */\n  var BIN_ID = (Math.random() * 1e9) >>> 0;\n\n  /** @const {string} */\n  var SYMBOL_PREFIX = 'jscomp_symbol_' + BIN_ID + '_';\n\n  /** @type {number} */\n  var counter = 0;\n\n  /**\n   * Produces \"symbols\" (actually just unique strings).\n   * @param {string=} opt_description\n   * @return {!SymbolClass}\n   * @this {?Object}\n   */\n  var symbolPolyfill = function(opt_description) {\n    if (this instanceof symbolPolyfill) {\n      throw new TypeError('Symbol is not a constructor');\n    }\n    return (new SymbolClass(\n        SYMBOL_PREFIX + (opt_description || '') + '_' + counter++,\n        opt_description));\n  };\n\n  return symbolPolyfill;\n}, 'es6', 'es3');\n\n$jscomp.polyfill('Symbol.iterator', function(orig) {\n  if (orig) return orig;  // no polyfill needed\n\n  var symbolIterator = Symbol('Symbol.iterator');\n\n  // Polyfill 'Symbol.iterator' onto Array and the various TypedArray* objects.\n  // This array uses strings to index into $jscomp.global because the TypedArray\n  // objects are present in IE11 but not on older browsers. Using bracket access\n  // saves code size compared to `typeof Int8Array === 'function' && Int8Array`.\n  var /** !Array<string> */ arrayLikes = [\n    'Array',\n    // List taken from https://tc39.es/ecma262/#sec-typedarray-objects.\n    // The BigInt*Arrays are intentionally omitted because they are only present\n    // in browsers where Symbol is fully supported.\n    'Int8Array', 'Uint8Array', 'Uint8ClampedArray', 'Int16Array', 'Uint16Array',\n    'Int32Array', 'Uint32Array', 'Float32Array', 'Float64Array'\n  ];\n\n  for (var i = 0; i < arrayLikes.length; i++) {\n    var ArrayLikeCtor = /** @type {*} */ ($jscomp.global[arrayLikes[i]]);\n    if (typeof ArrayLikeCtor === 'function' &&\n        typeof ArrayLikeCtor.prototype[symbolIterator] != 'function') {\n      $jscomp.defineProperty(ArrayLikeCtor.prototype, symbolIterator, {\n        configurable: true,\n        writable: true,\n        /**\n         * @this {IArrayLike}\n         * @return {!IteratorIterable}\n         */\n        value: function() {\n          return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this));\n        }\n      });\n    }\n  }\n  return symbolIterator;\n}, 'es6', 'es3');\n\n$jscomp.polyfill('Symbol.asyncIterator', function(orig) {\n  if (orig) {\n    return orig;\n  }\n  return Symbol('Symbol.asyncIterator');\n}, 'es9', 'es3');\n\n/**\n * Returns an iterator with the given `next` method.  Passing\n * all iterators through this function allows easily extending\n * the definition of `%IteratorPrototype%` if methods are ever\n * added to it in the future.\n *\n * @param {function(this: Iterator<T>): T} next\n * @return {!IteratorIterable<T>}\n * @template T\n */\n$jscomp.iteratorPrototype = function(next) {\n  var iterator = {next: next};\n  /**\n   * @this {IteratorIterable}\n   * @return {!IteratorIterable}\n   */\n  iterator[Symbol.iterator] = function() {\n    return this;\n  };\n  return /** @type {!IteratorIterable} */ (iterator);\n};\n","/*\n * Copyright 2016 The Closure Compiler Authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Utilities for iterator-returning methods.\n */\n'require es6/symbol';\n\n\n/**\n * Creates an iterator from an array-like, with a transformation function.\n * @param {!IArrayLike<INPUT>} array\n * @param {function(number, INPUT): OUTPUT} transform\n * @return {!IteratorIterable<OUTPUT>}\n * @template INPUT, OUTPUT\n * @suppress {checkTypes|reportUnknownTypes}\n */\n$jscomp.iteratorFromArray = function(array, transform) {\n  // NOTE: IE8 doesn't support indexing from boxed Strings.\n  if (array instanceof String) array = array + '';\n  var i = 0;\n  var done = false;\n  var iter = {\n    next: function() {\n      // Once we return done, we must always return done, even if the array\n      // grows later.\n      if (!done && i < array.length) {\n        var index = i++;\n        return {value: transform(index, array[index]), done: false};\n      }\n      done = true;\n      return {done: true, value: void 0};\n    }\n  };\n  iter[Symbol.iterator] = function() { return iter; };\n  return iter;\n};\n","/*\n * Copyright 2016 The Closure Compiler Authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n'require es6/util/iteratorfromarray';\n'require util/polyfill';\n\n$jscomp.polyfill('Array.prototype.keys', function(orig) {\n  if (orig) return orig;\n\n  /**\n   * Returns an iterator of keys of the given array.\n   *\n   * @this {!IArrayLike}\n   * @return {!IteratorIterable<number>}\n   */\n  var polyfill = function() {\n    return $jscomp.iteratorFromArray(this, function(i) { return i; });\n  };\n\n  return polyfill;\n}, 'es6', 'es3');\n","/**\n * @license\n **************************************************************************\n *                   (C) Copyright 2011-2017 - Marauroa                    *\n ***************************************************************************\n ***************************************************************************\n *                                                                         *\n *   This program is free software; you can redistribute it and/or modify  *\n *   it under the terms of the GNU General Public License as published by  *\n *   the Free Software Foundation; either version 2 of the License, or     *\n *   (at your option) any later version.                                   *\n *                                                                         *\n ***************************************************************************/\n\n\"use strict\";\n\nvar marauroa = window.marauroa = window.marauroa || {};\n\nmarauroa.debug = {\n\tmessages: false,\n\tunknownEvents: true\n};\n\nif (!window.console) {\n\twindow.console = {};\n}\nif (!window.console.log) {\n\twindow.console.log = function() {};\n\twindow.console.info = function() {};\n\twindow.console.warn = function() {};\n\twindow.console.error = function(text) {\n\t\talert(text);\n\t};\n}\n\nmarauroa.util = {\n\tisEmpty: function(obj) {\n\t\tfor (var i in obj) {\n\t\t\tif (obj.hasOwnProperty(i)) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t},\n\n\tisEmptyExceptId: function(obj) {\n\t\tfor (var i in obj) {\n\t\t\tif (i !== \"id\" && obj.hasOwnProperty(i)) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t},\n\n\tfirst: function(obj) {\n\t\tfor (var i in obj) {\n\t\t\tif (obj.hasOwnProperty(i)) {\n\t\t\t\treturn obj[i];\n\t\t\t}\n\t\t}\n\t},\n\n\tfromProto: function(proto, def) {\n\t\t/**\n\t\t * @constructor\n\t\t */\n\t\tvar F = function() {\n\t\t\tthis.proto = proto;\n\t\t};\n\t\tF.prototype = proto;\n\t\tvar obj = new F();\n\t\tif (!def) {\n\t\t\treturn obj;\n\t\t}\n\t\treturn marauroa.util.merge(obj, def);\n\t},\n\n\tmerge: function(a, b) {\n\t\tfor (var key in b) {\n\t\t\ta[key] = b[key];\n\t\t}\n\t\treturn a;\n\t}\n};\n","/***************************************************************************\n *                   (C) Copyright 2011-2017 - Marauroa                    *\n ***************************************************************************\n ***************************************************************************\n *                                                                         *\n *   This program is free software; you can redistribute it and/or modify  *\n *   it under the terms of the GNU General Public License as published by  *\n *   the Free Software Foundation; either version 2 of the License, or     *\n *   (at your option) any later version.                                   *\n *                                                                         *\n ***************************************************************************/\n\n/**\n * It is a wrapper over all the things that the client should do. You should\n * extend this class at your game.\n *\n * @author hendrik\n *\n */\n\"use strict\";\n\nvar marauroa = window.marauroa = window.marauroa || {};\n\nmarauroa.clientFramework = {\n\tclientid: \"-1\",\n\n\t/**\n\t * connect to the server\n\t *\n\t * @param host server host name\n\t * @param port server port number\n\t */\n\tconnect: function(host, port) {\n\t\tvar protocol = \"ws\";\n\t\tif (window.location.protocol === \"https:\") {\n\t\t\tprotocol = \"wss\";\n\t\t}\n\t\tif (host === null) {\n\t\t\thost = window.location.hostname;\n\t\t}\n\t\tif (port === null) {\n\t\t\tport = window.location.port;\n\t\t}\n\t\tif (port != \"\") {\n\t\t\tport = \":\" + port;\n\t\t}\n\t\tvar url = protocol + \"://\" + host + port + \"/ws/\";\n\t\tvar socket = new WebSocket(url);\n\t\tsocket.onmessage = marauroa.clientFramework.onMessage;\n\t\tsocket.onopen = function() {\n\t\t\tsetInterval(function() {\n\t\t\t\tvar msg = {\n\t\t\t\t\t\t\"t\": \"8\",\n\t\t\t\t};\n\t\t\t\tmarauroa.clientFramework.sendMessage(msg);\n\t\t\t}, 10000);\n\t\t\tmarauroa.clientFramework.onConnect();\n\t\t}\n\t\tsocket.onclose = marauroa.clientFramework.onDisonnect;\n\t\tmarauroa.clientFramework.socket = socket;\n\t},\n\n\tonConnect: function(reason, error) {\n\t\tif (typeof(error) == \"undefined\") {\n\t\t\tconsole.log(\"connected\");\n\t\t} else {\n\t\t\tconsole.error(\"onConnect: \" + reason + \" error: \" + error);\n\t\t}\n\t},\n\n\tonDisconnect: function(reason, error) {\n\t\tconsole.log(\"onDisconnect: \" + reason + \" error: \" + error);\n\t},\n\n\tonLoginRequired: function() {\n\t\t// a login is required\n\t},\n\n\tlogin: function(username, password) {\n\t\tvar msg = {\n\t\t\t\"t\": \"34\",\n\t\t\t\"u\": username,\n\t\t\t\"p\": password\n\t\t};\n\t\tmarauroa.clientFramework.username = username;\n\t\tmarauroa.clientFramework.sendMessage(msg);\n\t},\n\n\tonServerInfo: function(contents) {\n\t\tconsole.log(\"ServerInfo\", contents);\n\t},\n\n\tonPreviousLogins: function(previousLogins) {\n\t\tconsole.log(\"Previous Logins\", previousLogins);\n\t},\n\n\tonLoginFailed: function(reason, text) {\n\t\tconsole.error(\"Login failed with reason \" + reason + \": \" + text);\n\t},\n\n\tonMessage: function(e) {\n\t\tvar msg = JSON.parse(e.data);\n\t\tif (msg[\"t\"] === \"9\" || msg[\"t\"] === \"15\") {\n\t\t\tmarauroa.clientFramework.clientid = msg[\"c\"];\n\t\t}\n\t\tif (typeof(msg) === \"string\") {\n\t\t\tconsole.error(\"JSON error on message: \" + msg);\n\t\t} else {\n\t\t\tmarauroa.messageFactory.addDispatchMethod(msg);\n\t\t\tmsg.dispatch();\n\t\t}\n\t},\n\n\tsendMessage: function(msg) {\n\t\tvar myMessage = {\n\t\t\t\"c\": marauroa.clientFramework.clientid,\n\t\t\t\"s\": \"1\"\n\t\t};\n\t\tmarauroa.util.merge(myMessage, msg);\n\t\tmarauroa.clientFramework.socket.send(JSON.stringify(myMessage));\n\t},\n\n\tresync: function() {\n\t\t// TODO: send MessageC2SOutOfSync\n\t},\n\n\t/**\n\t * After login allows you to choose a character to play\n\t *\n\t * @param character\n\t *            name of the character we want to play with.\n\t * @return true if choosing character is successful.\n\t * @throws InvalidVersionException\n\t *             if we are not using a compatible version\n\t * @throws TimeoutException\n\t *             if timeout happens while waiting for the message.\n\t * @throws BannedAddressException\n\t */\n\tchooseCharacter: function(character) {\n\t\tvar msg = {\n\t\t\t\"t\": \"1\",\n\t\t\t\"character\": character\n\t\t};\n\t\tmarauroa.clientFramework.sendMessage(msg);\n\t},\n\n\tonChooseCharacterNack: function() {\n\t\tconsole.error(\"Server rejected your character.\");\n\t},\n\n\t/**\n\t * Sends a RPAction to server\n\t *\n\t * @param action\n\t *            the action to send to server.\n\t */\n\tsendAction: function(action) {\n\t\tvar msg = {\n\t\t\t\"t\": \"0\",\n\t\t\t\"a\": action\n\t\t};\n\t\tmarauroa.clientFramework.sendMessage(msg);\n\t},\n\n\t/**\n\t * Request logout of server\n\t *\n\t * @return true if we have successfully logout or false if server rejects to\n\t *         logout our player and maintain it on game world.\n\t * @throws InvalidVersionException\n\t *             if we are not using a compatible version\n\t * @throws TimeoutException\n\t *             if timeout happens while waiting for the message.\n\t * @throws BannedAddressException\n\t */\n\tlogout: function() {\n\t\tvar msg = {\n\t\t\t\t\"t\": \"5\"\n\t\t\t};\n\t\tmarauroa.clientFramework.sendMessage(msg);\n\t},\n\n\tonLogoutOutAck: function() {\n\t\tconsole.log(\"Server accepted logout request\");\n\t},\n\n\tonLogoutOutNack: function() {\n\t\tconsole.log(\"Server rejected logout request\");\n\t},\n\n\t/**\n\t * Disconnect the socket and finish the network communications.\n\t */\n\tclose: function() {\n\t\tmarauroa.clientFramework.socket.close();\n\t},\n\n\t/**\n\t * It is called when a perception arrives so you can choose how to apply the\n\t * perception.\n\t *\n\t * @param perceptionMessage\n\t *            the perception message itself.\n\t */\n\tonPerception: function(perceptionMessage) {\n\t\tmarauroa.perceptionHandler.apply(perceptionMessage);\n\t},\n\n\t/**\n\t * is called before a content transfer is started.\n\t *\n\t * <code> items </code> contains a list of names and timestamp.\n\t * That information can be used to decide if a transfer from server is needed.\n\t * By setting attribute ack to true in a TransferContent it will be acknowledged.\n\t * All acknowledges items in the returned List, will be transfered by server.\n\t *\n\t * @param items\n\t *            in this list by default all items.ack attributes are set to false;\n\t * @return the list of approved and rejected items.\n\t */\n\tonTransferREQ: function(items) {\n\t\tconsole.log(\"onTransferREQ: \", items);\n\t},\n\n\t/**\n\t * It is called when we get a transfer of content\n\t *\n\t * @param items\n\t *            the transfered items.\n\t */\n\tonTransfer: function(items) {\n\t\tconsole.log(\"onTransfer: \", items);\n\t},\n\n\n\t/**\n\t * It is called when we get the list of characters\n\t *\n\t * @param characters\n\t *            the characters we have available at this account.\n\t */\n\tonAvailableCharacterDetails: function(characters) {\n\t\tconsole.log(\"onAvailableCharacterDetails: \", characters);\n\n\t\t// create a character if there is none\n\t\tif (marauroa.util.isEmpty(characters)) {\n\t\t\tconsole.log(\"No character found, creating a character with the username (redefine onAvailableCharacterDetails to prevent this).\");\n\t\t\tmarauroa.clientFramework.createCharacter(marauroa.clientFramework.username, {});\n\t\t\treturn;\n\t\t}\n\n\t\t// automatically select the first one\n\t\tfor (var key in characters) {\n\t\t\tif (characters.hasOwnProperty(key)) {\n\t\t\t\tmarauroa.clientFramework.chooseCharacter(key);\n\t\t\t}\n\t\t}\n\t},\n\n\tcreateAccount: function(username, password, email) {\n\t\tvar msg = {\n\t\t\t\t\"t\": \"23\",\n\t\t\t\t\"u\": username,\n\t\t\t\t\"p\": password,\n\t\t\t\t\"e\": email\n\t\t\t};\n\t\tmarauroa.clientFramework.sendMessage(msg);\n\t},\n\n\tonCreateAccountAck: function(username) {\n\t\tconsole.log(\"Account \\\"\" + username + \"\\\" created successfully\");\n\t},\n\n\tonCreateAccountNack: function(username, reason) {\n\t\tconsole.log(\"Creating Account \\\"\" + username + \"\\\" failed: \", reason);\n\t\talert(reason.text);\n\t},\n\n\tcreateCharacter: function(charname, template) {\n\t\tvar msg = {\n\t\t\t\t\"t\": \"26\",\n\t\t\t\t\"charname\": charname,\n\t\t\t\t\"template\": template\n\t\t\t};\n\t\tmarauroa.clientFramework.sendMessage(msg);\n\t},\n\n\tonCreateCharacterAck: function(charname, template) {\n\t\tconsole.log(\"Character \\\"\" + charname + \"\\\" created successfully\", template);\n\t},\n\n\tonCreateCharacterNack: function(charname, reason) {\n\t\tconsole.log(\"Creating Character \\\"\" + charname + \"\\\" failed: \", reason);\n\t\talert(reason.text);\n\t}\n};\n","/***************************************************************************\n *                   (C) Copyright 2010-2017 - Marauroa                    *\n ***************************************************************************\n ***************************************************************************\n *                                                                         *\n *   This program is free software; you can redistribute it and/or modify  *\n *   it under the terms of the GNU General Public License as published by  *\n *   the Free Software Foundation; either version 2 of the License, or     *\n *   (at your option) any later version.                                   *\n *                                                                         *\n ***************************************************************************/\n\n\"use strict\";\n\nvar marauroa = window.marauroa = window.marauroa || {};\n\nmarauroa.messageFactory = new function() {\n\n\t// Message S2C Login NACK\n\tthis[\"t14\"] = function() {\n\t\tmarauroa.clientFramework.onLoginFailed(this[\"reason\"], this[\"text\"]);\n\t}\n\n\t// Message S2C CharacterList\n\tthis[\"t9\"] = function() {\n\t\tmarauroa.clientFramework.onAvailableCharacterDetails(this[\"characters\"]);\n\t}\n\n\t// Message S2C ChoooseCharacterACK\n\tthis[\"t10\"] = function() {\n\t\tconsole.log(\"Entering world\");\n\t}\n\n\t// Message S2C ChoooseCharacterNACK\n\tthis[\"t11\"] = function() {\n\t\tconsole.log(\"Character selection rejected\");\n\t\tmarauroa.clientFramework.onChooseCharacterNack();\n\t}\n\n\t// Message S2C Login ACK\n\tthis[\"t13\"] = function() {\n\t\tmarauroa.clientFramework.onPreviousLogins(this[\"previousLogins\"]);\n\t}\n\n\t// Message S2C Send Key\n\tthis[\"t15\"] = function() {\n\t\tconsole.log(\"Server send key: \", this);\n\t\tmarauroa.clientFramework.onLoginRequired();\n\t}\n\n\t// Message S2C Perception\n\tthis[\"t19\"] = function() {\n\t\tmarauroa.clientFramework.onPerception(this);\n\t}\n\n\t// Message S2C Server Info\n\tthis[\"t20\"] = function() {\n\t\tmarauroa.clientFramework.onServerInfo(this[\"contents\"]);\n\t}\n\n\t// Message S2C Transfer\n\tthis[\"t21\"] = function() {\n\t\tmarauroa.clientFramework.onTransfer(this[\"contents\"]);\n\t}\n\n\t// Message S2C TransferREQ\n\tthis[\"t22\"] = function() {\n\t\tmarauroa.clientFramework.onTransferREQ(this[\"contents\"]);\n\t\tvar contents = {};\n\t\tfor (var i in this[\"contents\"]) {\n\t\t\tif (typeof(this[\"contents\"][i][\"ack\"]) != \"undefined\" && this[\"contents\"][i][\"ack\"]) {\n\t\t\t\tcontents[this[\"contents\"][i][\"name\"]] = true;\n\t\t\t} else {\n\t\t\t\tcontents[this[\"contents\"][i][\"name\"]] = false;\n\t\t\t}\n\t\t}\n\t\tvar msg = {\n\t\t\t\"t\": \"7\",\n\t\t\t\"contents\": contents\n\t\t}\n\t\tmarauroa.clientFramework.sendMessage(msg);\n\t}\n\n\t// Message S2C CreateAccount ACK\n\tthis[\"t24\"] = function() {\n\t\tmarauroa.clientFramework.onCreateAccountAck(this[\"username\"]);\n\t}\n\n\t// Message S2C CreateAccount NACK\n\tthis[\"t25\"] = function() {\n\t\tmarauroa.clientFramework.onCreateAccountNack(this[\"username\"], this[\"reason\"]);\n\t}\n\n\t// Message S2C CreateCharacter ACK\n\tthis[\"t27\"] = function() {\n\t\tmarauroa.clientFramework.onCreateCharacterAck(this[\"charname\"], this[\"template\"]);\n\t}\n\n\t// Message S2C CreateCharacter NACK\n\tthis[\"t28\"] = function() {\n\t\tmarauroa.clientFramework.onCreateCharacterNack(this[\"charname\"], this[\"reason\"]);\n\t}\n\n\t// Message S2C Update\n\tthis[\"t35\"] = function() {\n\t\tvar msg = {\n\t\t\t\"t\": \"36\",\n\t\t\t\"response\": eval(this[\"update\"])\n\t\t}\n\t\tmarauroa.clientFramework.sendMessage(msg);\n\t}\n\n\t// handle unexpected unknown messages\n\tthis.unknownMessage = function() {\n\t\t// do nothing\n\t\tconsole.log(\"Unknown message: \" + JSON.stringify(this));\n\t}\n\n\tthis.addDispatchMethod = function(msg) {\n\t\tif (typeof(marauroa.messageFactory[\"t\" + msg.t]) != \"undefined\") {\n\t\t\tmsg.dispatch = marauroa.messageFactory[\"t\" + msg.t];\n\t\t} else {\n\t\t\tmsg.dispatch = marauroa.messageFactory.unknownMessage;\n\t\t}\n\t}\n};\n","/***************************************************************************\n *                   (C) Copyright 2011-2017 - Marauroa                    *\n ***************************************************************************\n ***************************************************************************\n *                                                                         *\n *   This program is free software; you can redistribute it and/or modify  *\n *   it under the terms of the GNU General Public License as published by  *\n *   the Free Software Foundation; either version 2 of the License, or     *\n *   (at your option) any later version.                                   *\n *                                                                         *\n ***************************************************************************/\n\n\"use strict\";\n\nvar marauroa = window.marauroa = window.marauroa || {};\n\n/**\n * The IPerceptionListener interface provides methods that are called while\n * applying the perception\n */\nmarauroa.perceptionListener = {\n\n\t/**\n\t * onAdded is called when an object is added to the world for first time or\n\t * after a sync perception. Return true to stop further processing.\n\t *\n\t * @param object\n\t *            the added object.\n\t * @return true to stop further processing\n\t */\n\tonAdded: function(object) {\n\t\treturn false;\n\t},\n\n\t/**\n\t * onModifiedAdded is called when an object is modified by adding or\n\t * changing one of its attributes. Return true to stop further processing.\n\t * Note that the method is called *before* modifying the object.\n\t *\n\t * @param object\n\t *            the original object\n\t * @param changes\n\t *            the added and modified changes.\n\t * @return true to stop further processing\n\t */\n\tonModifiedAdded: function(object, changes) {\n\t\treturn false;\n\t},\n\n\t/**\n\t * onModifiedDeleted is called each time the object has one of its\n\t * attributes removed. Return true to stop further processing. Note that the\n\t * method is called *before* modifying the object.\n\t *\n\t * @param object\n\t *            the original object\n\t * @param changes\n\t *            the deleted attributes.\n\t * @return true to stop further processing\n\t */\n\tonModifiedDeleted: function(object, changes) {\n\t\treturn false;\n\t},\n\n\t/**\n\t * onDeleted is called when an object is removed of the world Return true to\n\t * stop further processing.\n\t *\n\t * @param object\n\t *            the original object\n\t * @return true to stop further processing\n\t */\n\tonDeleted: function(object) {\n\t\treturn false;\n\t},\n\n\t/**\n\t * onMyRPObject is called when our rpobject avatar is processed. Return true\n\t * to stop further processing.\n\t *\n\t * @param added\n\t *            the added and modified attributes and slots\n\t * @param deleted\n\t *            the deleted attributes\n\t * @return true to stop further processing\n\t */\n\tonMyRPObject: function(added, deleted) {\n\t\treturn false;\n\t},\n\n\t/**\n\t * onClear is called when the whole world is going to be cleared. It happens\n\t * on sync perceptions Return true to stop further processing.\n\t *\n\t * @return true to stop further processing\n\t */\n\tonClear: function() {\n\t\treturn false;\n\t},\n\n\t/**\n\t * onPerceptionBegin is called when the perception is going to be applied\n\t *\n\t * @param type\n\t *            type of the perception: SYNC or DELTA\n\t * @param timestamp\n\t *            the timestamp of the perception\n\t */\n\tonPerceptionBegin: function(type, timestamp) {\n\t},\n\n\t/**\n\t * onPerceptionBegin is called when the perception has been applied\n\t *\n\t * @param type\n\t *            type of the perception: SYNC or DELTA\n\t * @param timestamp\n\t *            the timestamp of the perception\n\t */\n\tonPerceptionEnd: function(type, timestamp) {\n\t},\n\n\t/**\n\t * onException is called when an exception happens\n\t *\n\t * @param exception\n\t *            the exception that happened.\n\t * @param perception\n\t *            the message that causes the problem\n\t */\n\tonException: function(exception, perception) {\n\t\tconsole.error(exception, perception);\n\t}\n};\n\nmarauroa.currentZone = {\n\tclear: function() {\n\t\tfor (var i in marauroa.currentZone) {\n\t\t\tif (marauroa.currentZone.hasOwnProperty(i) && typeof(marauroa.currentZone[i]) !== \"function\") {\n\t\t\t\tmarauroa.currentZone[i].destroy(marauroa.currentZone);\n\t\t\t\tdelete marauroa.currentZone[i];\n\t\t\t}\n\t\t}\n\t}\n};\n\nmarauroa.perceptionHandler = {\n\n\t/**\n\t * Apply a perception.\n\t *\n\t * @param msg\n\t *            the perception msg\n\t */\n\tapply: function(msg) {\n\t\tmarauroa.perceptionListener.onPerceptionBegin(msg[\"sync\"], msg[\"s\"]);\n\n\t\t// clean world on login/zone change\n\t\tif (msg[\"sync\"]) {\n\t\t\tif (!marauroa.perceptionListener.onClear()) {\n\t\t\t\tmarauroa.currentZone.clear();\n\t\t\t\tmarauroa.currentZoneName = msg[\"zoneid\"];\n\t\t\t}\n\t\t}\n\n\t\t// apply perception\n\t\tmarauroa.perceptionHandler.applyPerceptionAddedRPObjects(msg);\n\t\tmarauroa.perceptionHandler.applyPerceptionModifiedRPObjects(msg);\n\t\tmarauroa.perceptionHandler.applyPerceptionDeletedRPObjects(msg);\n\t\tmarauroa.perceptionHandler.applyPerceptionMyRPObject(msg);\n\n\t\t// done, tell marauroa.perceptionListener\n\t\tmarauroa.perceptionListener.onPerceptionEnd(msg[\"sync\"], msg[\"s\"]);\n\t},\n\n\t/**\n\t * This method applies perceptions addedto the Map<RPObject::ID,RPObject>\n\t * passed as argument. It clears the map if this is a sync perception\n\t *\n\t * @param msg\n\t *            the perception message\n\t */\n\tapplyPerceptionAddedRPObjects: function(msg) {\n\t\tif (msg[\"aO\"]) {\n\t\t\tfor (var i in msg[\"aO\"]) {\n\t\t\t\tif (msg[\"aO\"].hasOwnProperty(i)) {\n\t\t\t\t\tif (!marauroa.perceptionListener.onAdded(msg[\"aO\"][i])) {\n\t\t\t\t\t\tvar o = marauroa.rpobjectFactory.create(msg[\"aO\"][i][\"c\"]);\n\t\t\t\t\t\tmarauroa.perceptionHandler.addChanges(o, msg[\"aO\"][i]);\n\t\t\t\t\t\tmarauroa.currentZone[msg[\"aO\"][i][\"a\"][\"id\"]] = o;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\n\t/**\n\t * This method applys perceptions deleted to the Map<RPObject::ID,RPObject>\n\t * passed as argument.\n\t *\n\t * @param msg\n\t *            the perception message\n\t */\n\tapplyPerceptionDeletedRPObjects: function(msg) {\n\t\tif (msg[\"dO\"]) {\n\t\t\tfor (var i in msg[\"dO\"]) {\n\t\t\t\tif (msg[\"dO\"].hasOwnProperty(i)) {\n\t\t\t\t\tvar tmp = msg[\"dO\"][i][\"a\"][\"id\"];\n\t\t\t\t\tif (!marauroa.perceptionListener.onDeleted(msg[\"dO\"][i])) {\n\t\t\t\t\t\tmarauroa.currentZone[tmp].destroy(marauroa.currentZone);\n\t\t\t\t\t\tdelete marauroa.currentZone[tmp];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\n\t/**\n\t * This method applies perceptions modified added and modified deleted to the\n\t * Map<RPObject.ID,RPObject> passed as argument.\n\t *\n\t * @param msg\n\t *            the perception message\n\t */\n\tapplyPerceptionModifiedRPObjects: function(msg) {\n\n\t\t// deleted attributes\n\t\tif (msg[\"dA\"]) {\n\t\t\tfor (var i in msg[\"dA\"]) {\n\t\t\t\tif (msg[\"dA\"].hasOwnProperty(i)) {\n\t\t\t\t\tif (typeof(marauroa.currentZone[msg[\"dA\"][i][\"a\"][\"id\"]]) !== \"undefined\") {\n\t\t\t\t\t\tvar o = marauroa.currentZone[msg[\"dA\"][i][\"a\"][\"id\"]];\n\t\t\t\t\t\tif (!marauroa.perceptionListener.onModifiedDeleted(msg[\"dA\"][i])) {\n\t\t\t\t\t\t\tmarauroa.perceptionHandler.deleteChanges(o, msg[\"dA\"][i]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// added attributes\n\t\tif (msg[\"aA\"]) {\n\t\t\tfor (var i in msg[\"aA\"]) {\n\t\t\t\tif (msg[\"aA\"].hasOwnProperty(i)) {\n\t\t\t\t\tif (typeof(marauroa.currentZone[msg[\"aA\"][i][\"a\"][\"id\"]]) !== \"undefined\") {\n\t\t\t\t\t\tvar o = marauroa.currentZone[msg[\"aA\"][i][\"a\"][\"id\"]];\n\t\t\t\t\t\tif (!marauroa.perceptionListener.onModifiedAdded(o, msg[\"aA\"][i])) {\n\t\t\t\t\t\t\tmarauroa.perceptionHandler.addChanges(o, msg[\"aA\"][i]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\n\t/**\n\t * This method applys perceptions for our RPObject to the Map<RPObject::ID,RPObject>\n\t * passed as argument.\n\t *\n\t * @param msg\n\t *            the perception message\n\t */\n\tapplyPerceptionMyRPObject: function(msg) {\n\n\t\tif (!marauroa.perceptionListener.onMyRPObject(msg[\"aM\"], msg[\"dM\"])) {\n\t\t\tvar id;\n\t\t\tif (typeof(msg[\"aM\"]) !== \"undefined\") {\n\t\t\t\tid = msg[\"aM\"][\"a\"][\"id\"];\n\t\t\t}\n\n\t\t\tif (typeof(msg[\"dM\"]) !== \"undefined\") {\n\t\t\t\tid = msg[\"dM\"][\"a\"][\"id\"];\n\t\t\t}\n\n\t\t\tif (typeof(id) === \"undefined\") {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tmarauroa.perceptionHandler.addMyRPObjectToWorldIfPrivate(id, msg[\"aM\"]);\n\t\t\tvar o = marauroa.currentZone[id];\n\t\t\tmarauroa.me = o;\n\t\t\tmarauroa.perceptionHandler.deleteChanges(o, msg[\"dM\"]);\n\t\t\tmarauroa.perceptionHandler.addChanges(o, msg[\"aM\"]);\n\t\t}\n\t},\n\n\t/**\n\t * adds our RPObject to the world in case it was not already added by the public perception.\n\t *\n\t * @param added added changes of my object\n\t */\n\taddMyRPObjectToWorldIfPrivate: function(id, added) {\n\t\tif (typeof(marauroa.currentZone[id]) !== \"undefined\") {\n\t\t\treturn;\n\t\t}\n\t\tif (!marauroa.perceptionListener.onAdded(added)) {\n\t\t\tif (typeof(added) === \"undefined\") {\n\t\t\t\tmarauroa.currentZone[id] = {};\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar o = marauroa.rpobjectFactory.create(added[\"c\"]);\n\t\t\tmarauroa.currentZone[id] = o;\n\t\t\tmarauroa.perceptionHandler.addChanges(o, added);\n\t\t}\n\t},\n\n\tdeleteChanges: function(object, diff) {\n\t\tif (typeof(diff) === \"undefined\") {\n\t\t\treturn;\n\t\t}\n\n\t\t// delete attributes\n\t\tif (typeof(diff[\"a\"]) !== \"undefined\") {\n\t\t\tfor (var i in diff[\"a\"]) {\n\t\t\t\tif (diff[\"a\"].hasOwnProperty(i) && i !== \"id\" && i !== \"zoneid\") {\n\t\t\t\t\tobject.unset(i);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// delete slots and/or their content\n\t\tif (typeof(diff[\"s\"]) !== \"undefined\") {\n\t\t\tfor (var i in diff[\"s\"]) {\n\t\t\t\tif (!diff[\"s\"].hasOwnProperty(i)) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\t// delete slot?\n\t\t\t\tif (marauroa.util.isEmpty(diff[\"s\"][i])) {\n\t\t\t\t\tobject.del(diff[\"s\"][i]);\n\t\t\t\t} else {\n\t\t\t\t\t// TODO: difference between deleting an object from a slot and an attribute from a contained object\n\t\t\t\t\tfor (var j in diff[\"s\"][i]) {\n\t\t\t\t\t\tif (diff[\"s\"][i].hasOwnProperty(j)) {\n\t\t\t\t\t\t\tobject[i].del(diff[\"s\"][i][j][\"a\"].id);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// delete maps and/or their content\n\t\tif (typeof(diff[\"m\"]) !== \"undefined\") {\n\t\t\tfor (var i in diff[\"m\"]) {\n\t\t\t\tif (!diff[\"m\"].hasOwnProperty(i)) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tif (marauroa.util.isEmpty(diff[\"m\"][i][\"a\"])) {\n\t\t\t\t\tobject.unset(diff[\"m\"][i]);\n\t\t\t\t} else {\n\t\t\t\t\tfor (var j in diff[\"m\"][i][\"a\"]) {\n\t\t\t\t\t\tif (diff[\"m\"][i][\"a\"].hasOwnProperty(j)) {\n\t\t\t\t\t\t\tobject.unsetMapEntry(i, j);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t// TODO: links\n\t},\n\n\taddChanges: function(object, diff) {\n\t\tif (typeof(diff) === \"undefined\") {\n\t\t\treturn;\n\t\t}\n\t\tobject[\"_rpclass\"] = diff[\"c\"];\n\n\t\t// attributes\n\t\tfor (var i in diff[\"a\"]) {\n\t\t\tif (diff[\"a\"].hasOwnProperty(i)) {\n\t\t\t\tif (typeof(object.set) === \"undefined\") {\n\t\t\t\t\tconsole.warn(\"Object missing set(key, value)-function\", object, diff[\"a\"]);\n\t\t\t\t\tobject[i] = diff[\"a\"][i];\n\t\t\t\t} else {\n\t\t\t\t\tobject.set(i, diff[\"a\"][i]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// maps\n\t\tif (typeof(diff[\"m\"]) !== \"undefined\") {\n\t\t\tfor (var i in diff[\"m\"]) {\n\t\t\t\tif (diff[\"m\"].hasOwnProperty(i)) {\n\t\t\t\t\tif (typeof(object[i]) === \"undefined\") {\n\t\t\t\t\t\tobject[i] = {};\n\t\t\t\t\t}\n\t\t\t\t\tfor (var j in diff[\"m\"][i][\"a\"]) {\n\t\t\t\t\t\tif (j !== \"zoneid\" && j !== \"id\" && diff[\"m\"][i][\"a\"].hasOwnProperty(j)) {\n\t\t\t\t\t\t\tobject.setMapEntry(i, j, diff[\"m\"][i][\"a\"][j]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// slots\n\t\tif (typeof(diff[\"s\"]) !== \"undefined\") {\n\t\t\tfor (var i in diff[\"s\"]) {\n\t\t\t\tif (diff[\"s\"].hasOwnProperty(i)) {\n\t\t\t\t\t// add slot itself, it it does not exist\n\t\t\t\t\tif (typeof(object[i]) === \"undefined\") {\n\t\t\t\t\t\tobject[i] = object.createSlot(i);\n\t\t\t\t\t}\n\t\t\t\t\t// for all slot members\n\t\t\t\t\tfor (var j in diff[\"s\"][i]) {\n\t\t\t\t\t\tif (diff[\"s\"][i].hasOwnProperty(j)) {\n\t\t\t\t\t\t\tvar id = diff[\"s\"][i][j][\"a\"].id;\n\t\t\t\t\t\t\tif (typeof(object[i].get(id)) === \"undefined\") {\n\t\t\t\t\t\t\t\tvar newObject = marauroa.rpobjectFactory.create(diff[\"s\"][i][j][\"c\"]);\n\t\t\t\t\t\t\t\tnewObject._parent = object[i];\n\t\t\t\t\t\t\t\tnewObject[\"id\"] = id;\n\t\t\t\t\t\t\t\tobject[i].add(newObject);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tmarauroa.perceptionHandler.addChanges(object[i].get(id), diff[\"s\"][i][j])\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// events\n\t\tif (typeof(diff[\"e\"]) !== \"undefined\" && typeof(object.onEvent) !== \"undefined\") {\n\t\t\tfor (var i in diff[\"e\"]) {\n\t\t\t\tif (diff[\"e\"].hasOwnProperty(i)) {\n\t\t\t\t\tobject.onEvent(diff[\"e\"][i]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// TODO: links\n\t}\n}\n","/***************************************************************************\n *                   (C) Copyright 2011-2017 - Marauroa                    *\n ***************************************************************************\n ***************************************************************************\n *                                                                         *\n *   This program is free software; you can redistribute it and/or modify  *\n *   it under the terms of the GNU General Public License as published by  *\n *   the Free Software Foundation; either version 2 of the License, or     *\n *   (at your option) any later version.                                   *\n *                                                                         *\n ***************************************************************************/\n\n\"use strict\";\n\nvar marauroa = window.marauroa = window.marauroa || {};\n\n/**\n * creates RPObjects\n *\n * use the rpclass name as attribute name for a prototype object\n */\nmarauroa.rpobjectFactory = new function(){\n\tthis[\"_default\"] = function() {};\n\tthis[\"_default\"].onEvent = function(e) {\n\t\tvar event = marauroa.rpeventFactory.create(e[\"c\"]);\n\t\tfor (var i in e[\"a\"]) {\n\t\t\tif (e[\"a\"].hasOwnProperty(i)) {\n\t\t\t\tevent[i] = e[\"a\"][i];\n\t\t\t}\n\t\t\tevent[\"_rpclass\"] = e[\"c\"];\n\t\t}\n\t\t// Event slots\n\t\tfor (var slot in e[\"s\"]) {\n\t\t\tif (e[\"s\"].hasOwnProperty(slot)) {\n\t\t\t\tevent[slot] = e[\"s\"][slot];\n\t\t\t}\n\t\t}\n\t\tevent.execute(this);\n\t}\n\tthis[\"_default\"].set = function(key, value) {\n\t\tthis[key] = value;\n\t}\n\tthis[\"_default\"].setMapEntry = function(map, key, value) {\n\t\tthis[map][key] = value;\n\t}\n\tthis[\"_default\"].unset = function(key) {\n\t\tdelete this[key];\n\t}\n\tthis[\"_default\"].unsetMapEntry = function(map, key) {\n\t\tdelete this[map][key];\n\t}\n\tthis[\"_default\"].destroy = function(parent) {\n\t\t// do nothing\n\t}\n\tthis[\"_default\"].createSlot = function(name) {\n\t\tvar slot = marauroa.rpslotFactory.create(name);\n\t\tslot._parent = this;\n\t\treturn slot;\n\t}\n\n\tthis[\"_default\"].init = function() {\n\t\t// do nothing\n\t}\n\n\tthis.create = function(rpclass) {\n\t\tvar ctor = this[\"_default\"];\n\t\tif (typeof(this[rpclass]) != \"undefined\") {\n\t\t\tctor = this[rpclass];\n\t\t}\n\t\tvar temp = marauroa.util.fromProto(ctor);\n\t\ttemp.init();\n\t\treturn temp;\n\t}\n}\n\n\n\n\n/**\n * creates RPEvent\n *\n * use the rpclass name as attribute name for a prototype object\n */\nmarauroa.rpeventFactory = new function(){\n\tthis[\"_default\"] = function() {};\n\tthis[\"_default\"].execute = function(rpobject) {\n\t\tif (marauroa.debug.unknownEvents) {\n\t\t\tconsole.log(\"Unhandled event: \", this, \" on \", rpobject);\n\t\t}\n\t}\n\n\tthis.create = function(rpclass) {\n\t\tvar ctor = this[\"_default\"];\n\t\tif (typeof(this[rpclass]) != \"undefined\") {\n\t\t\tctor = this[rpclass];\n\t\t}\n\t\treturn marauroa.util.fromProto(ctor);\n\t}\n}\n\n\n\n/**\n * creates RPSlot\n *\n * use the rpclass name as attribute name for a prototype object\n */\nmarauroa.rpslotFactory = new function(){\n\tthis[\"_default\"] = function() {\n\t\t// this method is never called?!\n\t\tthis._objects = [];\n\t};\n\tthis[\"_default\"].add = function(value) {\n\t\tif (value && value[\"id\"]) {\n\t\t\tthis._objects.push(value);\n\t\t}\n\t}\n\tthis[\"_default\"].get = function(key) {\n\t\tvar idx = this.getIndex(key);\n\t\tif (idx > -1) {\n\t\t\treturn this._objects[idx];\n\t\t}\n\t\treturn undefined;\n\t}\n\tthis[\"_default\"].getByIndex = function(idx) {\n\t\treturn this._objects[idx];\n\t}\n\tthis[\"_default\"].count = function() {\n\t\treturn this._objects.length;\n\t}\n\tthis[\"_default\"].getIndex = function(key) {\n\t\tvar i;\n\t\tvar c = this._objects.length;\n\t\tfor (i = 0; i < c; i++) {\n\t\t\tif (this._objects[i][\"id\"] === key) {\n\t\t\t\treturn i;\n\t\t\t}\n\t\t}\n\t\treturn -1;\n\t}\n\tthis[\"_default\"].del = function(key) {\n\t\tvar idx = this.getIndex(key);\n\t\tif (idx > -1) {\n\t\t\tthis._objects.splice(idx, 1);\n\t\t}\n\t}\n\tthis[\"_default\"].first = function() {\n\t\tif (this._objects.length > 0) {\n\t\t\treturn this._objects[0];\n\t\t}\n\t\treturn undefined;\n\t}\n\n\tthis.create = function(name) {\n\t\tvar ctor = this[\"_default\"];\n\t\tif (typeof(this[name]) != \"undefined\") {\n\t\t\tctor = this[name];\n\t\t}\n\t\tvar slot = marauroa.util.fromProto(ctor);\n\t\tslot._name = name;\n\t\tslot._objects = [];\n\t\treturn slot;\n\t}\n};\n","/**\n * @license zlib.js 2012 - imaya [ https://github.com/imaya/zlib.js ]\n * The MIT License\n */\n(function() {'use strict';var k=void 0,aa=this;function r(c,d){var a=c.split(\".\"),b=aa;!(a[0]in b)&&b.execScript&&b.execScript(\"var \"+a[0]);for(var e;a.length&&(e=a.shift());)!a.length&&d!==k?b[e]=d:b=b[e]?b[e]:b[e]={}};var t=\"undefined\"!==typeof Uint8Array&&\"undefined\"!==typeof Uint16Array&&\"undefined\"!==typeof Uint32Array&&\"undefined\"!==typeof DataView;function u(c){var d=c.length,a=0,b=Number.POSITIVE_INFINITY,e,f,g,h,l,n,m,p,s,x;for(p=0;p<d;++p)c[p]>a&&(a=c[p]),c[p]<b&&(b=c[p]);e=1<<a;f=new (t?Uint32Array:Array)(e);g=1;h=0;for(l=2;g<=a;){for(p=0;p<d;++p)if(c[p]===g){n=0;m=h;for(s=0;s<g;++s)n=n<<1|m&1,m>>=1;x=g<<16|p;for(s=n;s<e;s+=l)f[s]=x;++h}++g;h<<=1;l<<=1}return[f,a,b]};function w(c,d){this.g=[];this.h=32768;this.c=this.f=this.d=this.k=0;this.input=t?new Uint8Array(c):c;this.l=!1;this.i=y;this.p=!1;if(d||!(d={}))d.index&&(this.d=d.index),d.bufferSize&&(this.h=d.bufferSize),d.bufferType&&(this.i=d.bufferType),d.resize&&(this.p=d.resize);switch(this.i){case A:this.a=32768;this.b=new (t?Uint8Array:Array)(32768+this.h+258);break;case y:this.a=0;this.b=new (t?Uint8Array:Array)(this.h);this.e=this.u;this.m=this.r;this.j=this.s;break;default:throw Error(\"invalid inflate mode\");\n}}var A=0,y=1;\nw.prototype.t=function(){for(;!this.l;){var c=B(this,3);c&1&&(this.l=!0);c>>>=1;switch(c){case 0:var d=this.input,a=this.d,b=this.b,e=this.a,f=d.length,g=k,h=k,l=b.length,n=k;this.c=this.f=0;if(a+1>=f)throw Error(\"invalid uncompressed block header: LEN\");g=d[a++]|d[a++]<<8;if(a+1>=f)throw Error(\"invalid uncompressed block header: NLEN\");h=d[a++]|d[a++]<<8;if(g===~h)throw Error(\"invalid uncompressed block header: length verify\");if(a+g>d.length)throw Error(\"input buffer is broken\");switch(this.i){case A:for(;e+g>\nb.length;){n=l-e;g-=n;if(t)b.set(d.subarray(a,a+n),e),e+=n,a+=n;else for(;n--;)b[e++]=d[a++];this.a=e;b=this.e();e=this.a}break;case y:for(;e+g>b.length;)b=this.e({o:2});break;default:throw Error(\"invalid inflate mode\");}if(t)b.set(d.subarray(a,a+g),e),e+=g,a+=g;else for(;g--;)b[e++]=d[a++];this.d=a;this.a=e;this.b=b;break;case 1:this.j(ba,ca);break;case 2:for(var m=B(this,5)+257,p=B(this,5)+1,s=B(this,4)+4,x=new (t?Uint8Array:Array)(C.length),Q=k,R=k,S=k,v=k,M=k,F=k,z=k,q=k,T=k,q=0;q<s;++q)x[C[q]]=\nB(this,3);if(!t){q=s;for(s=x.length;q<s;++q)x[C[q]]=0}Q=u(x);v=new (t?Uint8Array:Array)(m+p);q=0;for(T=m+p;q<T;)switch(M=D(this,Q),M){case 16:for(z=3+B(this,2);z--;)v[q++]=F;break;case 17:for(z=3+B(this,3);z--;)v[q++]=0;F=0;break;case 18:for(z=11+B(this,7);z--;)v[q++]=0;F=0;break;default:F=v[q++]=M}R=t?u(v.subarray(0,m)):u(v.slice(0,m));S=t?u(v.subarray(m)):u(v.slice(m));this.j(R,S);break;default:throw Error(\"unknown BTYPE: \"+c);}}return this.m()};\nvar E=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],C=t?new Uint16Array(E):E,G=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,258,258],H=t?new Uint16Array(G):G,I=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0],J=t?new Uint8Array(I):I,K=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],L=t?new Uint16Array(K):K,N=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,\n13],O=t?new Uint8Array(N):N,P=new (t?Uint8Array:Array)(288),U,da;U=0;for(da=P.length;U<da;++U)P[U]=143>=U?8:255>=U?9:279>=U?7:8;var ba=u(P),V=new (t?Uint8Array:Array)(30),W,ea;W=0;for(ea=V.length;W<ea;++W)V[W]=5;var ca=u(V);function B(c,d){for(var a=c.f,b=c.c,e=c.input,f=c.d,g=e.length,h;b<d;){if(f>=g)throw Error(\"input buffer is broken\");a|=e[f++]<<b;b+=8}h=a&(1<<d)-1;c.f=a>>>d;c.c=b-d;c.d=f;return h}\nfunction D(c,d){for(var a=c.f,b=c.c,e=c.input,f=c.d,g=e.length,h=d[0],l=d[1],n,m;b<l&&!(f>=g);)a|=e[f++]<<b,b+=8;n=h[a&(1<<l)-1];m=n>>>16;if(m>b)throw Error(\"invalid code length: \"+m);c.f=a>>m;c.c=b-m;c.d=f;return n&65535}\nw.prototype.j=function(c,d){var a=this.b,b=this.a;this.n=c;for(var e=a.length-258,f,g,h,l;256!==(f=D(this,c));)if(256>f)b>=e&&(this.a=b,a=this.e(),b=this.a),a[b++]=f;else{g=f-257;l=H[g];0<J[g]&&(l+=B(this,J[g]));f=D(this,d);h=L[f];0<O[f]&&(h+=B(this,O[f]));b>=e&&(this.a=b,a=this.e(),b=this.a);for(;l--;)a[b]=a[b++-h]}for(;8<=this.c;)this.c-=8,this.d--;this.a=b};\nw.prototype.s=function(c,d){var a=this.b,b=this.a;this.n=c;for(var e=a.length,f,g,h,l;256!==(f=D(this,c));)if(256>f)b>=e&&(a=this.e(),e=a.length),a[b++]=f;else{g=f-257;l=H[g];0<J[g]&&(l+=B(this,J[g]));f=D(this,d);h=L[f];0<O[f]&&(h+=B(this,O[f]));b+l>e&&(a=this.e(),e=a.length);for(;l--;)a[b]=a[b++-h]}for(;8<=this.c;)this.c-=8,this.d--;this.a=b};\nw.prototype.e=function(){var c=new (t?Uint8Array:Array)(this.a-32768),d=this.a-32768,a,b,e=this.b;if(t)c.set(e.subarray(32768,c.length));else{a=0;for(b=c.length;a<b;++a)c[a]=e[a+32768]}this.g.push(c);this.k+=c.length;if(t)e.set(e.subarray(d,d+32768));else for(a=0;32768>a;++a)e[a]=e[d+a];this.a=32768;return e};\nw.prototype.u=function(c){var d,a=this.input.length/this.d+1|0,b,e,f,g=this.input,h=this.b;c&&(\"number\"===typeof c.o&&(a=c.o),\"number\"===typeof c.q&&(a+=c.q));2>a?(b=(g.length-this.d)/this.n[2],f=258*(b/2)|0,e=f<h.length?h.length+f:h.length<<1):e=h.length*a;t?(d=new Uint8Array(e),d.set(h)):d=h;return this.b=d};\nw.prototype.m=function(){var c=0,d=this.b,a=this.g,b,e=new (t?Uint8Array:Array)(this.k+(this.a-32768)),f,g,h,l;if(0===a.length)return t?this.b.subarray(32768,this.a):this.b.slice(32768,this.a);f=0;for(g=a.length;f<g;++f){b=a[f];h=0;for(l=b.length;h<l;++h)e[c++]=b[h]}f=32768;for(g=this.a;f<g;++f)e[c++]=d[f];this.g=[];return this.buffer=e};\nw.prototype.r=function(){var c,d=this.a;t?this.p?(c=new Uint8Array(d),c.set(this.b.subarray(0,d))):c=this.b.subarray(0,d):(this.b.length>d&&(this.b.length=d),c=this.b);return this.buffer=c};r(\"Zlib.RawInflate\",w);r(\"Zlib.RawInflate.prototype.decompress\",w.prototype.t);var X={ADAPTIVE:y,BLOCK:A},Y,Z,$,fa;if(Object.keys)Y=Object.keys(X);else for(Z in Y=[],$=0,X)Y[$++]=Z;$=0;for(fa=Y.length;$<fa;++$)Z=Y[$],r(\"Zlib.RawInflate.BufferType.\"+Z,X[Z]);}).call(this);\n","/***************************************************************************\n *                   (C) Copyright 2011-2017 - Marauroa                    *\n ***************************************************************************\n ***************************************************************************\n *                                                                         *\n *   This program is free software; you can redistribute it and/or modify  *\n *   it under the terms of the GNU General Public License as published by  *\n *   the Free Software Foundation; either version 2 of the License, or     *\n *   (at your option) any later version.                                   *\n *                                                                         *\n ***************************************************************************/\n\n\"use strict\";\n\nvar marauroa = window.marauroa = window.marauroa || {};\n\nmarauroa.Deserializer = function(buffer) {\n\tvar offset = 0;\n\tvar view = new DataView(buffer);\n\n\t/**\n\t * This method reads a byte from the Serializer\n\t *\n\t * @return the byte serialized\n\t */\n\tthis.readByte = function() {\n\t\toffset++;\n\t\treturn view.getUInt8(offset - 1);\n\t}\n\n\t/**\n\t * This method reads a short from the Serializer\n\t *\n\t * @return the short serialized\n\t */\n\tthis.readShort = function() {\n\t\toffset += 2;\n\t\treturn view.getInt16(offset - 2, true);\n\t}\n\n\t/**\n\t * This method reads a int from the Serializer\n\t *\n\t * @return the int serialized\n\t */\n\tthis.readInt = function() {\n\t\toffset += 4;\n\t\treturn view.getInt32(offset - 4, true);\n\t}\n\n\t/**\n\t * This method reads a byte array from the Serializer\n\t *\n\t * @return the byte array serialized\n\t */\n\tthis.readByteArray = function() {\n\t\tvar size = view.getUint32(offset, true);\n\t\toffset += size + 4;\n\t\treturn new DataView(buffer, offset - size, size);\n\t}\n\n\t/**\n\t * This method reads a byte array of a maximum length of 255 entries\n\t *\n\t * @return the byte array serialized\n\t */\n\tthis.read255LongByteArray = function() {\n\t\tvar size = view.getUint8(offset, true);\n\t\toffset += size + 1;\n\t\treturn new DataView(buffer, offset - size, size);\n\t}\n\n\t/**\n\t * This method reads a byte array of a maximum length of 65536 entries\n\t *\n\t * @return the byte array serialized\n\t */\n\tthis.read65536LongByteArray = function() {\n\t\tvar size = view.getUint16(offset, true);\n\t\toffset += size + 1;\n\t}\n\n\n\t/**\n\t * This method reads a float from the Serializer\n\t *\n\t * @return the float serialized\n\t */\n\tthis.readFloat = function() {\n\t\toffset += 4;\n\t\treturn view.getFloat32(offset - 4, true);\n\t}\n\n\t/**\n\t * This method reads a String from the Serializer\n\t *\n\t * @return the String serialized\n\t */\n\tthis.readString = function() {\n\t\treturn new TextDecoder(\"utf-8\").decode(this.readByteArray());\n\t}\n\n\t/**\n\t * This method reads a short string (whose size is smaller than 255 bytes\n\t * long)\n\t *\n\t * @return the String serialized\n\t */\n\tthis.read255LongString = function() {\n\t\treturn new TextDecoder(\"utf-8\").decode(this.read255LongByteArray());\n\t}\n\n\t/**\n\t * This method reads a long string (whose size is smaller than 65536 bytes\n\t * long)\n\t *\n\t * @return the String serialized\n\t */\n\tthis.read65536LongString = function() {\n\t\treturn new TextDecoder(\"utf-8\").decode(this.read65536LongByteArray());\n\t}\n\n\t/**\n\t * This method reads a String array from the Serializer\n\t *\n\t * @return the String array serialized\n\t */\n\tthis.readStringArray = function() {\n\t\tvar size = this.readInt();\n\t\tvar res = [];\n\t\tfor (var i = 0; i < size; i++) {\n\t\t\tres.push(this.readString());\n\t\t}\n\t\treturn res;\n\t}\n\n\t/**\n\t * reads an Attributes-object from the stream\n\t *\n\t * @param obj object to read into\n\t * @return obj\n\t */\n\tthis.readAttributes = function(obj) {\n\t\tthis.readString();\n\t\tvar size = this.readInt();\n\t\tfor (var i = 0; i < size; i++) {\n\t\t\tvar code = this.readShort();\n\t\t\tif (code !== -1) {\n\t\t\t\tconsole.error(\"RPClass not supported, yet.\");\n\t\t\t\treturn obj;\n\t\t\t}\n\t\t\tvar key = this.readString();\n\t\t\tvar value = this.readString();\n\t\t\tobj[key] = value;\n\t\t}\n\t\treturn obj;\n\t}\n\n\tthis.readRPObject = function(obj) {\n\t\tthis.readAttributes(obj);\n\n\t\treturn obj;\n\t}\n};\n\nmarauroa.Deserializer.binaryStringToUint = function(binary) {\n    var len = binary.length;\n    var bytes = new Uint8Array( len );\n    for (var i = 0; i < len; i++) {\n        bytes[i] = binary.charCodeAt(i);\n    }\n    return bytes.buffer\n};\n\n/**\n * created a deserializer from a deflated data stream that was encoded using base64.\n *\n * @param base64 base64 string\n * @return Deserializer\n */\nmarauroa.Deserializer.fromDeflatedBase64 = function(base64) {\n    var d = window.atob(base64);\n    var buffer = marauroa.Deserializer.binaryStringToUint(d.substring(2, d.length - 4));\n    var inflate = new window[\"Zlib\"][\"RawInflate\"](buffer);\n    var data = inflate[\"decompress\"]();\n    return new marauroa.Deserializer(data.buffer);\n};\n\n/**\n * created a deserializer from a data stream that was encoded using base64.\n *\n * @param base64 base64 string\n * @return Deserializer\n */\nmarauroa.Deserializer.fromBase64 = function(base64) {\n    return marauroa.Deserializer.fromBinaryString(atob(base64));\n};\n\n\n/**\n * created a deserializer from a data stream\n *\n * @param binary binary string\n * @return Deserializer\n */\nmarauroa.Deserializer.fromBinaryString = function(binary) {\n    var len = binary.length;\n    var bytes = new Uint8Array( len );\n    for (var i = 0; i < len; i++) {\n        bytes[i] = binary.charCodeAt(i);\n    }\n    return new marauroa.Deserializer(bytes.buffer);\n};\n","/***************************************************************************\r\n *                   (C) Copyright 2003-2017 - Stendhal                    *\r\n ***************************************************************************\r\n *                                                                         *\r\n *   This program is free software; you can redistribute it and/or modify  *\r\n *   it under the terms of the GNU Affero General Public License as        *\r\n *   published by the Free Software Foundation; either version 3 of the    *\r\n *   License, or (at your option) any later version.                       *\r\n *                                                                         *\r\n ***************************************************************************/\r\n\r\n\"use strict\";\r\n\r\nvar stendhal = window.stendhal = window.stendhal || {};\r\n\r\nstendhal.config = {\r\n\tsound: {\r\n\t\tplay: false\r\n\t},\r\n\r\n\tgamescreen: {\r\n\t\tblood: true\r\n\t}\r\n};\r\n","\n\t\t\tvar stendhal = window.stendhal = window.stendhal || {};\n\t\t\tstendhal.data = stendhal.data || {};\n\n\t\t\tstendhal.data.build = {\n\t\t\t\tversion: \"1.37.5\",\n\t\t\t\tbuild: \"2021-12-28 20:51:22\",\n\t\t\t\tdist: \"webclient\"\n\t\t\t}\n\t\t","/*\r\n    From: http://jsxgraph.uni-bayreuth.de/wp/tag/gunzip/\r\n\r\n    Copyright 2008,2009\r\n        Matthias Ehmann,\r\n        Michael Gerhaeuser,\r\n        Carsten Miller,\r\n        Bianca Valentin,\r\n        Alfred Wassermann,\r\n        Peter Wilfahrt\r\n\r\n    This file is part of JSXGraph.\r\n\r\n    JSXGraph is free software: you can redistribute it and/or modify\r\n    it under the terms of the GNU Lesser General Public License as published by\r\n    the Free Software Foundation, either version 3 of the License, or\r\n    (at your option) any later version.\r\n\r\n    JSXGraph is distributed in the hope that it will be useful,\r\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n    GNU Lesser General Public License for more details.\r\n\r\n    You should have received a copy of the GNU Lesser General Public License\r\n    along with JSXGraph.  If not, see <http://www.gnu.org/licenses/>.\r\n*/\r\n\r\n/**\r\n * @fileoverview Utilities for uncompressing and base64 decoding\r\n */\r\n\r\n/**\r\n  * @class Util class\r\n  * Class for gunzipping, unzipping and base64 decoding of files.\r\n  * It is used for reading GEONExT, Geogebra and Intergeo files.\r\n  *\r\n  * Only Huffman codes are decoded in gunzip.\r\n  * The code is based on the source code for gunzip.c by Pasi Ojala\r\n  * @see <a href=\"http://www.cs.tut.fi/~albert/Dev/gunzip/gunzip.c\">http://www.cs.tut.fi/~albert/Dev/gunzip/gunzip.c</a>\r\n  * @see <a href=\"http://www.cs.tut.fi/~albert\">http://www.cs.tut.fi/~albert</a>\r\n  */\r\nJXG = {};\r\nJXG.Util = {};\r\n\r\n/**\r\n * Unzip zip files\r\n */\r\nJXG.Util.Unzip = function (barray){\r\n    var outputArr = [],\r\n        output = \"\",\r\n        debug = false,\r\n        gpflags,\r\n        files = 0,\r\n        unzipped = [],\r\n        crc,\r\n        buf32k = new Array(32768),\r\n        bIdx = 0,\r\n        modeZIP=false,\r\n\r\n        CRC, SIZE,\r\n\r\n        bitReverse = [\r\n        0x00, 0x80, 0x40, 0xc0, 0x20, 0xa0, 0x60, 0xe0,\r\n        0x10, 0x90, 0x50, 0xd0, 0x30, 0xb0, 0x70, 0xf0,\r\n        0x08, 0x88, 0x48, 0xc8, 0x28, 0xa8, 0x68, 0xe8,\r\n        0x18, 0x98, 0x58, 0xd8, 0x38, 0xb8, 0x78, 0xf8,\r\n        0x04, 0x84, 0x44, 0xc4, 0x24, 0xa4, 0x64, 0xe4,\r\n        0x14, 0x94, 0x54, 0xd4, 0x34, 0xb4, 0x74, 0xf4,\r\n        0x0c, 0x8c, 0x4c, 0xcc, 0x2c, 0xac, 0x6c, 0xec,\r\n        0x1c, 0x9c, 0x5c, 0xdc, 0x3c, 0xbc, 0x7c, 0xfc,\r\n        0x02, 0x82, 0x42, 0xc2, 0x22, 0xa2, 0x62, 0xe2,\r\n        0x12, 0x92, 0x52, 0xd2, 0x32, 0xb2, 0x72, 0xf2,\r\n        0x0a, 0x8a, 0x4a, 0xca, 0x2a, 0xaa, 0x6a, 0xea,\r\n        0x1a, 0x9a, 0x5a, 0xda, 0x3a, 0xba, 0x7a, 0xfa,\r\n        0x06, 0x86, 0x46, 0xc6, 0x26, 0xa6, 0x66, 0xe6,\r\n        0x16, 0x96, 0x56, 0xd6, 0x36, 0xb6, 0x76, 0xf6,\r\n        0x0e, 0x8e, 0x4e, 0xce, 0x2e, 0xae, 0x6e, 0xee,\r\n        0x1e, 0x9e, 0x5e, 0xde, 0x3e, 0xbe, 0x7e, 0xfe,\r\n        0x01, 0x81, 0x41, 0xc1, 0x21, 0xa1, 0x61, 0xe1,\r\n        0x11, 0x91, 0x51, 0xd1, 0x31, 0xb1, 0x71, 0xf1,\r\n        0x09, 0x89, 0x49, 0xc9, 0x29, 0xa9, 0x69, 0xe9,\r\n        0x19, 0x99, 0x59, 0xd9, 0x39, 0xb9, 0x79, 0xf9,\r\n        0x05, 0x85, 0x45, 0xc5, 0x25, 0xa5, 0x65, 0xe5,\r\n        0x15, 0x95, 0x55, 0xd5, 0x35, 0xb5, 0x75, 0xf5,\r\n        0x0d, 0x8d, 0x4d, 0xcd, 0x2d, 0xad, 0x6d, 0xed,\r\n        0x1d, 0x9d, 0x5d, 0xdd, 0x3d, 0xbd, 0x7d, 0xfd,\r\n        0x03, 0x83, 0x43, 0xc3, 0x23, 0xa3, 0x63, 0xe3,\r\n        0x13, 0x93, 0x53, 0xd3, 0x33, 0xb3, 0x73, 0xf3,\r\n        0x0b, 0x8b, 0x4b, 0xcb, 0x2b, 0xab, 0x6b, 0xeb,\r\n        0x1b, 0x9b, 0x5b, 0xdb, 0x3b, 0xbb, 0x7b, 0xfb,\r\n        0x07, 0x87, 0x47, 0xc7, 0x27, 0xa7, 0x67, 0xe7,\r\n        0x17, 0x97, 0x57, 0xd7, 0x37, 0xb7, 0x77, 0xf7,\r\n        0x0f, 0x8f, 0x4f, 0xcf, 0x2f, 0xaf, 0x6f, 0xef,\r\n        0x1f, 0x9f, 0x5f, 0xdf, 0x3f, 0xbf, 0x7f, 0xff\r\n    ],\r\n\r\n    cplens = [\r\n        3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 15, 17, 19, 23, 27, 31,\r\n        35, 43, 51, 59, 67, 83, 99, 115, 131, 163, 195, 227, 258, 0, 0\r\n    ],\r\n\r\n    cplext = [\r\n        0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2,\r\n        3, 3, 3, 3, 4, 4, 4, 4, 5, 5, 5, 5, 0, 99, 99\r\n    ], /* 99==invalid */\r\n\r\n    cpdist = [\r\n        0x0001, 0x0002, 0x0003, 0x0004, 0x0005, 0x0007, 0x0009, 0x000d,\r\n        0x0011, 0x0019, 0x0021, 0x0031, 0x0041, 0x0061, 0x0081, 0x00c1,\r\n        0x0101, 0x0181, 0x0201, 0x0301, 0x0401, 0x0601, 0x0801, 0x0c01,\r\n        0x1001, 0x1801, 0x2001, 0x3001, 0x4001, 0x6001\r\n    ],\r\n\r\n    cpdext = [\r\n        0,  0,  0,  0,  1,  1,  2,  2,\r\n        3,  3,  4,  4,  5,  5,  6,  6,\r\n        7,  7,  8,  8,  9,  9, 10, 10,\r\n        11, 11, 12, 12, 13, 13\r\n    ],\r\n\r\n    border = [16, 17, 18, 0, 8, 7, 9, 6, 10, 5, 11, 4, 12, 3, 13, 2, 14, 1, 15],\r\n\r\n    bA = barray,\r\n\r\n    bytepos=0,\r\n    bitpos=0,\r\n    bb = 1,\r\n    bits=0,\r\n\r\n    NAMEMAX = 256,\r\n\r\n    nameBuf = [],\r\n\r\n    fileout;\r\n\r\n    function readByte(){\r\n        bits+=8;\r\n        if (bytepos<bA.length){\r\n            //if (debug)\r\n            //    document.write(bytepos+\": \"+bA[bytepos]+\"<br>\");\r\n            return bA[bytepos++];\r\n        } else\r\n            return -1;\r\n    };\r\n\r\n    function byteAlign(){\r\n        bb = 1;\r\n    };\r\n\r\n    function readBit(){\r\n        var carry;\r\n        bits++;\r\n        carry = (bb & 1);\r\n        bb >>= 1;\r\n        if (bb==0){\r\n            bb = readByte();\r\n            carry = (bb & 1);\r\n            bb = (bb>>1) | 0x80;\r\n        }\r\n        return carry;\r\n    };\r\n\r\n    function readBits(a) {\r\n        var res = 0,\r\n            i = a;\r\n\r\n        while(i--) {\r\n            res = (res<<1) | readBit();\r\n        }\r\n        if(a) {\r\n            res = bitReverse[res]>>(8-a);\r\n        }\r\n        return res;\r\n    };\r\n\r\n    function flushBuffer(){\r\n        //document.write('FLUSHBUFFER:'+buf32k);\r\n        bIdx = 0;\r\n    };\r\n    function addBuffer(a){\r\n        SIZE++;\r\n        //CRC=updcrc(a,crc);\r\n        buf32k[bIdx++] = a;\r\n        outputArr.push(String.fromCharCode(a));\r\n        //output+=String.fromCharCode(a);\r\n        if(bIdx==0x8000){\r\n            //document.write('ADDBUFFER:'+buf32k);\r\n            bIdx=0;\r\n        }\r\n    };\r\n\r\n    function HufNode() {\r\n        this.b0=0;\r\n        this.b1=0;\r\n        this.jump = null;\r\n        this.jumppos = -1;\r\n    };\r\n\r\n    var LITERALS = 288;\r\n\r\n    var literalTree = new Array(LITERALS);\r\n    var distanceTree = new Array(32);\r\n    var treepos=0;\r\n    var Places = null;\r\n    var Places2 = null;\r\n\r\n    var impDistanceTree = new Array(64);\r\n    var impLengthTree = new Array(64);\r\n\r\n    var len = 0;\r\n    var fpos = new Array(17);\r\n    fpos[0]=0;\r\n    var flens;\r\n    var fmax;\r\n\r\n    function IsPat() {\r\n        while (1) {\r\n            if (fpos[len] >= fmax)\r\n                return -1;\r\n            if (flens[fpos[len]] == len)\r\n                return fpos[len]++;\r\n            fpos[len]++;\r\n        }\r\n    };\r\n\r\n    function Rec() {\r\n        var curplace = Places[treepos];\r\n        var tmp;\r\n        if (debug)\r\n    \t\tdocument.write(\"<br>len:\"+len+\" treepos:\"+treepos);\r\n        if(len==17) { //war 17\r\n            return -1;\r\n        }\r\n        treepos++;\r\n        len++;\r\n\r\n        tmp = IsPat();\r\n        if (debug)\r\n        \tdocument.write(\"<br>IsPat \"+tmp);\r\n        if(tmp >= 0) {\r\n            curplace.b0 = tmp;    /* leaf cell for 0-bit */\r\n            if (debug)\r\n            \tdocument.write(\"<br>b0 \"+curplace.b0);\r\n        } else {\r\n        /* Not a Leaf cell */\r\n        curplace.b0 = 0x8000;\r\n        if (debug)\r\n        \tdocument.write(\"<br>b0 \"+curplace.b0);\r\n        if(Rec())\r\n            return -1;\r\n        }\r\n        tmp = IsPat();\r\n        if(tmp >= 0) {\r\n            curplace.b1 = tmp;    /* leaf cell for 1-bit */\r\n            if (debug)\r\n            \tdocument.write(\"<br>b1 \"+curplace.b1);\r\n            curplace.jump = null;    /* Just for the display routine */\r\n        } else {\r\n            /* Not a Leaf cell */\r\n            curplace.b1 = 0x8000;\r\n            if (debug)\r\n            \tdocument.write(\"<br>b1 \"+curplace.b1);\r\n            curplace.jump = Places[treepos];\r\n            curplace.jumppos = treepos;\r\n            if(Rec())\r\n                return -1;\r\n        }\r\n        len--;\r\n        return 0;\r\n    };\r\n\r\n    function CreateTree(currentTree, numval, lengths, show) {\r\n        var i;\r\n        /* Create the Huffman decode tree/table */\r\n        //document.write(\"<br>createtree<br>\");\r\n        if (debug)\r\n        \tdocument.write(\"currentTree \"+currentTree+\" numval \"+numval+\" lengths \"+lengths+\" show \"+show);\r\n        Places = currentTree;\r\n        treepos=0;\r\n        flens = lengths;\r\n        fmax  = numval;\r\n        for (i=0;i<17;i++)\r\n            fpos[i] = 0;\r\n        len = 0;\r\n        if(Rec()) {\r\n            //fprintf(stderr, \"invalid huffman tree\\n\");\r\n            if (debug)\r\n            \talert(\"invalid huffman tree\\n\");\r\n            return -1;\r\n        }\r\n        if (debug){\r\n        \tdocument.write('<br>Tree: '+Places.length);\r\n        \tfor (var a=0;a<32;a++){\r\n            \tdocument.write(\"Places[\"+a+\"].b0=\"+Places[a].b0+\"<br>\");\r\n            \tdocument.write(\"Places[\"+a+\"].b1=\"+Places[a].b1+\"<br>\");\r\n        \t}\r\n        }\r\n\r\n        /*if(show) {\r\n            var tmp;\r\n            for(tmp=currentTree;tmp<Places;tmp++) {\r\n                fprintf(stdout, \"0x%03x  0x%03x (0x%04x)\",tmp-currentTree, tmp->jump?tmp->jump-currentTree:0,(tmp->jump?tmp->jump-currentTree:0)*6+0xcf0);\r\n                if(!(tmp.b0 & 0x8000)) {\r\n                    //fprintf(stdout, \"  0x%03x (%c)\", tmp->b0,(tmp->b0<256 && isprint(tmp->b0))?tmp->b0:'\ufffd');\r\n                }\r\n                if(!(tmp.b1 & 0x8000)) {\r\n                    if((tmp.b0 & 0x8000))\r\n                        fprintf(stdout, \"           \");\r\n                    fprintf(stdout, \"  0x%03x (%c)\", tmp->b1,(tmp->b1<256 && isprint(tmp->b1))?tmp->b1:'\ufffd');\r\n                }\r\n                fprintf(stdout, \"\\n\");\r\n            }\r\n        }*/\r\n        return 0;\r\n    };\r\n\r\n    function DecodeValue(currentTree) {\r\n        var len, i,\r\n            xtreepos=0,\r\n            X = currentTree[xtreepos],\r\n            b;\r\n\r\n        /* decode one symbol of the data */\r\n        while(1) {\r\n            b=readBit();\r\n            if (debug)\r\n            \tdocument.write(\"b=\"+b);\r\n            if(b) {\r\n                if(!(X.b1 & 0x8000)){\r\n                \tif (debug)\r\n                    \tdocument.write(\"ret1\");\r\n                    return X.b1;    /* If leaf node, return data */\r\n                }\r\n                X = X.jump;\r\n                len = currentTree.length;\r\n                for (i=0;i<len;i++){\r\n                    if (currentTree[i]===X){\r\n                        xtreepos=i;\r\n                        break;\r\n                    }\r\n                }\r\n                //xtreepos++;\r\n            } else {\r\n                if(!(X.b0 & 0x8000)){\r\n                \tif (debug)\r\n                    \tdocument.write(\"ret2\");\r\n                    return X.b0;    /* If leaf node, return data */\r\n                }\r\n                //X++; //??????????????????\r\n                xtreepos++;\r\n                X = currentTree[xtreepos];\r\n            }\r\n        }\r\n        if (debug)\r\n        \tdocument.write(\"ret3\");\r\n        return -1;\r\n    };\r\n\r\n    function DeflateLoop() {\r\n    var last, c, type, i, len;\r\n\r\n    do {\r\n        /*if((last = readBit())){\r\n            fprintf(errfp, \"Last Block: \");\r\n        } else {\r\n            fprintf(errfp, \"Not Last Block: \");\r\n        }*/\r\n        last = readBit();\r\n        type = readBits(2);\r\n        switch(type) {\r\n            case 0:\r\n            \tif (debug)\r\n                \talert(\"Stored\\n\");\r\n                break;\r\n            case 1:\r\n            \tif (debug)\r\n                \talert(\"Fixed Huffman codes\\n\");\r\n                break;\r\n            case 2:\r\n            \tif (debug)\r\n                \talert(\"Dynamic Huffman codes\\n\");\r\n                break;\r\n            case 3:\r\n            \tif (debug)\r\n                \talert(\"Reserved block type!!\\n\");\r\n                break;\r\n            default:\r\n            \tif (debug)\r\n                \talert(\"Unexpected value %d!\\n\", type);\r\n                break;\r\n        }\r\n\r\n        if(type==0) {\r\n            var blockLen, cSum;\r\n\r\n            // Stored\r\n            byteAlign();\r\n            blockLen = readByte();\r\n            blockLen |= (readByte()<<8);\r\n\r\n            cSum = readByte();\r\n            cSum |= (readByte()<<8);\r\n\r\n            if(((blockLen ^ ~cSum) & 0xffff)) {\r\n                document.write(\"BlockLen checksum mismatch\\n\");\r\n            }\r\n            while(blockLen--) {\r\n                c = readByte();\r\n                addBuffer(c);\r\n            }\r\n        } else if(type==1) {\r\n            var j;\r\n\r\n            /* Fixed Huffman tables -- fixed decode routine */\r\n            while(1) {\r\n            /*\r\n                256    0000000        0\r\n                :   :     :\r\n                279    0010111        23\r\n                0   00110000    48\r\n                :    :      :\r\n                143    10111111    191\r\n                280 11000000    192\r\n                :    :      :\r\n                287 11000111    199\r\n                144    110010000    400\r\n                :    :       :\r\n                255    111111111    511\r\n\r\n                Note the bit order!\r\n                */\r\n\r\n            j = (bitReverse[readBits(7)]>>1);\r\n            if(j > 23) {\r\n                j = (j<<1) | readBit();    /* 48..255 */\r\n\r\n                if(j > 199) {    /* 200..255 */\r\n                    j -= 128;    /*  72..127 */\r\n                    j = (j<<1) | readBit();        /* 144..255 << */\r\n                } else {        /*  48..199 */\r\n                    j -= 48;    /*   0..151 */\r\n                    if(j > 143) {\r\n                        j = j+136;    /* 280..287 << */\r\n                        /*   0..143 << */\r\n                    }\r\n                }\r\n            } else {    /*   0..23 */\r\n                j += 256;    /* 256..279 << */\r\n            }\r\n            if(j < 256) {\r\n                addBuffer(j);\r\n                //document.write(\"out:\"+String.fromCharCode(j));\r\n                /*fprintf(errfp, \"@%d %02x\\n\", SIZE, j);*/\r\n            } else if(j == 256) {\r\n                /* EOF */\r\n                break;\r\n            } else {\r\n                var len, dist;\r\n\r\n                j -= 256 + 1;    /* bytes + EOF */\r\n                len = readBits(cplext[j]) + cplens[j];\r\n\r\n                j = bitReverse[readBits(5)]>>3;\r\n                if(cpdext[j] > 8) {\r\n                    dist = readBits(8);\r\n                    dist |= (readBits(cpdext[j]-8)<<8);\r\n                } else {\r\n                    dist = readBits(cpdext[j]);\r\n                }\r\n                dist += cpdist[j];\r\n\r\n                /*fprintf(errfp, \"@%d (l%02x,d%04x)\\n\", SIZE, len, dist);*/\r\n                for(j=0;j<len;j++) {\r\n                    var c = buf32k[(bIdx - dist) & 0x7fff];\r\n                    addBuffer(c);\r\n                }\r\n            }\r\n            } // while\r\n        } else if(type==2) {\r\n            var j, n, literalCodes, distCodes, lenCodes;\r\n            var ll = new Array(288+32);    // \"static\" just to preserve stack\r\n\r\n            // Dynamic Huffman tables\r\n\r\n            literalCodes = 257 + readBits(5);\r\n            distCodes = 1 + readBits(5);\r\n            lenCodes = 4 + readBits(4);\r\n            //document.write(\"<br>param: \"+literalCodes+\" \"+distCodes+\" \"+lenCodes+\"<br>\");\r\n            for(j=0; j<19; j++) {\r\n                ll[j] = 0;\r\n            }\r\n\r\n            // Get the decode tree code lengths\r\n\r\n            //document.write(\"<br>\");\r\n            for(j=0; j<lenCodes; j++) {\r\n                ll[border[j]] = readBits(3);\r\n                //document.write(ll[border[j]]+\" \");\r\n            }\r\n            //fprintf(errfp, \"\\n\");\r\n            //document.write('<br>ll:'+ll);\r\n            len = distanceTree.length;\r\n            for (i=0; i<len; i++)\r\n                distanceTree[i]=new HufNode();\r\n            if(CreateTree(distanceTree, 19, ll, 0)) {\r\n                flushBuffer();\r\n                return 1;\r\n            }\r\n            if (debug){\r\n            \tdocument.write(\"<br>distanceTree\");\r\n            \tfor(var a=0;a<distanceTree.length;a++){\r\n                \tdocument.write(\"<br>\"+distanceTree[a].b0+\" \"+distanceTree[a].b1+\" \"+distanceTree[a].jump+\" \"+distanceTree[a].jumppos);\r\n                \t/*if (distanceTree[a].jumppos!=-1)\r\n                    \tdocument.write(\" \"+distanceTree[a].jump.b0+\" \"+distanceTree[a].jump.b1);\r\n                \t*/\r\n            \t}\r\n            }\r\n            //document.write('<BR>tree created');\r\n\r\n            //read in literal and distance code lengths\r\n            n = literalCodes + distCodes;\r\n            i = 0;\r\n            var z=-1;\r\n            if (debug)\r\n            \tdocument.write(\"<br>n=\"+n+\" bits: \"+bits+\"<br>\");\r\n            while(i < n) {\r\n                z++;\r\n                j = DecodeValue(distanceTree);\r\n                if (debug)\r\n                \tdocument.write(\"<br>\"+z+\" i:\"+i+\" decode: \"+j+\"    bits \"+bits+\"<br>\");\r\n                if(j<16) {    // length of code in bits (0..15)\r\n                       ll[i++] = j;\r\n                } else if(j==16) {    // repeat last length 3 to 6 times\r\n                       var l;\r\n                    j = 3 + readBits(2);\r\n                    if(i+j > n) {\r\n                        flushBuffer();\r\n                        return 1;\r\n                    }\r\n                    l = i ? ll[i-1] : 0;\r\n                    while(j--) {\r\n                        ll[i++] = l;\r\n                    }\r\n                } else {\r\n                    if(j==17) {        // 3 to 10 zero length codes\r\n                        j = 3 + readBits(3);\r\n                    } else {        // j == 18: 11 to 138 zero length codes\r\n                        j = 11 + readBits(7);\r\n                    }\r\n                    if(i+j > n) {\r\n                        flushBuffer();\r\n                        return 1;\r\n                    }\r\n                    while(j--) {\r\n                        ll[i++] = 0;\r\n                    }\r\n                }\r\n            }\r\n            /*for(j=0; j<literalCodes+distCodes; j++) {\r\n                //fprintf(errfp, \"%d \", ll[j]);\r\n                if ((j&7)==7)\r\n                    fprintf(errfp, \"\\n\");\r\n            }\r\n            fprintf(errfp, \"\\n\");*/\r\n            // Can overwrite tree decode tree as it is not used anymore\r\n            len = literalTree.length;\r\n            for (i=0; i<len; i++)\r\n                literalTree[i]=new HufNode();\r\n            if(CreateTree(literalTree, literalCodes, ll, 0)) {\r\n                flushBuffer();\r\n                return 1;\r\n            }\r\n            len = literalTree.length;\r\n            for (i=0; i<len; i++)\r\n                distanceTree[i]=new HufNode();\r\n            var ll2 = new Array();\r\n            for (i=literalCodes; i <ll.length; i++){\r\n                ll2[i-literalCodes]=ll[i];\r\n            }\r\n            if(CreateTree(distanceTree, distCodes, ll2, 0)) {\r\n                flushBuffer();\r\n                return 1;\r\n            }\r\n            if (debug)\r\n           \t\tdocument.write(\"<br>literalTree\");\r\n            while(1) {\r\n                j = DecodeValue(literalTree);\r\n                if(j >= 256) {        // In C64: if carry set\r\n                    var len, dist;\r\n                    j -= 256;\r\n                    if(j == 0) {\r\n                        // EOF\r\n                        break;\r\n                    }\r\n                    j--;\r\n                    len = readBits(cplext[j]) + cplens[j];\r\n\r\n                    j = DecodeValue(distanceTree);\r\n                    if(cpdext[j] > 8) {\r\n                        dist = readBits(8);\r\n                        dist |= (readBits(cpdext[j]-8)<<8);\r\n                    } else {\r\n                        dist = readBits(cpdext[j]);\r\n                    }\r\n                    dist += cpdist[j];\r\n                    while(len--) {\r\n                        var c = buf32k[(bIdx - dist) & 0x7fff];\r\n                        addBuffer(c);\r\n                    }\r\n                } else {\r\n                    addBuffer(j);\r\n                }\r\n            }\r\n        }\r\n    } while(!last);\r\n    flushBuffer();\r\n\r\n    byteAlign();\r\n    return 0;\r\n};\r\n\r\nJXG.Util.Unzip.prototype.unzipFile = function(name) {\r\n    var i;\r\n\tthis.unzip();\r\n\t//alert(unzipped[0][1]);\r\n\tfor (i=0;i<unzipped.length;i++){\r\n\t\tif(unzipped[i][1]==name) {\r\n\t\t\treturn unzipped[i][0];\r\n\t\t}\r\n\t}\r\n\r\n  };\r\n\r\n\r\nJXG.Util.Unzip.prototype.unzip = function() {\r\n\t//convertToByteArray(input);\r\n\tif (debug)\r\n\t\talert(bA);\r\n\t/*for (i=0;i<bA.length*8;i++){\r\n\t\tdocument.write(readBit());\r\n\t\tif ((i+1)%8==0)\r\n\t\t\tdocument.write(\" \");\r\n\t}*/\r\n\t/*for (i=0;i<bA.length;i++){\r\n\t\tdocument.write(readByte()+\" \");\r\n\t\tif ((i+1)%8==0)\r\n\t\t\tdocument.write(\" \");\r\n\t}\r\n\tfor (i=0;i<bA.length;i++){\r\n\t\tdocument.write(bA[i]+\" \");\r\n\t\tif ((i+1)%16==0)\r\n\t\t\tdocument.write(\"<br>\");\r\n\t}\r\n\t*/\r\n\t//alert(bA);\r\n\tnextFile();\r\n\treturn unzipped;\r\n  };\r\n\r\n function nextFile(){\r\n \tif (debug)\r\n \t\talert(\"NEXTFILE\");\r\n \toutputArr = [];\r\n \tvar tmp = [];\r\n \tmodeZIP = false;\r\n\ttmp[0] = readByte();\r\n\ttmp[1] = readByte();\r\n\tif (debug)\r\n\t\talert(\"type: \"+tmp[0]+\" \"+tmp[1]);\r\n\tif (tmp[0] == parseInt(\"78\",16) && tmp[1] == parseInt(\"da\",16)){ //GZIP\r\n\t\tif (debug)\r\n\t\t\talert(\"GEONExT-GZIP\");\r\n\t\tDeflateLoop();\r\n\t\tif (debug)\r\n\t\t\talert(outputArr.join(''));\r\n\t\tunzipped[files] = new Array(2);\r\n    \tunzipped[files][0] = outputArr.join('');\r\n    \tunzipped[files][1] = \"geonext.gxt\";\r\n    \tfiles++;\r\n\t}\r\n\tif (tmp[0] == parseInt(\"1f\",16) && tmp[1] == parseInt(\"8b\",16)){ //GZIP\r\n\t\tif (debug)\r\n\t\t\talert(\"GZIP\");\r\n\t\t//DeflateLoop();\r\n\t\tskipdir();\r\n\t\tif (debug)\r\n\t\t\talert(outputArr.join(''));\r\n\t\tunzipped[files] = new Array(2);\r\n    \tunzipped[files][0] = outputArr.join('');\r\n    \tunzipped[files][1] = \"file\";\r\n    \tfiles++;\r\n\t}\r\n\tif (tmp[0] == parseInt(\"50\",16) && tmp[1] == parseInt(\"4b\",16)){ //ZIP\r\n\t\tmodeZIP = true;\r\n\t\ttmp[2] = readByte();\r\n\t\ttmp[3] = readByte();\r\n\t\tif (tmp[2] == parseInt(\"3\",16) && tmp[3] == parseInt(\"4\",16)){\r\n\t\t\t//MODE_ZIP\r\n\t\t\ttmp[0] = readByte();\r\n\t\t\ttmp[1] = readByte();\r\n\t\t\tif (debug)\r\n\t\t\t\talert(\"ZIP-Version: \"+tmp[1]+\" \"+tmp[0]/10+\".\"+tmp[0]%10);\r\n\r\n\t\t\tgpflags = readByte();\r\n\t\t\tgpflags |= (readByte()<<8);\r\n\t\t\tif (debug)\r\n\t\t\t\talert(\"gpflags: \"+gpflags);\r\n\r\n\t\t\tvar method = readByte();\r\n\t\t\tmethod |= (readByte()<<8);\r\n\t\t\tif (debug)\r\n\t\t\t\talert(\"method: \"+method);\r\n\r\n\t\t\treadByte();\r\n\t\t\treadByte();\r\n\t\t\treadByte();\r\n\t\t\treadByte();\r\n\r\n\t\t\tvar crc = readByte();\r\n\t\t\tcrc |= (readByte()<<8);\r\n\t\t\tcrc |= (readByte()<<16);\r\n\t\t\tcrc |= (readByte()<<24);\r\n\r\n\t\t\tvar compSize = readByte();\r\n\t\t\tcompSize |= (readByte()<<8);\r\n\t\t\tcompSize |= (readByte()<<16);\r\n\t\t\tcompSize |= (readByte()<<24);\r\n\r\n\t\t\tvar size = readByte();\r\n\t\t\tsize |= (readByte()<<8);\r\n\t\t\tsize |= (readByte()<<16);\r\n\t\t\tsize |= (readByte()<<24);\r\n\r\n\t\t\tif (debug)\r\n\t\t\t\talert(\"local CRC: \"+crc+\"\\nlocal Size: \"+size+\"\\nlocal CompSize: \"+compSize);\r\n\r\n\t\t\tvar filelen = readByte();\r\n\t\t\tfilelen |= (readByte()<<8);\r\n\r\n\t\t\tvar extralen = readByte();\r\n\t\t\textralen |= (readByte()<<8);\r\n\r\n\t\t\tif (debug)\r\n\t\t\t\talert(\"filelen \"+filelen);\r\n\t\t\ti = 0;\r\n\t\t\tnameBuf = [];\r\n\t\t\twhile (filelen--){\r\n\t\t\t\tvar c = readByte();\r\n\t\t\t\tif (c == \"/\" | c ==\":\"){\r\n\t\t\t\t\ti = 0;\r\n\t\t\t\t} else if (i < NAMEMAX-1)\r\n\t\t\t\t\tnameBuf[i++] = String.fromCharCode(c);\r\n\t\t\t}\r\n\t\t\tif (debug)\r\n\t\t\t\talert(\"nameBuf: \"+nameBuf);\r\n\r\n\t\t\t//nameBuf[i] = \"\\0\";\r\n\t\t\tif (!fileout)\r\n\t\t\t\tfileout = nameBuf;\r\n\r\n\t\t\tvar i = 0;\r\n\t\t\twhile (i < extralen){\r\n\t\t\t\tc = readByte();\r\n\t\t\t\ti++;\r\n\t\t\t}\r\n\r\n\t\t\tCRC = 0xffffffff;\r\n\t\t\tSIZE = 0;\r\n\r\n\t\t\tif (size = 0 && fileOut.charAt(fileout.length-1)==\"/\"){\r\n\t\t\t\t//skipdir\r\n\t\t\t\tif (debug)\r\n\t\t\t\t\talert(\"skipdir\");\r\n\t\t\t}\r\n\t\t\tif (method == 8){\r\n\t\t\t\tDeflateLoop();\r\n\t\t\t\tif (debug)\r\n\t\t\t\t\talert(outputArr.join(''));\r\n\t\t\t\tunzipped[files] = new Array(2);\r\n\t\t\t\tunzipped[files][0] = outputArr.join('');\r\n    \t\t\tunzipped[files][1] = nameBuf.join('');\r\n    \t\t\tfiles++;\r\n\t\t\t\t//return outputArr.join('');\r\n\t\t\t}\r\n\t\t\tskipdir();\r\n\t\t}\r\n\t}\r\n };\r\n\r\nfunction skipdir(){\r\n    var crc,\r\n        tmp = [],\r\n        compSize, size, os, i, c;\r\n\r\n\tif ((gpflags & 8)) {\r\n\t\ttmp[0] = readByte();\r\n\t\ttmp[1] = readByte();\r\n\t\ttmp[2] = readByte();\r\n\t\ttmp[3] = readByte();\r\n\r\n\t\tif (tmp[0] == parseInt(\"50\",16) &&\r\n            tmp[1] == parseInt(\"4b\",16) &&\r\n            tmp[2] == parseInt(\"07\",16) &&\r\n            tmp[3] == parseInt(\"08\",16))\r\n        {\r\n            crc = readByte();\r\n            crc |= (readByte()<<8);\r\n            crc |= (readByte()<<16);\r\n            crc |= (readByte()<<24);\r\n\t\t} else {\r\n\t\t\tcrc = tmp[0] | (tmp[1]<<8) | (tmp[2]<<16) | (tmp[3]<<24);\r\n\t\t}\r\n\r\n\t\tcompSize = readByte();\r\n\t\tcompSize |= (readByte()<<8);\r\n\t\tcompSize |= (readByte()<<16);\r\n\t\tcompSize |= (readByte()<<24);\r\n\r\n\t\tsize = readByte();\r\n\t\tsize |= (readByte()<<8);\r\n\t\tsize |= (readByte()<<16);\r\n\t\tsize |= (readByte()<<24);\r\n\r\n\t\tif (debug)\r\n\t\t\talert(\"CRC:\");\r\n\t}\r\n\r\n\tif (modeZIP)\r\n\t\tnextFile();\r\n\r\n\ttmp[0] = readByte();\r\n\tif (tmp[0] != 8) {\r\n\t\tif (debug)\r\n\t\t\talert(\"Unknown compression method!\");\r\n        return 0;\r\n\t}\r\n\r\n\tgpflags = readByte();\r\n\tif (debug){\r\n\t\tif ((gpflags & ~(parseInt(\"1f\",16))))\r\n\t\t\talert(\"Unknown flags set!\");\r\n\t}\r\n\r\n\treadByte();\r\n\treadByte();\r\n\treadByte();\r\n\treadByte();\r\n\r\n\treadByte();\r\n\tos = readByte();\r\n\r\n\tif ((gpflags & 4)){\r\n\t\ttmp[0] = readByte();\r\n\t\ttmp[2] = readByte();\r\n\t\tlen = tmp[0] + 256*tmp[1];\r\n\t\tif (debug)\r\n\t\t\talert(\"Extra field size: \"+len);\r\n\t\tfor (i=0;i<len;i++)\r\n\t\t\treadByte();\r\n\t}\r\n\r\n\tif ((gpflags & 8)){\r\n\t\ti=0;\r\n\t\tnameBuf=[];\r\n\t\twhile (c=readByte()){\r\n\t\t\tif(c == \"7\" || c == \":\")\r\n\t\t\t\ti=0;\r\n\t\t\tif (i<NAMEMAX-1)\r\n\t\t\t\tnameBuf[i++] = c;\r\n\t\t}\r\n\t\t//nameBuf[i] = \"\\0\";\r\n\t\tif (debug)\r\n\t\t\talert(\"original file name: \"+nameBuf);\r\n\t}\r\n\r\n\tif ((gpflags & 16)){\r\n\t\twhile (c=readByte()){\r\n\t\t\t//FILE COMMENT\r\n\t\t}\r\n\t}\r\n\r\n\tif ((gpflags & 2)){\r\n\t\treadByte();\r\n\t\treadByte();\r\n\t}\r\n\r\n\tDeflateLoop();\r\n\r\n\tcrc = readByte();\r\n\tcrc |= (readByte()<<8);\r\n\tcrc |= (readByte()<<16);\r\n\tcrc |= (readByte()<<24);\r\n\r\n\tsize = readByte();\r\n\tsize |= (readByte()<<8);\r\n\tsize |= (readByte()<<16);\r\n\tsize |= (readByte()<<24);\r\n\r\n\tif (modeZIP)\r\n\t\tnextFile();\r\n\r\n};\r\n\r\n};\r\n\r\n/**\r\n*  Base64 encoding / decoding\r\n*  @see <a href=\"http://www.webtoolkit.info/\">http://www.webtoolkit.info/</A>\r\n*/\r\nJXG.Util.Base64 = {\r\n\r\n    // private property\r\n    _keyStr : \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\",\r\n\r\n    // public method for encoding\r\n    encode : function (input) {\r\n        var output = [],\r\n            chr1, chr2, chr3, enc1, enc2, enc3, enc4,\r\n            i = 0;\r\n\r\n        input = JXG.Util.Base64._utf8_encode(input);\r\n\r\n        while (i < input.length) {\r\n\r\n            chr1 = input.charCodeAt(i++);\r\n            chr2 = input.charCodeAt(i++);\r\n            chr3 = input.charCodeAt(i++);\r\n\r\n            enc1 = chr1 >> 2;\r\n            enc2 = ((chr1 & 3) << 4) | (chr2 >> 4);\r\n            enc3 = ((chr2 & 15) << 2) | (chr3 >> 6);\r\n            enc4 = chr3 & 63;\r\n\r\n            if (isNaN(chr2)) {\r\n                enc3 = enc4 = 64;\r\n            } else if (isNaN(chr3)) {\r\n                enc4 = 64;\r\n            }\r\n\r\n            output.push([this._keyStr.charAt(enc1),\r\n                         this._keyStr.charAt(enc2),\r\n                         this._keyStr.charAt(enc3),\r\n                         this._keyStr.charAt(enc4)].join(''));\r\n        }\r\n\r\n        return output.join('');\r\n    },\r\n\r\n    // public method for decoding\r\n    decode : function (input, utf8) {\r\n        var output = [],\r\n            chr1, chr2, chr3,\r\n            enc1, enc2, enc3, enc4,\r\n            i = 0;\r\n\r\n        input = input.replace(/[^A-Za-z0-9\\+\\/\\=]/g, \"\");\r\n\r\n        while (i < input.length) {\r\n\r\n            enc1 = this._keyStr.indexOf(input.charAt(i++));\r\n            enc2 = this._keyStr.indexOf(input.charAt(i++));\r\n            enc3 = this._keyStr.indexOf(input.charAt(i++));\r\n            enc4 = this._keyStr.indexOf(input.charAt(i++));\r\n\r\n            chr1 = (enc1 << 2) | (enc2 >> 4);\r\n            chr2 = ((enc2 & 15) << 4) | (enc3 >> 2);\r\n            chr3 = ((enc3 & 3) << 6) | enc4;\r\n\r\n            output.push(String.fromCharCode(chr1));\r\n\r\n            if (enc3 != 64) {\r\n                output.push(String.fromCharCode(chr2));\r\n            }\r\n            if (enc4 != 64) {\r\n                output.push(String.fromCharCode(chr3));\r\n            }\r\n        }\r\n\r\n        output = output.join('');\r\n\r\n        if (utf8) {\r\n            output = JXG.Util.Base64._utf8_decode(output);\r\n        }\r\n        return output;\r\n\r\n    },\r\n\r\n    // private method for UTF-8 encoding\r\n    _utf8_encode : function (string) {\r\n        string = string.replace(/\\r\\n/g,\"\\n\");\r\n        var utftext = \"\";\r\n\r\n        for (var n = 0; n < string.length; n++) {\r\n\r\n            var c = string.charCodeAt(n);\r\n\r\n            if (c < 128) {\r\n                utftext += String.fromCharCode(c);\r\n            }\r\n            else if((c > 127) && (c < 2048)) {\r\n                utftext += String.fromCharCode((c >> 6) | 192);\r\n                utftext += String.fromCharCode((c & 63) | 128);\r\n            }\r\n            else {\r\n                utftext += String.fromCharCode((c >> 12) | 224);\r\n                utftext += String.fromCharCode(((c >> 6) & 63) | 128);\r\n                utftext += String.fromCharCode((c & 63) | 128);\r\n            }\r\n\r\n        }\r\n\r\n        return utftext;\r\n    },\r\n\r\n    // private method for UTF-8 decoding\r\n    _utf8_decode : function (utftext) {\r\n        var string = [],\r\n            i = 0,\r\n            c = 0, c2 = 0, c3 = 0;\r\n\r\n        while ( i < utftext.length ) {\r\n            c = utftext.charCodeAt(i);\r\n            if (c < 128) {\r\n                string.push(String.fromCharCode(c));\r\n                i++;\r\n            }\r\n            else if((c > 191) && (c < 224)) {\r\n                c2 = utftext.charCodeAt(i+1);\r\n                string.push(String.fromCharCode(((c & 31) << 6) | (c2 & 63)));\r\n                i += 2;\r\n            }\r\n            else {\r\n                c2 = utftext.charCodeAt(i+1);\r\n                c3 = utftext.charCodeAt(i+2);\r\n                string.push(String.fromCharCode(((c & 15) << 12) | ((c2 & 63) << 6) | (c3 & 63)));\r\n                i += 3;\r\n            }\r\n        }\r\n        return string.join('');\r\n    },\r\n\r\n    _destrip: function (stripped, wrap){\r\n        var lines = [], lineno, i,\r\n            destripped = [];\r\n\r\n        if (wrap==null)\r\n            wrap = 76;\r\n\r\n        stripped.replace(/ /g, \"\");\r\n        lineno = stripped.length / wrap;\r\n        for (i = 0; i < lineno; i++)\r\n            lines[i]=stripped.substr(i * wrap, wrap);\r\n        if (lineno != stripped.length / wrap)\r\n            lines[lines.length]=stripped.substr(lineno * wrap, stripped.length-(lineno * wrap));\r\n\r\n        for (i = 0; i < lines.length; i++)\r\n            destripped.push(lines[i]);\r\n        return destripped.join('\\n');\r\n    },\r\n\r\n    decodeAsArray: function (input){\r\n        var dec = this.decode(input),\r\n            ar = [], i;\r\n        for (i=0;i<dec.length;i++){\r\n            ar[i]=dec.charCodeAt(i);\r\n        }\r\n        return ar;\r\n    },\r\n\r\n    decodeGEONExT : function (input) {\r\n        return decodeAsArray(destrip(input),false);\r\n    }\r\n};\r\n\r\n/**\r\n * @private\r\n */\r\nJXG.Util.asciiCharCodeAt = function(str,i){\r\n\tvar c = str.charCodeAt(i);\r\n\tif (c>255){\r\n    \tswitch (c) {\r\n\t\t\tcase 8364: c=128;\r\n\t    \tbreak;\r\n\t    \tcase 8218: c=130;\r\n\t    \tbreak;\r\n\t    \tcase 402: c=131;\r\n\t    \tbreak;\r\n\t    \tcase 8222: c=132;\r\n\t    \tbreak;\r\n\t    \tcase 8230: c=133;\r\n\t    \tbreak;\r\n\t    \tcase 8224: c=134;\r\n\t    \tbreak;\r\n\t    \tcase 8225: c=135;\r\n\t    \tbreak;\r\n\t    \tcase 710: c=136;\r\n\t    \tbreak;\r\n\t    \tcase 8240: c=137;\r\n\t    \tbreak;\r\n\t    \tcase 352: c=138;\r\n\t    \tbreak;\r\n\t    \tcase 8249: c=139;\r\n\t    \tbreak;\r\n\t    \tcase 338: c=140;\r\n\t    \tbreak;\r\n\t    \tcase 381: c=142;\r\n\t    \tbreak;\r\n\t    \tcase 8216: c=145;\r\n\t    \tbreak;\r\n\t    \tcase 8217: c=146;\r\n\t    \tbreak;\r\n\t    \tcase 8220: c=147;\r\n\t    \tbreak;\r\n\t    \tcase 8221: c=148;\r\n\t    \tbreak;\r\n\t    \tcase 8226: c=149;\r\n\t    \tbreak;\r\n\t    \tcase 8211: c=150;\r\n\t    \tbreak;\r\n\t    \tcase 8212: c=151;\r\n\t    \tbreak;\r\n\t    \tcase 732: c=152;\r\n\t    \tbreak;\r\n\t    \tcase 8482: c=153;\r\n\t    \tbreak;\r\n\t    \tcase 353: c=154;\r\n\t    \tbreak;\r\n\t    \tcase 8250: c=155;\r\n\t    \tbreak;\r\n\t    \tcase 339: c=156;\r\n\t    \tbreak;\r\n\t    \tcase 382: c=158;\r\n\t    \tbreak;\r\n\t    \tcase 376: c=159;\r\n\t    \tbreak;\r\n\t    \tdefault:\r\n\t    \tbreak;\r\n\t    }\r\n\t}\r\n\treturn c;\r\n};\r\n\r\n/**\r\n * Decoding string into utf-8\r\n * @param {String} string to decode\r\n * @return {String} utf8 decoded string\r\n */\r\nJXG.Util.utf8Decode = function(utftext) {\r\n  var string = [];\r\n  var i = 0;\r\n  var c = 0, c1 = 0, c2 = 0;\r\n\r\n  while ( i < utftext.length ) {\r\n    c = utftext.charCodeAt(i);\r\n\r\n    if (c < 128) {\r\n      string.push(String.fromCharCode(c));\r\n      i++;\r\n    } else if((c > 191) && (c < 224)) {\r\n      c2 = utftext.charCodeAt(i+1);\r\n      string.push(String.fromCharCode(((c & 31) << 6) | (c2 & 63)));\r\n      i += 2;\r\n    } else {\r\n      c2 = utftext.charCodeAt(i+1);\r\n      c3 = utftext.charCodeAt(i+2);\r\n      string.push(String.fromCharCode(((c & 15) << 12) | ((c2 & 63) << 6) | (c3 & 63)));\r\n      i += 3;\r\n    }\r\n  };\r\n  return string.join('');\r\n};\r\n","/***************************************************************************\r\n *                   (C) Copyright 2017 - Faiumoni e. V.                   *\r\n ***************************************************************************\r\n *                                                                         *\r\n *   This program is free software; you can redistribute it and/or modify  *\r\n *   it under the terms of the GNU Affero General Public License as        *\r\n *   published by the Free Software Foundation; either version 3 of the    *\r\n *   License, or (at your option) any later version.                       *\r\n *                                                                         *\r\n ***************************************************************************/\r\n\r\n\"use strict\";\r\n\r\nvar stendhal = window.stendhal = window.stendhal || {};\r\nstendhal.data = stendhal.data || {};\r\n\r\n/**\r\n * setup a cache that is powered by IndexedDB, but allow synchronous access\r\n * for simplicity of use.\r\n */\r\nstendhal.data.cache = {\r\n\tinit: function() {\r\n\r\n\t\t// https://dzone.com/articles/getting-all-stored-items\r\n\t\tfunction requestAllItems(storeName, callback) {\r\n\t\t\tvar tx = stendhal.data.cache.db.transaction(storeName, IDBTransaction.READ_ONLY);\r\n\t\t\tvar store = tx.objectStore(storeName);\r\n\t\t\tvar items = [];\r\n\r\n\t\t\ttx.oncomplete = function(evt) {\r\n\t\t\t\tcallback(items);\r\n\t\t\t};\r\n\t\t\tvar cursorRequest = store.openCursor();\r\n\t\t\tcursorRequest.onerror = function(error) {\r\n\t\t\t\tconsole.log(error);\r\n\t\t\t};\r\n\t\t\tcursorRequest.onsuccess = function(evt) {\r\n\t\t\t\tvar cursor = evt.target.result;\r\n\t\t\t\tif (cursor) {\r\n\t\t\t\t\titems.push(cursor.value);\r\n\t\t\t\t\tcursor.continue();\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\tstendhal.data.cache.sync = {\r\n\t\t\t\"cid\": \"noIndexedDB\"\r\n\t\t};\r\n\r\n\t\tif (!window.indexedDB) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar open = indexedDB.open(\"stendhal\", 1);\r\n\r\n\t\topen.onupgradeneeded = function() {\r\n\t\t\tvar db = open.result;\r\n\t\t\tdb.createObjectStore(\"cache\", {keyPath: \"key\"});\r\n\t\t};\r\n\r\n\t\topen.onsuccess = function() {\r\n\t\t\tstendhal.data.cache.db = open.result;\r\n\t\t\trequestAllItems(\"cache\", function(items) {\r\n\t\t\t\tvar len = items.length;\r\n\t\t\t\tfor (var i = 0; i < len; i += 1) {\r\n\t\t\t\t\tstendhal.data.cache.sync[items[i].key] = items[i].data;\r\n\t\t\t\t}\r\n\t\t\t\tif (stendhal.data.cache.sync[\"cid\"] === \"noIndexedDB\") {\r\n\t\t\t\t\tstendhal.data.cache.put(\"cid\", (Math.random()*1e48).toString(36));\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t};\r\n\t\topen.onerror = function(event) {\r\n\t\t\tmarauroa = {};\r\n\t\t\tstendhal = {};\r\n\t\t\talert(\"Could not initialize cache.\");\r\n\t\t};\r\n\t},\r\n\r\n\tget: function(key) {\r\n\t\treturn stendhal.data.cache.sync[key];\r\n\t},\r\n\r\n\tput: function(key, value) {\r\n\t\tif (stendhal.data.cache.sync[key] === value) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tstendhal.data.cache.sync[key] = value;\r\n\r\n\t\tvar tx = stendhal.data.cache.db.transaction(\"cache\", \"readwrite\");\r\n\t\tvar store = tx.objectStore(\"cache\");\r\n\t\tstore.put({key: key, data: value});\r\n\t}\r\n}\r\n\r\nstendhal.data.cache.init();\r\n","/***************************************************************************\r\n *                   (C) Copyright 2003-2017 - Stendhal                    *\r\n ***************************************************************************\r\n *                                                                         *\r\n *   This program is free software; you can redistribute it and/or modify  *\r\n *   it under the terms of the GNU Affero General Public License as        *\r\n *   published by the Free Software Foundation; either version 3 of the    *\r\n *   License, or (at your option) any later version.                       *\r\n *                                                                         *\r\n ***************************************************************************/\r\n\r\n\"use strict\";\r\n\r\nvar marauroa = window.marauroa = window.marauroa || {};\r\nvar stendhal = window.stendhal = window.stendhal || {};\r\nstendhal.data = stendhal.data || {};\r\nstendhal.data.cstatus = {\r\n\r\n\tsend: function() {\r\n\t\tif (!marauroa.me || stendhal.data.cache.get(\"cid\") === \"noIndexedDB\") {\r\n\t\t\twindow.setTimeout(stendhal.data.cstatus.send, 1000);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tvar action = {\r\n\t\t\t\"type\": \"cstatus\",\r\n\r\n\t\t\t// the client version, the server will deactivate certain features that\r\n\t\t\t// are incompatible with old clients. E. g. changing of light and dark\r\n\t\t\t// in the current zone is implemented by retransmitting the tileset\r\n\t\t\t// information. an old client would mistake that for a zone change and\r\n\t\t\t// hang.\r\n\t\t\t\"version\": stendhal.data.build.version,\r\n\r\n\t\t\t// The build number is especially helpful for pre releases\r\n\t\t\t\"build\": stendhal.data.build.build,\r\n\r\n\t\t\t// so that we can ask bug reporters to try again with the official\r\n\t\t\t// client, if they are using an unofficial one.\r\n\t\t\t\"dist\": stendhal.data.build.dist,\r\n\r\n\t\t\t// a client id to help with the investigation of hacked accounts\r\n\t\t\t// especially in the common \"angry sibling\" case.\r\n\t\t\t\"cid\": stendhal.data.cache.get(\"cid\")\r\n\t\t};\r\n\t\tmarauroa.clientFramework.sendAction(action);\r\n\t}\r\n}\r\n\r\nwindow.setTimeout(stendhal.data.cstatus.send, 1000);\r\n","/***************************************************************************\r\n *                   (C) Copyright 2017 - Faiumoni e. V.                   *\r\n ***************************************************************************\r\n *                                                                         *\r\n *   This program is free software; you can redistribute it and/or modify  *\r\n *   it under the terms of the GNU Affero General Public License as        *\r\n *   published by the Free Software Foundation; either version 3 of the    *\r\n *   License, or (at your option) any later version.                       *\r\n *                                                                         *\r\n ***************************************************************************/\r\n\r\n\"use strict\";\r\n\r\nvar stendhal = window.stendhal = window.stendhal || {};\r\nstendhal.data = stendhal.data || {};\r\n\r\nstendhal.data.group = {\r\n\tmembers: [],\r\n\tlootmode: \"\",\r\n\tleader: \"\",\r\n\r\n\tupdateGroupStatus: function(members, leader, lootmode) {\r\n\t\tif (members) {\r\n\t\t\tvar memberArray = members.substring(1, members.length - 1).split(\"\\t\");\r\n\t\t\tstendhal.data.group.members = {};\r\n\t\t\tfor (var i = 0; i < memberArray.length; i++) {\r\n\t\t\t\tstendhal.data.group.members[memberArray[i]] = true;\r\n\t\t\t}\r\n\t\t\tstendhal.data.group.leader = leader;\r\n\t\t\tstendhal.data.group.lootmode = lootmode;\r\n\t\t} else {\r\n\t\t\tstendhal.data.group.members = [];\r\n\t\t\tstendhal.data.group.leader = \"\";\r\n\t\t\tstendhal.data.group.lootmode = \"\";\r\n\t\t}\r\n\t}\r\n}\r\n","/***************************************************************************\r\n *                   (C) Copyright 2003-2017 - Stendhal                    *\r\n ***************************************************************************\r\n *                                                                         *\r\n *   This program is free software; you can redistribute it and/or modify  *\r\n *   it under the terms of the GNU Affero General Public License as        *\r\n *   published by the Free Software Foundation; either version 3 of the    *\r\n *   License, or (at your option) any later version.                       *\r\n *                                                                         *\r\n ***************************************************************************/\r\n\"use strict\";\r\n\r\nvar stendhal = window.stendhal = window.stendhal || {};\r\nstendhal.data = stendhal.data || {};\r\n\r\n\t/**\r\n\t * preloads images\r\n\t *\r\n\t * @param images image url to load\r\n\t * @param callback callback to invoke\r\n\t * @constructor\r\n\t */\r\n\t// Start http://www.webreference.com/programming/javascript/gr/column3/\r\n\tfunction ImagePreloader(images, callback) {\r\n\t\t// store the call-back\r\n\t\tthis.callback = callback;\r\n\r\n\t\t// initialize internal state.\r\n\t\tthis.nLoaded = 0;\r\n\t\tthis.nProcessed = 0;\r\n\t\tstendhal.data.map.aImages = new Array;\r\n\r\n\t\t// record the number of images.\r\n\t\tthis.nImages = images.length;\r\n\r\n\t\t// for each image, call preload()\r\n\t\tfor ( var i = 0; i < images.length; i++) {\r\n\t\t\tthis.preload(images[i]);\r\n\t\t}\r\n\t}\r\n\r\n\tImagePreloader.prototype.preload = function(image) {\r\n\t\t// create new Image object and add to array\r\n\t\tvar oImage = new Image;\r\n\t\tstendhal.data.map.aImages.push(oImage);\r\n\r\n\t\t// set up event handlers for the Image object\r\n\t\toImage.onload = ImagePreloader.prototype.onload;\r\n\t\toImage.onerror = ImagePreloader.prototype.onerror;\r\n\t\toImage.onabort = ImagePreloader.prototype.onabort;\r\n\r\n\t\t// assign pointer back to this.\r\n\t\toImage.oImagePreloader = this;\r\n\t\toImage.bLoaded = false;\r\n\r\n\t\t// assign the .src property of the Image object\r\n\t\toImage.src = image;\r\n\t};\r\n\r\n\tImagePreloader.prototype.onComplete = function() {\r\n\t\tthis.nProcessed++;\r\n\t\tif (this.nProcessed == this.nImages) {\r\n\t\t\tthis.callback();\r\n\t\t}\r\n\t};\r\n\r\n\tImagePreloader.prototype.onload = function() {\r\n\t\tthis.bLoaded = true;\r\n\t\tthis.oImagePreloader.nLoaded++;\r\n\t\tthis.oImagePreloader.onComplete();\r\n\t};\r\n\r\n\tImagePreloader.prototype.onerror = function() {\r\n\t\tthis.bError = true;\r\n\t\tthis.oImagePreloader.onComplete();\r\n\t\tconsole.error(\"Error loading \" + this.src);\r\n\t};\r\n\r\n\tImagePreloader.prototype.onabort = function() {\r\n\t\tthis.bAbort = true;\r\n\t\tthis.oImagePreloader.onComplete();\r\n\t\tconsole.error(\"Loading \" + this.src + \" was aborted\");\r\n\t};\r\n\r\n\t// End http://www.webreference.com/programming/javascript/gr/column3/\r\n\r\nstendhal.data.map = {\r\n\r\n\tcurrentZoneName: \"\",\r\n\r\n\toffsetX : 0,\r\n\toffsetY : 0,\r\n\tzoneSizeX : -1,\r\n\tzoneSizeY : -1,\r\n\tsizeX : 20,\r\n\tsizeY : 15,\r\n\r\n\ttileWidth : 32,\r\n\ttileHeight : 32,\r\n\tzoom : 100,\r\n\r\n\taImages : -1,\r\n\tlayerNames : -1,\r\n\tlayers : -1,\r\n\tfirstgids : -1,\r\n\r\n\tdrawingError : false,\r\n\ttargetTileWidth : 0,\r\n\ttargetTileHeight : 0,\r\n\r\n\r\n\t/**\r\n\t * Returns the index of the tileset a tile belongs to.\r\n\t */\r\n\tgetTilesetForGid: function(value) {\r\n\t\tif (value < this.gidsindex.length) {\r\n\t\t\treturn this.gidsindex[value];\r\n\t\t} else {\r\n\t\t\treturn this.gidsindex[this.gidsindex.length - 1] + 1;\r\n\t\t}\r\n\t},\r\n\r\n\tonTransfer: function(zoneName, content) {\r\n\t\tstendhal.data.map.currentZoneName = zoneName;\r\n\t\tstendhal.data.map.firstgids = [];\r\n\t\tstendhal.data.map.layers = [];\r\n\t\tstendhal.data.map.layerNames = [];\r\n\r\n\t\tvar body = document.getElementById(\"body\");\r\n\t\tbody.style.cursor = \"wait\";\r\n\t\tconsole.log(\"load map\");\r\n\r\n\r\n\t\t// tilesets, 0_floor, 1_terrain, 2_object, 3_roof, 4_roof_add,\tblend_ground, blend_roof, protection, collision, data_map\r\n\t\tstendhal.data.map.decodeTileset(content, \"tilesets\");\r\n\t\tstendhal.data.map.decodeMapLayer(content, \"0_floor\");\r\n\t\tstendhal.data.map.decodeMapLayer(content, \"1_terrain\");\r\n\t\tstendhal.data.map.decodeMapLayer(content, \"2_object\");\r\n\t\tstendhal.data.map.decodeMapLayer(content, \"3_roof\");\r\n\t\tstendhal.data.map.decodeMapLayer(content, \"4_roof_add\");\r\n\t\tstendhal.data.map.protection = stendhal.data.map.decodeMapLayer(content, \"protection\");\r\n\t\tstendhal.data.map.collisionData = stendhal.data.map.decodeMapLayer(content, \"collision\");\r\n\t},\r\n\r\n\tdecodeTileset: function(content, name) {\r\n\t\tvar layerData = content[name];\r\n\t\tvar deserializer = marauroa.Deserializer.fromBase64(layerData);\r\n\t\tvar amount = deserializer.readInt();\r\n\r\n\t\tvar images = [];\r\n\t\tfor (var i = 0; i < amount; i++) {\r\n\t\t\tvar name = deserializer.readString();\r\n\t\t\tvar source = deserializer.readString();\r\n\t\t\tvar firstgid = deserializer.readInt()\r\n\r\n\t\t\t// Security Note: The following line triggers a false positive.\r\n\t\t\t// This is not input validation. It just rewrites a path used by the\r\n\t\t\t// Java client to a path matching the webserver directory layout.\r\n\t\t\tvar filename = \"/\" + source.replace(/\\.\\.\\/\\.\\.\\//g, \"\");\r\n\t\t\timages.push(filename);\r\n\t\t\tstendhal.data.map.firstgids.push(firstgid);\r\n\t\t}\r\n\r\n\t\t// create a lookup table from gid to tileset index for a significant performance reasons\r\n\t\tstendhal.data.map.gidsindex = [];\r\n\t\tvar pos, lastStart = 0, i;\r\n\t\tfor (pos = 0; pos < parseInt(stendhal.data.map.firstgids.length, 10); pos++) {\r\n\t\t\tfor (i=lastStart; i<stendhal.data.map.firstgids[pos]; i++) {\r\n\t\t\t\tstendhal.data.map.gidsindex.push(pos - 1);\r\n\t\t\t}\r\n\t\t\tlastStart = stendhal.data.map.firstgids[pos];\r\n\t\t}\r\n\r\n\t\tnew ImagePreloader(images, function() {\r\n\t\t\tvar body = document.getElementById(\"body\");\r\n\t\t\tbody.style.cursor = \"auto\";\r\n\t\t});\r\n\t},\r\n\r\n\tdecodeMapLayer: function(content, name) {\r\n\t\tvar layerData = content[name];\r\n\t\tif (!layerData) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar deserializer = marauroa.Deserializer.fromDeflatedBase64(layerData);\r\n\t\tdeserializer.readString(); // zone name\r\n\t\tstendhal.data.map.zoneSizeX = deserializer.readInt();\r\n\t\tstendhal.data.map.zoneSizeY = deserializer.readInt();\r\n\t\tvar layerRaw = deserializer.readByteArray();\r\n\r\n\t\tvar layer = [];\r\n\t\tfor (var i = 0; i < stendhal.data.map.zoneSizeX * stendhal.data.map.zoneSizeY * 4 - 3; i=i+4) {\r\n\t\t\tvar tileId = (layerRaw.getUint8(i) >>> 0)\r\n\t\t\t\t+ (layerRaw.getUint8(i + 1) << 8)\r\n\t\t\t\t+ (layerRaw.getUint8(i + 2) << 16)\r\n\t\t\t\t+ (layerRaw.getUint8(i + 3) << 24);\r\n\t\t\tlayer.push(tileId);\r\n\t\t}\r\n\r\n\t\tstendhal.data.map.layerNames.push(name);\r\n\t\tstendhal.data.map.layers.push(layer);\r\n\r\n\t\treturn layer;\r\n\t},\r\n\r\n\tcollision: function(x, y) {\r\n\t\treturn this.collisionData[y * stendhal.data.map.zoneSizeX + x] != 0;\r\n\t},\r\n\r\n\tisProtected: function(x, y) {\r\n\t\treturn this.protection[y * stendhal.data.map.zoneSizeX + x] != 0;\r\n\t}\r\n};\r\n","/*\r\n A JavaScript implementation of the SHA family of hashes, as\r\n defined in FIPS PUB 180-4 and FIPS PUB 202, as well as the corresponding\r\n HMAC implementation as defined in FIPS PUB 198a\r\n Copyright Brian Turek 2008-2017\r\n Distributed under the BSD License\r\n See http://caligatio.github.com/jsSHA/ for more information\r\n Several functions taken from Paul Johnston\r\n*/\r\n'use strict';(function(L){function u(d,b,h){var c=0,a=[],l=0,e,m,k,f,n,g,q,v,A=!1,p=[],u=[],w,z=!1,x=!1,t=-1;h=h||{};e=h.encoding||\"UTF8\";w=h.numRounds||1;if(w!==parseInt(w,10)||1>w)throw Error(\"numRounds must a integer >= 1\");if(0===d.lastIndexOf(\"SHA3-\",0)||0===d.lastIndexOf(\"SHAKE\",0)){var C=6;g=B;v=function(c){var a=[],e;for(e=0;5>e;e+=1)a[e]=c[e].slice();return a};t=1;if(\"SHA3-224\"===d)n=1152,f=224;else if(\"SHA3-256\"===d)n=1088,f=256;else if(\"SHA3-384\"===d)n=832,f=384;else if(\"SHA3-512\"===d)n=\r\n576,f=512;else if(\"SHAKE128\"===d)n=1344,f=-1,C=31,x=!0;else if(\"SHAKE256\"===d)n=1088,f=-1,C=31,x=!0;else throw Error(\"Chosen SHA variant is not supported\");q=function(c,a,e,f,d){e=n;var b=C,m,l=[],g=e>>>5,k=0,h=a>>>5;for(m=0;m<h&&a>=e;m+=g)f=B(c.slice(m,m+g),f),a-=e;c=c.slice(m);for(a%=e;c.length<g;)c.push(0);m=a>>>3;c[m>>2]^=b<<m%4*8;c[g-1]^=2147483648;for(f=B(c,f);32*l.length<d;){c=f[k%5][k/5|0];l.push(c.b);if(32*l.length>=d)break;l.push(c.a);k+=1;0===64*k%e&&B(null,f)}return l}}else throw Error(\"Chosen SHA variant is not supported\");\r\nk=D(b,e,t);m=y(d);this.setHMACKey=function(a,b,l){var k;if(!0===A)throw Error(\"HMAC key already set\");if(!0===z)throw Error(\"Cannot set HMAC key after calling update\");if(!0===x)throw Error(\"SHAKE is not supported for HMAC\");e=(l||{}).encoding||\"UTF8\";b=D(b,e,t)(a);a=b.binLen;b=b.value;k=n>>>3;l=k/4-1;if(k<a/8){for(b=q(b,a,0,y(d),f);b.length<=l;)b.push(0);b[l]&=4294967040}else if(k>a/8){for(;b.length<=l;)b.push(0);b[l]&=4294967040}for(a=0;a<=l;a+=1)p[a]=b[a]^909522486,u[a]=b[a]^1549556828;m=g(p,m);\r\nc=n;A=!0};this.update=function(e){var b,f,d,h=0,q=n>>>5;b=k(e,a,l);e=b.binLen;f=b.value;b=e>>>5;for(d=0;d<b;d+=q)h+n<=e&&(m=g(f.slice(d,d+q),m),h+=n);c+=h;a=f.slice(h>>>5);l=e%n;z=!0};this.getHash=function(e,b){var k,g,h,n;if(!0===A)throw Error(\"Cannot call getHash after setting HMAC key\");h=E(b);if(!0===x){if(-1===h.shakeLen)throw Error(\"shakeLen must be specified in options\");f=h.shakeLen}switch(e){case \"HEX\":k=function(a){return F(a,f,t,h)};break;case \"B64\":k=function(a){return G(a,f,t,h)};break;\r\ncase \"BYTES\":k=function(a){return H(a,f,t)};break;case \"ARRAYBUFFER\":try{g=new ArrayBuffer(0)}catch(r){throw Error(\"ARRAYBUFFER not supported by this environment\");}k=function(a){return I(a,f,t)};break;default:throw Error(\"format must be HEX, B64, BYTES, or ARRAYBUFFER\");}n=q(a.slice(),l,c,v(m),f);for(g=1;g<w;g+=1)!0===x&&0!==f%32&&(n[n.length-1]&=16777215>>>24-f%32),n=q(n,f,0,y(d),f);return k(n)};this.getHMAC=function(e,b){var k,h,p,w;if(!1===A)throw Error(\"Cannot call getHMAC without first setting HMAC key\");\r\np=E(b);switch(e){case \"HEX\":k=function(a){return F(a,f,t,p)};break;case \"B64\":k=function(a){return G(a,f,t,p)};break;case \"BYTES\":k=function(a){return H(a,f,t)};break;case \"ARRAYBUFFER\":try{k=new ArrayBuffer(0)}catch(M){throw Error(\"ARRAYBUFFER not supported by this environment\");}k=function(a){return I(a,f,t)};break;default:throw Error(\"outputFormat must be HEX, B64, BYTES, or ARRAYBUFFER\");}h=q(a.slice(),l,c,v(m),f);w=g(u,y(d));w=q(h,f,n,w,f);return k(w)}}function g(d,b){this.a=d;this.b=b}function F(d,\r\nb,h,c){var a=\"\";b/=8;var l,e,m;m=-1===h?3:0;for(l=0;l<b;l+=1)e=d[l>>>2]>>>8*(m+l%4*h),a+=\"0123456789abcdef\".charAt(e>>>4&15)+\"0123456789abcdef\".charAt(e&15);return c.outputUpper?a.toUpperCase():a}function G(d,b,h,c){var a=\"\",l=b/8,e,m,k,f;f=-1===h?3:0;for(e=0;e<l;e+=3)for(m=e+1<l?d[e+1>>>2]:0,k=e+2<l?d[e+2>>>2]:0,k=(d[e>>>2]>>>8*(f+e%4*h)&255)<<16|(m>>>8*(f+(e+1)%4*h)&255)<<8|k>>>8*(f+(e+2)%4*h)&255,m=0;4>m;m+=1)8*e+6*m<=b?a+=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\".charAt(k>>>\r\n6*(3-m)&63):a+=c.b64Pad;return a}function H(d,b,h){var c=\"\";b/=8;var a,l,e;e=-1===h?3:0;for(a=0;a<b;a+=1)l=d[a>>>2]>>>8*(e+a%4*h)&255,c+=String.fromCharCode(l);return c}function I(d,b,h){b/=8;var c,a=new ArrayBuffer(b),l,e;e=new Uint8Array(a);l=-1===h?3:0;for(c=0;c<b;c+=1)e[c]=d[c>>>2]>>>8*(l+c%4*h)&255;return a}function E(d){var b={outputUpper:!1,b64Pad:\"=\",shakeLen:-1};d=d||{};b.outputUpper=d.outputUpper||!1;!0===d.hasOwnProperty(\"b64Pad\")&&(b.b64Pad=d.b64Pad);if(!0===d.hasOwnProperty(\"shakeLen\")){if(0!==\r\nd.shakeLen%8)throw Error(\"shakeLen must be a multiple of 8\");b.shakeLen=d.shakeLen}if(\"boolean\"!==typeof b.outputUpper)throw Error(\"Invalid outputUpper formatting option\");if(\"string\"!==typeof b.b64Pad)throw Error(\"Invalid b64Pad formatting option\");return b}function D(d,b,h){switch(b){case \"UTF8\":case \"UTF16BE\":case \"UTF16LE\":break;default:throw Error(\"encoding must be UTF8, UTF16BE, or UTF16LE\");}switch(d){case \"HEX\":d=function(c,a,b){var e=c.length,d,k,f,g,r,q;if(0!==e%2)throw Error(\"String of HEX type must be in byte increments\");\r\na=a||[0];b=b||0;r=b>>>3;q=-1===h?3:0;for(d=0;d<e;d+=2){k=parseInt(c.substr(d,2),16);if(isNaN(k))throw Error(\"String of HEX type contains invalid characters\");g=(d>>>1)+r;for(f=g>>>2;a.length<=f;)a.push(0);a[f]|=k<<8*(q+g%4*h)}return{value:a,binLen:4*e+b}};break;case \"TEXT\":d=function(c,a,d){var e,m,k=0,f,g,r,q,v,p;a=a||[0];d=d||0;r=d>>>3;if(\"UTF8\"===b)for(p=-1===h?3:0,f=0;f<c.length;f+=1)for(e=c.charCodeAt(f),m=[],128>e?m.push(e):2048>e?(m.push(192|e>>>6),m.push(128|e&63)):55296>e||57344<=e?m.push(224|\r\ne>>>12,128|e>>>6&63,128|e&63):(f+=1,e=65536+((e&1023)<<10|c.charCodeAt(f)&1023),m.push(240|e>>>18,128|e>>>12&63,128|e>>>6&63,128|e&63)),g=0;g<m.length;g+=1){v=k+r;for(q=v>>>2;a.length<=q;)a.push(0);a[q]|=m[g]<<8*(p+v%4*h);k+=1}else if(\"UTF16BE\"===b||\"UTF16LE\"===b)for(p=-1===h?2:0,f=0;f<c.length;f+=1){e=c.charCodeAt(f);\"UTF16LE\"===b&&(g=e&255,e=g<<8|e>>>8);v=k+r;for(q=v>>>2;a.length<=q;)a.push(0);a[q]|=e<<8*(p+v%4*h);k+=2}return{value:a,binLen:8*k+d}};break;case \"B64\":d=function(c,a,b){var e=0,d,g,\r\nf,n,r,q,p,u;if(-1===c.search(/^[a-zA-Z0-9=+\\/]+$/))throw Error(\"Invalid character in base-64 string\");g=c.indexOf(\"=\");c=c.replace(/\\=/g,\"\");if(-1!==g&&g<c.length)throw Error(\"Invalid '=' found in base-64 string\");a=a||[0];b=b||0;q=b>>>3;u=-1===h?3:0;for(g=0;g<c.length;g+=4){r=c.substr(g,4);for(f=n=0;f<r.length;f+=1)d=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\".indexOf(r[f]),n|=d<<18-6*f;for(f=0;f<r.length-1;f+=1){p=e+q;for(d=p>>>2;a.length<=d;)a.push(0);a[d]|=(n>>>16-8*f&255)<<\r\n8*(u+p%4*h);e+=1}}return{value:a,binLen:8*e+b}};break;case \"BYTES\":d=function(c,a,b){var e,d,g,f,n,p;a=a||[0];b=b||0;g=b>>>3;p=-1===h?3:0;for(d=0;d<c.length;d+=1)e=c.charCodeAt(d),n=d+g,f=n>>>2,a.length<=f&&a.push(0),a[f]|=e<<8*(p+n%4*h);return{value:a,binLen:8*c.length+b}};break;case \"ARRAYBUFFER\":try{d=new ArrayBuffer(0)}catch(c){throw Error(\"ARRAYBUFFER not supported by this environment\");}d=function(c,a,b){var d,g,k,f,n,p;a=a||[0];b=b||0;g=b>>>3;n=-1===h?3:0;p=new Uint8Array(c);for(d=0;d<c.byteLength;d+=\r\n1)f=d+g,k=f>>>2,a.length<=k&&a.push(0),a[k]|=p[d]<<8*(n+f%4*h);return{value:a,binLen:8*c.byteLength+b}};break;default:throw Error(\"format must be HEX, TEXT, B64, BYTES, or ARRAYBUFFER\");}return d}function z(d,b){return 32<b?(b-=32,new g(d.b<<b|d.a>>>32-b,d.a<<b|d.b>>>32-b)):0!==b?new g(d.a<<b|d.b>>>32-b,d.b<<b|d.a>>>32-b):d}function p(d,b){return new g(d.a^b.a,d.b^b.b)}function y(d){var b=[];if(0===d.lastIndexOf(\"SHA3-\",0)||0===d.lastIndexOf(\"SHAKE\",0))for(d=0;5>d;d+=1)b[d]=[new g(0,0),new g(0,0),\r\nnew g(0,0),new g(0,0),new g(0,0)];else throw Error(\"No SHA variants supported\");return b}function B(d,b){var h,c,a,l,e=[],m=[];if(null!==d)for(c=0;c<d.length;c+=2)b[(c>>>1)%5][(c>>>1)/5|0]=p(b[(c>>>1)%5][(c>>>1)/5|0],new g(d[c+1],d[c]));for(h=0;24>h;h+=1){l=y(\"SHA3-\");for(c=0;5>c;c+=1){a=b[c][0];var k=b[c][1],f=b[c][2],n=b[c][3],r=b[c][4];e[c]=new g(a.a^k.a^f.a^n.a^r.a,a.b^k.b^f.b^n.b^r.b)}for(c=0;5>c;c+=1)m[c]=p(e[(c+4)%5],z(e[(c+1)%5],1));for(c=0;5>c;c+=1)for(a=0;5>a;a+=1)b[c][a]=p(b[c][a],m[c]);\r\nfor(c=0;5>c;c+=1)for(a=0;5>a;a+=1)l[a][(2*c+3*a)%5]=z(b[c][a],J[c][a]);for(c=0;5>c;c+=1)for(a=0;5>a;a+=1)b[c][a]=p(l[c][a],new g(~l[(c+1)%5][a].a&l[(c+2)%5][a].a,~l[(c+1)%5][a].b&l[(c+2)%5][a].b));b[0][0]=p(b[0][0],K[h])}return b}var J,K;K=[new g(0,1),new g(0,32898),new g(2147483648,32906),new g(2147483648,2147516416),new g(0,32907),new g(0,2147483649),new g(2147483648,2147516545),new g(2147483648,32777),new g(0,138),new g(0,136),new g(0,2147516425),new g(0,2147483658),new g(0,2147516555),new g(2147483648,\r\n139),new g(2147483648,32905),new g(2147483648,32771),new g(2147483648,32770),new g(2147483648,128),new g(0,32778),new g(2147483648,2147483658),new g(2147483648,2147516545),new g(2147483648,32896),new g(0,2147483649),new g(2147483648,2147516424)];J=[[0,36,3,41,18],[1,44,10,45,2],[62,6,43,15,61],[28,55,25,21,56],[27,20,39,8,14]];\"function\"===typeof define&&define.amd?define(function(){return u}):\"undefined\"!==typeof exports?(\"undefined\"!==typeof module&&module.exports&&(module.exports=u),exports=u):\r\nL.jsSHA=u})(this);\r\n","/***************************************************************************\r\n *                   (C) Copyright 2003-2017 - Stendhal                    *\r\n ***************************************************************************\r\n *                                                                         *\r\n *   This program is free software; you can redistribute it and/or modify  *\r\n *   it under the terms of the GNU Affero General Public License as        *\r\n *   published by the Free Software Foundation; either version 3 of the    *\r\n *   License, or (at your option) any later version.                       *\r\n *                                                                         *\r\n ***************************************************************************/\r\n\r\n\"use strict\";\r\n\r\nvar stendhal = window.stendhal = window.stendhal || {};\r\nstendhal.data = stendhal.data || {};\r\n\r\nstendhal.data.sprites = {\r\n\tget: function(filename) {\r\n\t\tif (!filename) {\r\n\t\t\treturn {};\r\n\t\t}\r\n\t\tif (typeof(this[filename]) != \"undefined\") {\r\n\t\t\tthis[filename].counter++;\r\n\t\t\treturn this[filename];\r\n\t\t}\r\n\t\tvar temp = new Image;\r\n\t\ttemp.counter = 0;\r\n\t\ttemp.src = filename;\r\n\t\tthis[filename] = temp;\r\n\t\treturn temp;\r\n\t},\r\n\r\n\tgetWithPromise: function(filename) {\r\n\t\treturn new Promise((resolve) => {\r\n\t\t\tif (typeof(this[filename]) != \"undefined\") {\r\n\t\t\t\tthis[filename].counter++;\r\n\t\t\t\tresolve(this[filename]);\r\n\t\t\t}\r\n\r\n\t\t\tconst image = new Image();\r\n\t\t\timage.counter = 0;\r\n\t\t\tthis[filename] = image;\r\n\t\t\timage.onload = () => resolve(image);\r\n\t\t\timage.src = filename;\r\n\t\t});\r\n\t},\r\n\r\n\t/** deletes all objects that have not been accessed since this method was called last time */\r\n\t// TODO: call clean on map change\r\n\tclean: function() {\r\n\t\tfor (var i in this) {\r\n\t\t\tconsole.log(typeof(i));\r\n\t\t\tif (typeof(i) == \"Image\") {\r\n\t\t\t\tif (this[i].counter > 0) {\r\n\t\t\t\t\tthis[i].counter = 0;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tdelete(this[i]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\t/**\r\n\t * Get an image element whose image data is an area of a specified image.\r\n\t * If the area matches the original image, the image itself is returned.\r\n\t * Otherwise <em>a copy</em> of the image data is returned. This is meant\r\n\t * to be used for obtaining the drag image for drag and drop.\r\n\t *\r\n\t * @param image original image\r\n\t * @param width width of the area\r\n\t * @param height height of the area\r\n\t * @param {number=} offsetX optional. left x coordinate of the area\r\n\t * @param {number=} offsetY optional. top y coordinate of the area\r\n\t */\r\n\tgetAreaOf: function(image, width, height, offsetX, offsetY) {\r\n\t\toffsetX = offsetX || 0;\r\n\t\toffsetY = offsetY || 0;\r\n\t\tif ((image.width === width) && (image.height === height)\r\n\t\t\t\t&& (offsetX === 0) && (offsetY === 0)) {\r\n\t\t\treturn image;\r\n\t\t}\r\n\t\tvar canvas = document.createElement(\"canvas\");\r\n\t\tcanvas.width  = width;\r\n\t\tcanvas.height = height;\r\n\t\tvar ctx = canvas.getContext(\"2d\");\r\n\t\tctx.drawImage(image, offsetX, offsetY, width, height, 0, 0, width, height);\r\n\t\t// Firefox would be able to use the canvas directly as a drag image, but\r\n\t\t// Chrome does not. This should work in any standards compliant browser.\r\n\t\tvar newImage = new Image();\r\n\t\tnewImage.src = canvas.toDataURL(\"image/png\");\r\n\t\treturn newImage;\r\n\t},\r\n\r\n\t/**\r\n\t * @param {string} fileName\r\n\t * @param {string} filter\r\n\t * @param {number=} param\r\n\t */\r\n\tgetFiltered: function(fileName, filter, param) {\r\n\t\tconst img = this.get(fileName);\r\n\t\tif (!img) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tlet filterFn;\r\n\t\tif (typeof(filter) === \"undefined\"\r\n\t\t\t|| !(filterFn = stendhal.data.sprites.filter[filter])\r\n\t\t\t|| img.width === 0 || img.height === 0) {\r\n\t\t\treturn img;\r\n\t\t}\r\n\t\tconst filteredName = fileName + \" \" + filter + \" \" + param;\r\n\t\tlet filtered = this[filteredName];\r\n\t\tif (typeof(filtered) === \"undefined\") {\r\n\t\t\tconst canvas = document.createElement(\"canvas\");\r\n\t\t\tcanvas.width  = img.width;\r\n\t\t\tcanvas.height = img.height;\r\n\t\t\tconst ctx = canvas.getContext(\"2d\");\r\n\t\t\tctx.drawImage(img, 0, 0);\r\n\t\t\tconst imgData = ctx.getImageData(0, 0, img.width, img.height);\r\n\t\t\tconst data = imgData.data;\r\n\t\t\tfilterFn(data, param);\r\n\t\t\tctx.putImageData(imgData, 0, 0);\r\n\t\t\tthis[filteredName] = filtered = canvas;\r\n\t\t}\r\n\r\n\t\treturn filtered;\r\n\t},\r\n\r\n\t/**\r\n\t * @param {string} fileName\r\n\t * @param {string} filter\r\n\t * @param {number=} param\r\n\t */\r\n\tgetFilteredWithPromise: function(fileName, filter, param) {\r\n\t\tconst imgPromise = this.getWithPromise(fileName);\r\n\t\treturn imgPromise.then(function (img) {\r\n\t\t\tlet filterFn;\r\n\t\t\tif (typeof(filter) === \"undefined\"\r\n\t\t\t\t|| !(filterFn = stendhal.data.sprites.filter[filter])\r\n\t\t\t\t|| img.width === 0 || img.height === 0) {\r\n\t\t\t\treturn img;\r\n\t\t\t}\r\n\t\t\tconst filteredName = fileName + \" \" + filter + \" \" + param;\r\n\t\t\tlet filtered = this[filteredName];\r\n\t\t\tif (typeof(filtered) === \"undefined\") {\r\n\t\t\t\tconst canvas = document.createElement(\"canvas\");\r\n\t\t\t\tcanvas.width  = img.width;\r\n\t\t\t\tcanvas.height = img.height;\r\n\t\t\t\tconst ctx = canvas.getContext(\"2d\");\r\n\t\t\t\tctx.drawImage(img, 0, 0);\r\n\t\t\t\tconst imgData = ctx.getImageData(0, 0, img.width, img.height);\r\n\t\t\t\tconst data = imgData.data;\r\n\t\t\t\tfilterFn(data, param);\r\n\t\t\t\tctx.putImageData(imgData, 0, 0);\r\n\t\t\t\tthis[filteredName] = filtered = canvas;\r\n\t\t\t}\r\n\r\n\t\t\treturn filtered;\r\n\t\t});\r\n\t},\r\n\r\n\r\n\t/** Image filters */\r\n\tfilter: {\r\n\t\t// Helper functions\r\n\t\t/**\r\n\t\t * @param {Number} rgb\r\n\t\t * @return {Array<Number>}\r\n\t\t */\r\n\t\tsplitrgb: function(rgb) {\r\n\t\t\trgb &= 0xffffff;\r\n\t\t\tvar b = rgb & 0xff;\r\n\t\t\trgb >>>= 8;\r\n\t\t\tvar g = rgb & 0xff;\r\n\t\t\trgb >>>= 8;\r\n\t\t\treturn [rgb, g, b];\r\n\t\t},\r\n\r\n\t\tmergergb: function(rgbArray) {\r\n\t\t\tconst r = rgbArray[0] << 16;\r\n\t\t\tconst g = rgbArray[1] << 8;\r\n\t\t\treturn 0xffffff & (r | g | rgbArray[2]);\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * @param {Array<Number>} rgb\r\n\t\t * @return {Array<Number>}\r\n\t\t */\r\n\t\trgb2hsl: function(rgb) {\r\n\t\t\tvar r = rgb[0] / 255;\r\n\t\t\tvar g = rgb[1] / 255;\r\n\t\t\tvar b = rgb[2] / 255;\r\n\r\n\t\t\tvar max, min, maxVar;\r\n\t\t\t// Find the max and minimum colors, and remember which one it was\r\n\t\t\tif (r > g) {\r\n\t\t\t\tmax = r;\r\n\t\t\t\tmin = g;\r\n\t\t\t\tmaxVar = 0;\r\n\t\t\t} else {\r\n\t\t\t\tmax = g;\r\n\t\t\t\tmin = r;\r\n\t\t\t\tmaxVar = 1;\r\n\t\t\t}\r\n\t\t\tif (b > max) {\r\n\t\t\t\tmax = b;\r\n\t\t\t\tmaxVar = 2;\r\n\t\t\t} else if (b < min) {\r\n\t\t\t\tmin = b;\r\n\t\t\t}\r\n\r\n\t\t\t// lightness\r\n\t\t\tvar l = (max + min) / 2;\r\n\t\t\tvar s, h;\r\n\r\n\t\t\t// saturation\r\n\t\t\tvar diff = max - min;\r\n\t\t\tif (diff < 0.000001) {\r\n\t\t\t\ts = 0;\r\n\t\t\t\t// hue not really defined, but set it to something reasonable\r\n\t\t\t\th = 0;\r\n\t\t\t} else {\r\n\t\t\t\tif (l < 0.5) {\r\n\t\t\t\t\ts = diff / (max + min);\r\n\t\t\t\t} else {\r\n\t\t\t\t\ts = diff / (2 - max - min);\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// hue\r\n\t\t\t\tif (maxVar === 0) {\r\n\t\t\t\t\th = (g - b) / diff;\r\n\t\t\t\t} else if (maxVar === 1) {\r\n\t\t\t\t\th = 2 + (b - r) / diff;\r\n\t\t\t\t} else {\r\n\t\t\t\t\th = 4 + (r - g) / diff;\r\n\t\t\t\t}\r\n\t\t\t\t// Normalize to range [0, 1]. It's more useful than the usual 360\r\n\t\t\t\th /= 6;\r\n\t\t\t}\r\n\r\n\t\t\treturn [h, s, l];\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * @param {Array<Number>} hsl\r\n\t\t * @return {Array<Number>}\r\n\t\t */\r\n\t\thsl2rgb: function(hsl) {\r\n\t\t\tvar r, g, b;\r\n\t\t\tvar h = hsl[0];\r\n\t\t\tvar s = hsl[1];\r\n\t\t\tvar l = hsl[2];\r\n\r\n\t\t\tif (s < 0.0000001) {\r\n\t\t\t\tr = g = b = Math.floor(255 * l);\r\n\t\t\t} else {\r\n\t\t\t\tvar tmp1, tmp2;\r\n\t\t\t\tif (l < 0.5) {\r\n\t\t\t\t\ttmp1 = l * (1 + s);\r\n\t\t\t\t} else {\r\n\t\t\t\t\ttmp1 = l + s - l * s;\r\n\t\t\t\t}\r\n\t\t\t\ttmp2 = 2 * l - tmp1;\r\n\r\n\t\t\t\tvar rf = this.hue2rgb(this.limitHue(h + 1/3), tmp2, tmp1);\r\n\t\t\t\tvar gf = this.hue2rgb(this.limitHue(h), tmp2, tmp1);\r\n\t\t\t\tvar bf = this.hue2rgb(this.limitHue(h - 1/3), tmp2, tmp1);\r\n\r\n\t\t\t\tr = Math.floor(255 * rf) & 0xff;\r\n\t\t\t\tg = Math.floor(255 * gf) & 0xff;\r\n\t\t\t\tb = Math.floor(255 * bf) & 0xff;\r\n\t\t\t}\r\n\r\n\t\t\treturn [r, g, b];\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * @param {Number} hue\r\n\t\t * @param {Number} val1\r\n\t\t * @param {Number} val2\r\n\t\t */\r\n\t\thue2rgb: function(hue, val1, val2) {\r\n\t\t\tvar res = hue;\r\n\t\t\tif (6 * hue < 1) {\r\n\t\t\t\tres = val1 + (val2 - val1) * 6 * hue;\r\n\t\t\t} else if (2 * hue < 1) {\r\n\t\t\t\tres = val2;\r\n\t\t\t} else if (3 * hue < 2) {\r\n\t\t\t\tres = val1 + (val2 - val1) * (2/3 - hue) * 6;\r\n\t\t\t} else {\r\n\t\t\t\tres = val1;\r\n\t\t\t}\r\n\r\n\t\t\treturn res;\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * @param {Number} hue\r\n\t\t */\r\n\t\tlimitHue: function(hue) {\r\n\t\t\tvar res = hue;\r\n\t\t\tif (res < 0) {\r\n\t\t\t\tres += 1;\r\n\t\t\t} else if (res > 1) {\r\n\t\t\t\tres -= 1;\r\n\t\t\t}\r\n\t\t\treturn res;\r\n\t\t}\r\n\t},\r\n}\r\n\r\n// *** Image filters. Prevent the closure compiler from mangling the names. ***\r\nstendhal.data.sprites.filter['trueColor'] = function(data, color) {\r\n\tvar hslColor = stendhal.data.sprites.filter.rgb2hsl(stendhal.data.sprites.filter.splitrgb(color));\r\n\tvar end = data.length;\r\n\tfor (var i = 0; i < end; i += 4) {\r\n\t\tvar rgb = [data[i], data[i + 1], data[i + 2]];\r\n\t\tvar hsl = stendhal.data.sprites.filter.rgb2hsl(rgb);\r\n\t\t// Adjust the brightness\r\n\t\tvar adj = hslColor[2] - 0.5; // [-0.5, 0.5]\r\n\t\tvar tmp = hsl[2] - 0.5; // [-0.5, 0.5]\r\n\t\t// tweaks the middle lights either upward or downward, depending\r\n\t\t// on if source lightness is high or low\r\n\t\tvar l = hsl[2] - 2.0 * adj * ((tmp * tmp) - 0.25);\r\n\t\tvar resultHsl = [hslColor[0], hslColor[1], l];\r\n\t\tvar resultRgb = stendhal.data.sprites.filter.hsl2rgb(resultHsl);\r\n\t\tdata[i] = resultRgb[0];\r\n\t\tdata[i+1] = resultRgb[1];\r\n\t\tdata[i+2] = resultRgb[2];\r\n\t}\r\n}\r\n","/***************************************************************************\r\n *                   (C) Copyright 2003-2021 - Stendhal                    *\r\n ***************************************************************************\r\n *                                                                         *\r\n *   This program is free software; you can redistribute it and/or modify  *\r\n *   it under the terms of the GNU Affero General Public License as        *\r\n *   published by the Free Software Foundation; either version 3 of the    *\r\n *   License, or (at your option) any later version.                       *\r\n *                                                                         *\r\n ***************************************************************************/\r\n\r\n\"use strict\";\r\n\r\nvar marauroa = window.marauroa = window.marauroa || {};\r\nvar stendhal = window.stendhal = window.stendhal || {};\r\n\r\n\r\n/**\r\n * General entity\r\n */\r\nmarauroa.rpobjectFactory[\"entity\"] = marauroa.util.fromProto(marauroa.rpobjectFactory[\"_default\"], {\r\n\tminimapShow: false,\r\n\tminimapStyle: \"rgb(200,255,200)\",\r\n\tzIndex: 10000,\r\n\r\n\tset: function(key, value) {\r\n\t\tmarauroa.rpobjectFactory[\"entity\"].proto.set.apply(this, arguments);\r\n\t\tif (key === 'name') {\r\n\t\t\tif (typeof(this['title']) === \"undefined\") {\r\n\t\t\t\tthis['title'] = value;\r\n\t\t\t}\r\n\t\t\tthis[\"_name\"] = value;\r\n\t\t} else if (['x', 'y', 'height', 'width'].indexOf(key) > -1) {\r\n\t\t\tthis[key] = parseInt(value, 10);\r\n\t\t} else {\r\n\t\t\tthis[key] = value;\r\n\t\t}\r\n\t},\r\n\r\n\t/**\r\n\t * is the other entity next to this entity?\r\n\t *\r\n\t * @return true, if the other entity is right next to us; false otherwise\r\n\t */\r\n\tisNextTo: function(other) {\r\n\t\tif (!other || !this[\"x\"] || !this[\"y\"] || !other[\"x\"] || !other[\"y\"]) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tvar nextX = ((this[\"x\"] + this[\"width\"] >= other[\"x\"]) && this[\"x\"] <= other[\"x\"])\r\n\t\t\t\t|| ((other[\"x\"] + other[\"width\"] >= this[\"x\"]) && other[\"x\"] <= this[\"x\"]);\r\n\t\tif (!nextX) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tvar nextY = ((this[\"y\"] + this[\"height\"] >= other[\"y\"]) && this[\"y\"] <= other[\"y\"])\r\n\t\t\t|| ((other[\"y\"] + other[\"height\"] >= this[\"y\"]) && other[\"y\"] <= this[\"y\"]);\r\n\t\treturn nextY;\r\n\t},\r\n\r\n\t/**\r\n\t * is this entity visible to a specific action\r\n\t *\r\n\t * @param filter 0: short left click\r\n\t * @return true, if the entity is visible, false otherwise\r\n\t */\r\n\tisVisibleToAction: function(filter) {\r\n\t\treturn false;\r\n\t},\r\n\r\n\t/**\r\n \t * Map descriptive command names to the real commands\r\n\t */\r\n\tactionAliasToAction: function(actionAlias) {\r\n\t\tvar actionAliases = {\r\n\t\t\t\"look_closely\" : \"use\",\r\n\t\t\t\"read\" : \"look\"\r\n\t\t};\r\n\r\n\t\tvar actionCommand = \"look\";\r\n\t\tif (typeof(actionAlias) === \"string\") {\r\n\t\t\tif (actionAliases.hasOwnProperty(actionAlias)) {\r\n\t\t\t\tactionCommand = actionAliases[actionAlias];\r\n\t\t\t} else {\r\n\t\t\t\tactionCommand = actionAlias;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn actionCommand;\r\n\t},\r\n\r\n\tbuildActions: function(list) {\r\n\t\t// menu is an alias for \"Use\" command\r\n\t\tif (this[\"menu\"]) {\r\n\t\t\tvar pos = this[\"menu\"].indexOf(\"|\");\r\n\t\t\tlist.push({\r\n\t\t\t\ttitle: this[\"menu\"].substring(0, pos),\r\n\t\t\t\ttype: this[\"menu\"].substring(pos + 1).toLowerCase()\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\t// action replaces \"Look\" command (e. g. \"look closely\" on signs)\r\n\t\tif (this[\"action\"]) {\r\n\t\t\tlist.push({\r\n\t\t\t\ttitle: stendhal.ui.html.niceName(this[\"action\"]),\r\n\t\t\t\ttype: this.actionAliasToAction(this[\"action\"])\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tlist.push({\r\n\t\t\t\ttitle: \"Look\",\r\n\t\t\t\ttype: \"look\"\r\n\t\t\t});\r\n\t\t}\r\n\t},\r\n\r\n\t/**\r\n\t *  Ensure that the drawing code can rely on _x and _y\r\n\t */\r\n\tupdatePosition: function(time) {\r\n\t\t// The position of non active entities can change too, so always copy\r\n\t\t// the position\r\n\t\tthis[\"_y\"] = this[\"y\"];\r\n\t\tthis[\"_x\"] = this[\"x\"];\r\n\t},\r\n\r\n\tdraw: function(ctx) {\r\n\t\tif (this.sprite) {\r\n\t\t\tthis.drawSprite(ctx);\r\n\t\t}\r\n\t},\r\n\r\n\t/**\r\n\t * draws a standard sprite\r\n\t */\r\n\tdrawSprite: function(ctx) {\r\n\t\tthis.drawSpriteAt(ctx, this[\"x\"] * 32, this[\"y\"] * 32);\r\n\t},\r\n\r\n\tdrawSpriteAt: function(ctx, x, y) {\r\n\t\tvar image = stendhal.data.sprites.get(this.sprite.filename);\r\n\t\tif (image.height) {\r\n\t\t\tvar offsetX = this.sprite.offsetX || 0;\r\n\t\t\tvar offsetY = this.sprite.offsetY || 0;\r\n\t\t\tvar width = this.sprite.width || image.width;\r\n\t\t\tvar height = this.sprite.height || image.height;\r\n\t\t\tctx.drawImage(image, offsetX, offsetY, width, height, x, y, width, height);\r\n\t\t}\r\n\t},\r\n\r\n\t/**\r\n\t * Draws text in specified color with black outline. Setting the font is the\r\n\t * caller's responsibility.\r\n\t *\r\n\t * @param ctx graphics context\r\n\t * @param color text inner color\r\n\t * @param x x coordinate\r\n\t * @param y y coordinate\r\n\t */\r\n\tdrawOutlineText: function(ctx, text, color, x, y) {\r\n\t\tctx.lineWidth = 2;\r\n\t\tctx.strokeStyle = \"black\";\r\n\t\tctx.fillStyle = color;\r\n\t\tctx.lineJoin = \"round\";\r\n\t\tctx.strokeText(text, x, y);\r\n\t\tctx.fillText(text, x, y);\r\n\t},\r\n\r\n\t/**\r\n\t * gets the container path identifying the item\r\n\t *\r\n\t * @returns\r\n\t */\r\n\tgetIdPath: function() {\r\n\t\tvar object = this;\r\n\t\tvar res = \"\";\r\n\t\twhile (object) {\r\n\t\t\tres = object[\"id\"] + \"\\t\" + res;\r\n\t\t\tvar slot = object._parent;\r\n\t\t\tif (!slot) {\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tres = slot._name + \"\\t\" + res;\r\n\t\t\tobject = slot._parent;\r\n\t\t}\r\n\t\treturn \"[\" + res.substr(0, res.length - 1) + \"]\";\r\n\t},\r\n\r\n\t/**\r\n\t * says a text\r\n\t */\r\n\tsay: function (text) {\r\n\t\tif (marauroa.me && marauroa.me.isInHearingRange(this)) {\r\n\t\t\tstendhal.ui.chatLog.addLine(\"normal\", text);\r\n\t\t}\r\n\t},\r\n\r\n\tgetCursor: function(x, y) {\r\n\t\tvar cursor = \"unknown\";\r\n\t\tif (this[\"cursor\"]) {\r\n\t\t\tcursor = this[\"cursor\"];\r\n\t\t}\r\n\r\n\t\treturn \"url(/data/sprites/cursor/\" + cursor.toLowerCase().replace(\"_\", \"\") + \".png) 1 3, auto\";\r\n\t},\r\n\r\n\t/**\r\n\t * Create the default action for this entity. If the entity specifies a\r\n\t * default action description, interpret it as an action command.\r\n\t */\r\n\tgetDefaultAction: function() {\r\n\t\treturn {\r\n\t\t\t\"type\": this.actionAliasToAction(this[\"action\"]),\r\n\t\t\t\"target\": \"#\" + this[\"id\"],\r\n\t\t\t\"zone\": marauroa.currentZoneName\r\n\t\t};\r\n\t},\r\n\r\n\tgetResistance: function() {\r\n\t\treturn this[\"resistance\"];\r\n\t},\r\n\r\n\tisObstacle: function(entity) {\r\n\t\treturn ((entity != this)\r\n\t\t\t&& (this.getResistance() * (entity.getResistance() / 100) > 95));\r\n\t},\r\n\r\n\tonclick: function(x, y) {\r\n\t\tmarauroa.clientFramework.sendAction(this.getDefaultAction());\r\n\t}\r\n});\r\n","/***************************************************************************\r\n *                   (C) Copyright 2003-2020 - Stendhal                    *\r\n ***************************************************************************\r\n *                                                                         *\r\n *   This program is free software; you can redistribute it and/or modify  *\r\n *   it under the terms of the GNU Affero General Public License as        *\r\n *   published by the Free Software Foundation; either version 3 of the    *\r\n *   License, or (at your option) any later version.                       *\r\n *                                                                         *\r\n ***************************************************************************/\r\n\r\n\"use strict\";\r\n\r\nvar marauroa = window.marauroa = window.marauroa || {};\r\n\r\n/**\r\n * Unknown entity\r\n */\r\nmarauroa.rpobjectFactory[\"unknown\"] = marauroa.util.fromProto(marauroa.rpobjectFactory[\"entity\"], {\r\n\tzIndex: 1,\r\n\r\n\tinit: function() {\r\n\t\tmarauroa.rpobjectFactory[\"unknown\"].proto.init.apply(this, arguments);\r\n\t\tvar that = this;\r\n\t\tsetTimeout(function() {\r\n\t\t\tif (that[\"_rpclass\"]) {\r\n\t\t\t\tconsole.log(\"Unknown entity\", that[\"_rpclass\"], \"at\", marauroa.currentZoneName, that[\"x\"], that[\"y\"], \"is\", that);\r\n\t\t\t}\r\n\t\t}, 1);\r\n\t},\r\n\r\n\tisVisibleToAction: function(filter) {\r\n\t\treturn (marauroa.me[\"adminlevel\"] && marauroa.me[\"adminlevel\"] >= 600);\r\n\t}\r\n});\r\n\r\nmarauroa.rpobjectFactory[\"_default\"] = marauroa.rpobjectFactory[\"unknown\"];\r\n","/***************************************************************************\r\n *                   (C) Copyright 2003-2017 - Stendhal                    *\r\n ***************************************************************************\r\n *                                                                         *\r\n *   This program is free software; you can redistribute it and/or modify  *\r\n *   it under the terms of the GNU Affero General Public License as        *\r\n *   published by the Free Software Foundation; either version 3 of the    *\r\n *   License, or (at your option) any later version.                       *\r\n *                                                                         *\r\n ***************************************************************************/\r\n\r\n\"use strict\";\r\n\r\nvar marauroa = window.marauroa = window.marauroa || {};\r\n\r\n/**\r\n * Blood\r\n */\r\nmarauroa.rpobjectFactory[\"blood\"] = marauroa.util.fromProto(marauroa.rpobjectFactory[\"entity\"], {\r\n\r\n\tminimapShow: false,\r\n\tzIndex: 2000,\r\n\r\n\tinit: function() {\r\n\t\tthis.sprite = {\r\n\t\t\theight: 32,\r\n\t\t\twidth: 32,\r\n\t\t\tfilename: \"/data/sprites/combat/blood_red.png\"\r\n\t\t};\r\n\t},\r\n\r\n\tset: function(key, value) {\r\n\t\tmarauroa.rpobjectFactory[\"blood\"].proto.set.apply(this, arguments);\r\n\t\tif (key === \"amount\") {\r\n\t\t\tthis.sprite.offsetY = parseInt(value, 10) * 32;\r\n\t\t} else if (key === \"class\") {\r\n\t\t\tthis.sprite.filename = \"/data/sprites/combat/blood_\" + value + \".png\";\r\n\t\t}\r\n\t},\r\n\r\n\tgetCursor: function(x, y) {\r\n\t\treturn \"url(/data/sprites/cursor/walk.png) 1 3, auto\";\r\n\t}\r\n});\r\n","/***************************************************************************\r\n *                   (C) Copyright 2003-2017 - Stendhal                    *\r\n ***************************************************************************\r\n *                                                                         *\r\n *   This program is free software; you can redistribute it and/or modify  *\r\n *   it under the terms of the GNU Affero General Public License as        *\r\n *   published by the Free Software Foundation; either version 3 of the    *\r\n *   License, or (at your option) any later version.                       *\r\n *                                                                         *\r\n ***************************************************************************/\r\n\r\n\"use strict\";\r\n\r\nvar marauroa = window.marauroa = window.marauroa || {};\r\nvar stendhal = window.stendhal = window.stendhal || {};\r\n\r\nmarauroa.rpobjectFactory[\"corpse\"] = marauroa.util.fromProto(marauroa.rpobjectFactory[\"entity\"], {\r\n\r\n\tminimapShow: false,\r\n\tzIndex: 5500,\r\n\tautoOpenedAlready: false,\r\n\r\n\tset: function(key, value) {\r\n\t\tmarauroa.rpobjectFactory[\"corpse\"].proto.set.apply(this, arguments);\r\n\r\n\t\tthis.sprite = this.sprite || {};\r\n\t\tif (stendhal.config.gamescreen.blood && (key === \"image\")) {\r\n\t\t\tthis.sprite.filename = \"/data/sprites/corpse/\" + value + \".png\";\r\n\t\t} else if (!stendhal.config.gamescreen.blood && (key === \"harmless_image\")) {\r\n\t\t\tthis.sprite.fFilename = \"/data/sprites/corpse/\" + value + \".png\";\r\n\t\t}\r\n\t},\r\n\r\n\tcreateSlot: function(name) {\r\n\t\tvar slot = marauroa.util.fromProto(marauroa.rpslotFactory[\"_default\"], {\r\n\t\t\tadd: function(object) {\r\n\t\t\t\tmarauroa.rpslotFactory[\"_default\"].add.apply(this, arguments);\r\n\t\t\t\tif (this._objects.length > 0) {\r\n\t\t\t\t\tthis._parent.autoOpenIfDesired();\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\tdel: function(key) {\r\n\t\t\t\tmarauroa.rpslotFactory[\"_default\"].del.apply(this, arguments);\r\n\t\t\t\tif (this._objects.length == 0) {\r\n\t\t\t\t\tthis._parent.closeCorpseInventory();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\tslot._name = name;\r\n\t\tslot._objects = [];\r\n\t\tslot._parent = this;\r\n\t\treturn slot;\r\n\t},\r\n\r\n\tisVisibleToAction: function(filter) {\r\n\t\treturn true;\r\n\t},\r\n\r\n\tcloseCorpseInventory: function() {\r\n\t\tif (this.inventory) {\r\n\t\t\tthis.inventory.close();\r\n\t\t}\r\n\t},\r\n\r\n\topenCorpseInventory: function() {\r\n\t\tif (!this.inventory || !this.inventory.popupdiv.parentNode) {\r\n\t\t\tvar content_row = 2;\r\n\t\t\tvar content_col = 2;\r\n\t\t\tvar content_count = 0;\r\n\t\t\tif (this[\"content\"]) {\r\n\t\t\t\tcontent_count = this[\"content\"]._objects.length;\r\n\t\t\t\tif (content_count > 4) {\r\n\t\t\t\t\tcontent_row = Math.ceil(content_count / 2);\r\n\t\t\t\t\tcontent_col = Math.ceil(content_count / content_row);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// FIXME: 3x2 corpses are shown as 6x1\r\n\t\t\tthis.inventory = stendhal.ui.equip.createInventoryWindow(\"content\", content_row, content_col, this, \"Corpse\", true);\r\n\t\t}\r\n\t},\r\n\r\n\tautoOpenIfDesired: function() {\r\n\t\tif (!this.autoOpenedAlready) {\r\n\t\t\tthis.autoOpenedAlready = true;\r\n\t\t\tif (marauroa.me && (this[\"corpse_owner\"] == marauroa.me[\"_name\"])) {\r\n\r\n\t\t\t\t// TODO: for unknown reason, /data/sprites/items/undefined/undefined.png is requested without this delay\r\n\t\t\t\tvar that = this;\r\n\t\t\t\twindow.setTimeout(function() {\r\n\t\t\t\t\tthat.openCorpseInventory();\r\n\t\t\t\t}, 1);\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\tdestroy: function() {\r\n\t\tthis.closeCorpseInventory();\r\n\t},\r\n\r\n\tonclick: function(x, y) {\r\n\t\tthis.openCorpseInventory();\r\n\t},\r\n\r\n\tgetCursor: function(x, y) {\r\n\t\tif (!this[\"content\"] || this[\"content\"]._objects.length === 0) {\r\n\t\t\treturn \"url(/data/sprites/cursor/emptybag.png) 1 3, auto\";\r\n\t\t}\r\n\r\n\t\t// owner\r\n\t\tif (!this[\"corpse_owner\"] || (this[\"corpse_owner\"] == marauroa.me[\"_name\"])) {\r\n\t\t\treturn \"url(/data/sprites/cursor/bag.png) 1 3, auto\";\r\n\t\t}\r\n\r\n\t\tif ((stendhal.data.group.lootmode === \"shared\") && (stendhal.data.group.members[this[\"corpse_owner\"]])) {\r\n\t\t\treturn \"url(/data/sprites/cursor/bag.png) 1 3, auto\";\r\n\t\t}\r\n\t\treturn \"url(/data/sprites/cursor/lockedbag.png) 1 3, auto\";\r\n\t}\r\n\r\n});\r\n","/***************************************************************************\r\n *                   (C) Copyright 2003-2017 - Stendhal                    *\r\n ***************************************************************************\r\n *                                                                         *\r\n *   This program is free software; you can redistribute it and/or modify  *\r\n *   it under the terms of the GNU Affero General Public License as        *\r\n *   published by the Free Software Foundation; either version 3 of the    *\r\n *   License, or (at your option) any later version.                       *\r\n *                                                                         *\r\n ***************************************************************************/\r\n\r\n\"use strict\";\r\n\r\nvar marauroa = window.marauroa = window.marauroa || {};\r\nvar stendhal = window.stendhal = window.stendhal || {};\r\n\r\n(function() {\r\n\r\nvar OPEN_SPRITE = {\r\n\tfilename: \"/data/sprites/chest.png\",\r\n\theight: 32,\r\n\twidth: 32,\r\n\toffsetY: 32\r\n};\r\n\r\nvar CLOSED_SPRITE = {\r\n\tfilename: \"/data/sprites/chest.png\",\r\n\theight: 32,\r\n\twidth: 32\r\n};\r\n\r\nmarauroa.rpobjectFactory[\"chest\"] = marauroa.util.fromProto(marauroa.rpobjectFactory[\"entity\"], {\r\n\tzIndex: 5000,\r\n\tsprite: CLOSED_SPRITE,\r\n\topen: false,\r\n\r\n\tset: function(key, value) {\r\n\t\tmarauroa.rpobjectFactory[\"entity\"].set.apply(this, arguments);\r\n\t\tif (key === \"open\") {\r\n\t\t\tthis.sprite = OPEN_SPRITE;\r\n\t\t\tthis.open = true;\r\n\t\t}\r\n\t\tif (this.isNextTo(marauroa.me)) {\r\n\t\t\tthis.openInventoryWindow();\r\n\t\t}\r\n\t},\r\n\r\n\tunset: function(key) {\r\n\t\tmarauroa.rpobjectFactory[\"entity\"].proto.unset.call(this, key);\r\n\t\tif (key === \"open\") {\r\n\t\t\tthis.sprite = CLOSED_SPRITE;\r\n\t\t\tthis.open = false;\r\n\t\t\tif (this.inventory && this.inventory.popupdiv.parentNode) {\r\n\t\t\t\tthis.inventory.close();\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\tisVisibleToAction: function(filter) {\r\n\t\treturn true;\r\n\t},\r\n\r\n\tonclick: function(x, y) {\r\n\t\tif (marauroa.me.isNextTo(this)) {\r\n\t\t\t// If we are next to the chest, open or close it.\r\n\t\t\tvar action = {\r\n\t\t\t\t\"type\": \"use\",\r\n\t\t\t\t\"target\": \"#\" + this[\"id\"],\r\n\t\t\t\t\"zone\": marauroa.currentZoneName\r\n\t\t\t};\r\n\t\t\tmarauroa.clientFramework.sendAction(action);\r\n\t\t} else {\r\n\t\t\t// We are far away, but if the chest is open, we can take a look\r\n\t\t\tif (this.open) {\r\n\t\t\t\tthis.openInventoryWindow();\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\topenInventoryWindow: function() {\r\n\t\tif (!this.inventory || !this.inventory.popupdiv.parentNode) {\r\n\t\t\tthis.inventory = stendhal.ui.equip.createInventoryWindow(\"content\", 5, 6, this, \"Chest\", false);\r\n\t\t}\r\n\t},\r\n\r\n\tgetCursor: function(x, y) {\r\n\t\treturn \"url(/data/sprites/cursor/bag.png) 1 3, auto\";\r\n\t}\r\n\r\n});\r\n\r\n}());\r\n","/***************************************************************************\r\n *                   (C) Copyright 2003-2017 - Stendhal                    *\r\n ***************************************************************************\r\n *                                                                         *\r\n *   This program is free software; you can redistribute it and/or modify  *\r\n *   it under the terms of the GNU Affero General Public License as        *\r\n *   published by the Free Software Foundation; either version 3 of the    *\r\n *   License, or (at your option) any later version.                       *\r\n *                                                                         *\r\n ***************************************************************************/\r\n\r\n\"use strict\";\r\n\r\nvar marauroa = window.marauroa = window.marauroa || {};\r\nvar stendhal = window.stendhal = window.stendhal || {};\r\n\r\nmarauroa.rpobjectFactory[\"food\"] = marauroa.util.fromProto(marauroa.rpobjectFactory[\"entity\"], {\r\n\tzIndex: 5000,\r\n\r\n\tset: function(key, value) {\r\n\t\tmarauroa.rpobjectFactory[\"entity\"].set.apply(this, arguments);\r\n\t\tif (key === \"amount\") {\r\n\t\t\tthis._amount = parseInt(value, 10);\r\n\t\t}\r\n\t\t// TODO: play sound effect\r\n\t},\r\n\r\n\tdraw: function(ctx) {\r\n\t\tvar image = stendhal.data.sprites.get(\"/data/sprites/food.png\");\r\n\t\tif (image.height) {\r\n\t\t\tvar localX = this[\"x\"] * 32;\r\n\t\t\tvar localY = this[\"y\"] * 32;\r\n\t\t\tvar offset = this._amount * 32;\r\n\t\t\tctx.drawImage(image, 0, offset, 32, 32, localX, localY, 32, 32);\r\n\t\t}\r\n\t},\r\n\r\n\tonclick: function(x, y) {\r\n\t\tvar action = {\r\n\t\t\t\t\"type\": \"look\",\r\n\t\t\t\t\"target\": \"#\" + this[\"id\"]\r\n\t\t\t};\r\n\t\tmarauroa.clientFramework.sendAction(action);\r\n\t},\r\n\r\n\tisVisibleToAction: function(filter) {\r\n\t\treturn true;\r\n\t},\r\n\r\n\tgetCursor: function(x, y) {\r\n\t\treturn \"url(/data/sprites/cursor/look.png) 1 3, auto\";\r\n\t}\r\n\r\n});\r\n","/***************************************************************************\r\n *                   (C) Copyright 2003-2017 - Stendhal                    *\r\n ***************************************************************************\r\n *                                                                         *\r\n *   This program is free software; you can redistribute it and/or modify  *\r\n *   it under the terms of the GNU Affero General Public License as        *\r\n *   published by the Free Software Foundation; either version 3 of the    *\r\n *   License, or (at your option) any later version.                       *\r\n *                                                                         *\r\n ***************************************************************************/\r\n\r\n\"use strict\";\r\n\r\nvar marauroa = window.marauroa = window.marauroa || {};\r\nvar stendhal = window.stendhal = window.stendhal || {};\r\n\r\nmarauroa.rpobjectFactory[\"gate\"] = marauroa.util.fromProto(marauroa.rpobjectFactory[\"entity\"], {\r\n\tzIndex: 5000,\r\n\r\n\tset: function(key, value) {\r\n\t\tmarauroa.rpobjectFactory[\"entity\"].set.apply(this, arguments);\r\n\t\tif (key === \"resistance\") {\r\n\t\t\tthis[\"locked\"] = parseInt(value, 10) !== 0;\r\n\t\t} else if (key === \"image\" || key === \"orientation\") {\r\n\t\t\t// Force re-evaluation of the sprite\r\n\t\t\tdelete this[\"_image\"];\r\n\t\t}\r\n\t},\r\n\r\n\tbuildActions: function(list) {\r\n\t\tvar id = this[\"id\"];\r\n\t\tlist.push({\r\n\t\t\ttitle: (this[\"locked\"]) ? \"Open\" : \"Close\",\r\n\t\t\taction: function(entity) {\r\n\t\t\t\tvar action = {\r\n\t\t\t\t\t\"type\": \"use\",\r\n\t\t\t\t\t\"target\": \"#\" + id,\r\n\t\t\t\t\t\"zone\": marauroa.currentZoneName,\r\n\t\t\t\t};\r\n\t\t\t\tmarauroa.clientFramework.sendAction(action);\r\n\t\t\t}\r\n\t\t});\r\n\t},\r\n\r\n\tdraw: function(ctx) {\r\n\t\tif (this._image == undefined) {\r\n\t\t\tvar filename = \"/data/sprites/doors/\" + this[\"image\"] + \"_\" + this[\"orientation\"] + \".png\";\r\n\t\t\tthis._image = stendhal.data.sprites.get(filename);\r\n\t\t}\r\n\t\tif (this._image.height) {\r\n\t\t\tvar xOffset = -32 * Math.floor(this._image.width / 32 / 2);\r\n\t\t\tvar height = this._image.height / 2;\r\n\t\t\tvar yOffset = -32 * Math.floor(height / 32 / 2);\r\n\t\t\tvar localX = this[\"_x\"] * 32 + xOffset;\r\n\t\t\tvar localY = this[\"_y\"] * 32 + yOffset;\r\n\t\t\tvar yStart = (this[\"locked\"]) ? height : 0;\r\n\t\t\tctx.drawImage(this._image, 0, yStart, this._image.width, height, localX, localY, this._image.width, height);\r\n\t\t}\r\n\t},\r\n\r\n\tisVisibleToAction: function(filter) {\r\n\t\treturn true;\r\n\t},\r\n\r\n\tonclick: function(x, y) {\r\n\t\tvar action = {\r\n\t\t\t\"type\": \"use\",\r\n\t\t\t\"target\": \"#\" + this[\"id\"],\r\n\t\t\t\"zone\": marauroa.currentZoneName\r\n\t\t};\r\n\t\tmarauroa.clientFramework.sendAction(action);\r\n\t},\r\n\r\n\tgetCursor: function(x, y) {\r\n\t\treturn \"url(/data/sprites/cursor/activity.png) 1 3, auto\";\r\n\t}\r\n\r\n});\r\n","/***************************************************************************\r\n *                   (C) Copyright 2003-2018 - Stendhal                    *\r\n ***************************************************************************\r\n *                                                                         *\r\n *   This program is free software; you can redistribute it and/or modify  *\r\n *   it under the terms of the GNU Affero General Public License as        *\r\n *   published by the Free Software Foundation; either version 3 of the    *\r\n *   License, or (at your option) any later version.                       *\r\n *                                                                         *\r\n ***************************************************************************/\r\n\r\n\"use strict\";\r\n\r\nvar marauroa = window.marauroa = window.marauroa || {};\r\nvar stendhal = window.stendhal = window.stendhal || {};\r\n\r\n/**\r\n * InvisibleEntity\r\n */\r\nmarauroa.rpobjectFactory[\"invisible_entity\"] = marauroa.util.fromProto(marauroa.rpobjectFactory[\"entity\"], {\r\n\r\n\tisVisibleToAction: function(filter) {\r\n\t\treturn false;\r\n\t},\r\n\r\n\tgetCursor: function(x, y) {\r\n\t\treturn \"url(/data/sprites/cursor/walk.png) 1 3, auto\";\r\n\t}\r\n\r\n});\r\n\r\nmarauroa.rpobjectFactory[\"area\"] = marauroa.rpobjectFactory[\"invisible_entity\"];\r\nmarauroa.rpobjectFactory[\"looped_sound_source\"] = marauroa.rpobjectFactory[\"invisible_entity\"];\r\nmarauroa.rpobjectFactory[\"tiled_entity\"] = marauroa.rpobjectFactory[\"invisible_entity\"];\r\nmarauroa.rpobjectFactory[\"wall\"] = marauroa.rpobjectFactory[\"invisible_entity\"];\r\nmarauroa.rpobjectFactory[\"blocktarget\"] = marauroa.rpobjectFactory[\"invisible_entity\"];\r\n\r\nmarauroa.rpobjectFactory[\"flyover\"] = marauroa.util.fromProto(marauroa.rpobjectFactory[\"invisible_entity\"], {\r\n\t// TODO:\r\n});\r\n","/***************************************************************************\r\n *                   (C) Copyright 2003-2017 - Stendhal                    *\r\n ***************************************************************************\r\n *                                                                         *\r\n *   This program is free software; you can redistribute it and/or modify  *\r\n *   it under the terms of the GNU Affero General Public License as        *\r\n *   published by the Free Software Foundation; either version 3 of the    *\r\n *   License, or (at your option) any later version.                       *\r\n *                                                                         *\r\n ***************************************************************************/\r\n\r\n\"use strict\";\r\n\r\nvar marauroa = window.marauroa = window.marauroa || {};\r\n\r\n/**\r\n * Item\r\n */\r\nmarauroa.rpobjectFactory[\"item\"] = marauroa.util.fromProto(marauroa.rpobjectFactory[\"entity\"], {\r\n\r\n\tminimapShow: false,\r\n\tminimapStyle: \"rgb(0,255,0)\",\r\n\tzIndex: 7000,\r\n\r\n\tinit: function() {\r\n\t\tthis.sprite = {\r\n\t\t\theight: 32,\r\n\t\t\twidth: 32\r\n\t\t};\r\n\t},\r\n\r\n\tisVisibleToAction: function(filter) {\r\n\t\treturn true;\r\n\t},\r\n\r\n\t// default action for items on the ground is to pick them up\r\n\t// do not require players to use drag & drop (as the classic client did)\r\n\t// because drag & drop is difficult on mobile (especially if the page is zoomed)\r\n\tgetDefaultAction: function() {\r\n\t\treturn {\r\n\t\t\ttype: \"equip\",\r\n\t\t\t\"source_path\": this.getIdPath(),\r\n\t\t\t\"target_path\": \"[\" + marauroa.me[\"id\"] + \"\\tbag]\",\r\n\t\t\t\"clicked\": \"\", // useful for changing default target in equip action\r\n\t\t\t\"zone\": marauroa.currentZoneName\r\n\t\t};\r\n\t},\r\n\r\n\tset: function(key, value) {\r\n\t\tmarauroa.rpobjectFactory[\"item\"].proto.set.apply(this, arguments);\r\n\t\tif (key === \"class\" || key === \"subclass\") {\r\n\t\t\tthis.sprite.filename = \"/data/sprites/items/\"\r\n\t\t\t\t+ this[\"class\"] + \"/\" + this[\"subclass\"] + \".png\";\r\n\t\t}\r\n\t},\r\n\r\n\tdraw: function(ctx) {\r\n\t\tthis.drawAt(ctx, this[\"x\"] * 32, this[\"y\"] * 32);\r\n\t},\r\n\r\n\tdrawAt: function(ctx, x, y) {\r\n\t\tif (this.sprite) {\r\n\t\t\tthis.drawSpriteAt(ctx, x, y);\r\n\t\t\tvar text = this.formatQuantity();\r\n\t\t\tvar textMetrics = ctx.measureText(text);\r\n\t\t\tthis.drawOutlineText(ctx, text, \"white\", x + (32 - textMetrics.width) / 2, y + 6);\r\n\t\t}\r\n\t},\r\n\r\n\tformatQuantity: function() {\r\n\t\tif (!this[\"quantity\"] || this[\"quantity\"] === \"1\") {\r\n\t\t\treturn \"\";\r\n\t\t}\r\n\t\tif (this[\"quantity\"] > 10000000) {\r\n\t\t\treturn Math.floor(this[\"quantity\"] / 1000000) + \"m\";\r\n\t\t}\r\n\t\tif (this[\"quantity\"] > 10000) {\r\n\t\t\treturn Math.floor(this[\"quantity\"] / 1000) + \"k\";\r\n\t\t}\r\n\t\treturn this[\"quantity\"];\r\n\t},\r\n\r\n\tgetCursor: function(x, y) {\r\n\t\treturn \"url(/data/sprites/cursor/itempickupfromslot.png) 1 3, auto\";\r\n\t}\r\n\r\n});\r\n","/***************************************************************************\r\n *                   (C) Copyright 2003-2017 - Stendhal                    *\r\n ***************************************************************************\r\n *                                                                         *\r\n *   This program is free software; you can redistribute it and/or modify  *\r\n *   it under the terms of the GNU Affero General Public License as        *\r\n *   published by the Free Software Foundation; either version 3 of the    *\r\n *   License, or (at your option) any later version.                       *\r\n *                                                                         *\r\n ***************************************************************************/\r\n\r\n\"use strict\";\r\n\r\nvar marauroa = window.marauroa = window.marauroa || {};\r\n\r\n/**\r\n * Portal\r\n */\r\nmarauroa.rpobjectFactory[\"portal\"] = marauroa.util.fromProto(marauroa.rpobjectFactory[\"entity\"], {\r\n\tminimapShow: true,\r\n\tminimapStyle: \"rgb(0,0,0)\",\r\n\tzIndex: 5000,\r\n\r\n\tbuildActions: function(list) {\r\n\t\tmarauroa.rpobjectFactory[\"portal\"].proto.buildActions.apply(this, arguments);\r\n\r\n\t\tif (this[\"_rpclass\"] == \"house_portal\") {\r\n\t\t\tlist.push({\r\n\t\t\t\ttitle: \"Use\",\r\n\t\t\t\ttype: \"use\"\r\n\t\t\t});\r\n\t\t\tlist.push({\r\n\t\t\t\ttitle: \"Kock\",\r\n\t\t\t\ttype: \"knock\"\r\n\t\t\t});\r\n\r\n\t\t} else {\r\n\r\n\t\t\t// remove default action \"look\" unless it is a house portal\r\n\t\t\tlist.splice(list.indexOf({title: \"Look\", type: \"look\"}), 1);\r\n\r\n\t\t\tlist.push({\r\n\t\t\t\ttitle: \"Use\",\r\n\t\t\t\ttype: \"use\"\r\n\t\t\t});\r\n\t\t}\r\n\t},\r\n\r\n\tisVisibleToAction: function(filter) {\r\n\t\treturn true;\r\n\t},\r\n\r\n\r\n\t/**\r\n\t * Create the default action for this entity. If the entity specifies a\r\n\t * default action description, interpret it as an action command.\r\n\t */\r\n\tgetDefaultAction: function() {\r\n\t\treturn {\r\n\t\t\t\"type\": \"moveto\",\r\n\t\t\t\"x\": \"\" + this[\"x\"],\r\n\t\t\t\"y\": \"\" + this[\"y\"],\r\n\t\t\t\"zone\": marauroa.currentZoneName\r\n\t\t};\r\n\t},\r\n\r\n\tgetCursor: function(x, y) {\r\n\t\treturn \"url(/data/sprites/cursor/portal.png) 1 3, auto\";\r\n\t}\r\n\r\n});\r\n\r\nmarauroa.rpobjectFactory[\"house_portal\"] = marauroa.rpobjectFactory[\"portal\"];\r\n","/***************************************************************************\r\n *                   (C) Copyright 2003-2017 - Stendhal                    *\r\n ***************************************************************************\r\n *                                                                         *\r\n *   This program is free software; you can redistribute it and/or modify  *\r\n *   it under the terms of the GNU Affero General Public License as        *\r\n *   published by the Free Software Foundation; either version 3 of the    *\r\n *   License, or (at your option) any later version.                       *\r\n *                                                                         *\r\n ***************************************************************************/\r\n\r\n\"use strict\";\r\n\r\nvar marauroa = window.marauroa = window.marauroa || {};\r\nvar stendhal = window.stendhal = window.stendhal || {};\r\n\r\n/**\r\n * ActiveEntity\r\n */\r\nmarauroa.rpobjectFactory[\"activeEntity\"] = marauroa.util.fromProto(marauroa.rpobjectFactory[\"entity\"], {\r\n\r\n\tupdatePosition: function(time) {\r\n\t\tvar serverX = parseFloat(this[\"x\"]);\r\n\t\tvar serverY = parseFloat(this[\"y\"]);\r\n\t\tif (this[\"_x\"] == undefined) {\r\n\t\t\tthis[\"_x\"] = serverX;\r\n\t\t}\r\n\t\tif (this[\"_y\"] == undefined) {\r\n\t\t\tthis[\"_y\"] = serverY;\r\n\t\t}\r\n\r\n\t\tif (this[\"speed\"] > 0) {\r\n\t\t\tvar oldX = this[\"_x\"];\r\n\t\t\tvar oldY = this[\"_y\"];\r\n\t\t\tvar movement = this[\"speed\"] * time / 300;\r\n\t\t\tswitch (this[\"dir\"]) {\r\n\t\t\tcase \"1\":\r\n\t\t\t\tthis[\"_y\"] = this[\"_y\"] - movement;\r\n\t\t\t\tthis[\"_x\"] = serverX;\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"2\":\r\n\t\t\t\tthis[\"_x\"] = this[\"_x\"] + movement;\r\n\t\t\t\tthis[\"_y\"] = serverY;\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"3\":\r\n\t\t\t\tthis[\"_y\"] = this[\"_y\"] + movement;\r\n\t\t\t\tthis[\"_x\"] = serverX;\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"4\":\r\n\t\t\t\tthis[\"_x\"] = this[\"_x\"] - movement;\r\n\t\t\t\tthis[\"_y\"] = serverY;\r\n\t\t\t}\r\n\r\n\t\t\t// fix desynchronized position (can happen if game tab is in background)\r\n\t\t\tif (Math.abs(this[\"_x\"] - serverX) > 1.75) {\r\n\t\t\t\tthis[\"_x\"] = serverX;\r\n\t\t\t}\r\n\t\t\tif (Math.abs(this[\"_y\"] - serverY) > 1.75) {\r\n\t\t\t\tthis[\"_y\"] = serverY;\r\n\t\t\t}\r\n\r\n\t\t\tif (this.collidesMap() || this.collidesEntities()) {\r\n\t\t\t\tthis[\"_x\"] = oldX;\r\n\t\t\t\tthis[\"_y\"] = oldY;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\t// Restore server coordinates when the entity is not moving\r\n\t\t\tthis[\"_x\"] = serverX;\r\n\t\t\tthis[\"_y\"] = serverY;\r\n\t\t}\r\n\t},\r\n\r\n\t/**\r\n\t * Check if the entity collides with the collision map.\r\n\t */\r\n\tcollidesMap: function() {\r\n\t\tvar startX = Math.floor(this[\"_x\"]);\r\n\t\tvar startY = Math.floor(this[\"_y\"]);\r\n\t\tvar endX = Math.ceil(this[\"_x\"] + this[\"width\"]);\r\n\t\tvar endY = Math.ceil(this[\"_y\"] + this[\"height\"]);\r\n\t\tfor (var y = startY; y < endY; y++) {\r\n\t\t\tfor (var x = startX; x < endX; x++) {\r\n\t\t\t\tif (stendhal.data.map.collision(x, y)) {\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn false;\r\n\t},\r\n\r\n\r\n\t/**\r\n\t * Check if the entity with another entity;\r\n\t */\r\n\tcollidesEntities: function() {\r\n\t\tvar thisStartX = Math.floor(this[\"_x\"]);\r\n\t\tvar thisStartY = Math.floor(this[\"_y\"]);\r\n\t\tvar thisEndX = Math.ceil(this[\"_x\"] + this[\"width\"]);\r\n\t\tvar thisEndY = Math.ceil(this[\"_y\"] + this[\"height\"]);\r\n\r\n\t\tvar i;\r\n\t\tfor (i in stendhal.zone.entities) {\r\n\t\t\tvar other = stendhal.zone.entities[i];\r\n\t\t\tif (!this.isObstacle(other)) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\tvar otherStartX = Math.floor(other[\"_x\"]);\r\n\t\t\tvar otherStartY = Math.floor(other[\"_y\"]);\r\n\t\t\tvar otherEndX = Math.ceil(other[\"_x\"] + other[\"width\"]);\r\n\t\t\tvar otherEndY = Math.ceil(other[\"_y\"] + other[\"height\"]);\r\n\r\n\t\t\tif (thisStartX < otherEndX && thisEndX > otherStartX\r\n\t\t\t\t&& thisStartY < otherEndY && thisEndY > otherStartY) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\t}\r\n\r\n});\r\n","/***************************************************************************\r\n *                   (C) Copyright 2003-2018 - Stendhal                    *\r\n ***************************************************************************\r\n *                                                                         *\r\n *   This program is free software; you can redistribute it and/or modify  *\r\n *   it under the terms of the GNU Affero General Public License as        *\r\n *   published by the Free Software Foundation; either version 3 of the    *\r\n *   License, or (at your option) any later version.                       *\r\n *                                                                         *\r\n ***************************************************************************/\r\n\r\n\"use strict\";\r\n\r\nvar marauroa = window.marauroa = window.marauroa || {};\r\nvar stendhal = window.stendhal = window.stendhal || {};\r\n\r\n(function() {\r\n\r\nmarauroa.rpobjectFactory[\"game_board\"] = marauroa.util.fromProto(marauroa.rpobjectFactory[\"entity\"], {\r\n\tzIndex: 100,\r\n\r\n\tinit: function() {\r\n\t\tthis.sprite = {\r\n\t\t\theight: 32 * 3,\r\n\t\t\twidth: 32 * 3\r\n\t\t};\r\n\t},\r\n\r\n\tset: function(key, value) {\r\n\t\tmarauroa.rpobjectFactory[\"entity\"].set.apply(this, arguments);\r\n\t\tif (key === \"class\") {\r\n\t\t\tthis.sprite.filename = \"data/sprites/gameboard/\"\r\n\t\t\t\t+ this[\"class\"] + \".png\";\r\n\t\t}\r\n\t},\r\n\r\n\tisVisibleToAction: function(filter) {\r\n\t\treturn false;\r\n\t},\r\n\r\n\tgetCursor: function(x, y) {\r\n\t\treturn \"url(/data/sprites/cursor/walk.png) 1 3, auto\";\r\n\t}\r\n\r\n});\r\n\r\n}());\r\n","/***************************************************************************\r\n *                   (C) Copyright 2003-2017 - Stendhal                    *\r\n ***************************************************************************\r\n *                                                                         *\r\n *   This program is free software; you can redistribute it and/or modify  *\r\n *   it under the terms of the GNU Affero General Public License as        *\r\n *   published by the Free Software Foundation; either version 3 of the    *\r\n *   License, or (at your option) any later version.                       *\r\n *                                                                         *\r\n ***************************************************************************/\r\n\r\n\"use strict\";\r\n\r\nvar marauroa = window.marauroa = window.marauroa || {};\r\nvar stendhal = window.stendhal = window.stendhal || {};\r\n\r\n// hair should not be drawn with hat indexes in this list\r\nstendhal.HATS_NO_HAIR = [3, 4, 13, 992, 993, 994];\r\n\r\n(function() {\r\n\r\n\tvar HEALTH_BAR_HEIGHT = 6;\r\n\r\n\r\n/**\r\n * RPEntity\r\n */\r\nmarauroa.rpobjectFactory[\"rpentity\"] = marauroa.util.fromProto(marauroa.rpobjectFactory[\"activeEntity\"], {\r\n\tzIndex: 8000,\r\n\tdrawY: 0,\r\n\tspritePath: \"\",\r\n\ttitleStyle: \"#FFFFFF\",\r\n\t_target: null,\r\n\tattackSprite: null,\r\n\tattackResult: null,\r\n\tdir: 3,\r\n\r\n\tset: function(key, value) {\r\n\t\t// Ugly hack to detect changes. The old value is no\r\n\t\t// longer available after .apply()\r\n\t\tvar oldValue = this[key];\r\n\r\n\t\tmarauroa.rpobjectFactory[\"rpentity\"].proto.set.apply(this, arguments);\r\n\t\tif (key == \"text\") {\r\n\t\t\tthis.say(value);\r\n\t\t} else if ([\"hp\", \"base_hp\"].indexOf(key) !== -1) {\r\n\t\t\tthis[key] = parseInt(value, 10);\r\n\t\t\tif (key === \"hp\" && oldValue != undefined) {\r\n\t\t\t\tthis.onHPChanged(this[key] - oldValue);\r\n\t\t\t}\r\n\t\t} else if (key === \"target\") {\r\n\t\t\tif (this._target) {\r\n\t\t\t\tthis._target.onAttackStopped(this);\r\n\t\t\t}\r\n\t\t\tthis._target = marauroa.currentZone[value];\r\n\t\t\tif (this._target) {\r\n\t\t\t\tthis._target.onTargeted(this);\r\n\t\t\t}\r\n\t\t} else if (key === \"away\") {\r\n\t\t\tthis.addFloater(\"Away\", \"#ffff00\");\r\n\t\t} else if (key === \"grumpy\") {\r\n\t\t\tthis.addFloater(\"Grumpy\", \"#ffff00\");\r\n\t\t} else if (key === \"xp\" && oldValue != undefined) {\r\n\t\t\tthis.onXPChanged(this[key] - oldValue);\r\n\t\t}\r\n\t},\r\n\r\n\tunset: function(key) {\r\n\t\tif (key === \"target\" && this._target) {\r\n\t\t\tthis._target.onAttackStopped(this);\r\n\t\t\tthis._target = null;\r\n\t\t} else if (key === \"away\") {\r\n\t\t\tthis.addFloater(\"Back\", \"#ffff00\");\r\n\t\t} else if (key === \"grumpy\") {\r\n\t\t\tthis.addFloater(\"Receptive\", \"#ffff00\");\r\n\t\t}\r\n\t\tdelete this[key];\r\n\t},\r\n\r\n\tisVisibleToAction: function(filter) {\r\n\t\treturn typeof(this[\"ghostmode\"]) == \"undefined\" || marauroa.me && marauroa.me.isAdmin();\r\n\t},\r\n\r\n\tbuildActions: function(list) {\r\n\t\tmarauroa.rpobjectFactory[\"rpentity\"].proto.buildActions.apply(this, arguments);\r\n\t\t/*\r\n\t\t * Menu is used to provide an alternate action for some entities (like\r\n\t\t * puppies - and they should not be attackable).\r\n\t\t *\r\n\t\t * For now normally attackable entities get a menu only in Capture The\r\n\t\t * Flag, and then they don't need attack. If that changes, this code\r\n\t\t * will need to be adjusted.\r\n\t\t */\r\n\t\tif (!this[\"menu\"]) {\r\n\t\t\tif (marauroa.me._target === this) {\r\n\t\t\t\tlist.push({\r\n\t\t\t\t\ttitle: \"Stop attack\",\r\n\t\t\t\t\taction: function(entity) {\r\n\t\t\t\t\t\tvar action = {\r\n\t\t\t\t\t\t\t\"type\": \"stop\",\r\n\t\t\t\t\t\t\t\"zone\": marauroa.currentZoneName,\r\n\t\t\t\t\t\t\t\"attack\": \"\"\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tmarauroa.clientFramework.sendAction(action);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t} else if (this !== marauroa.me) {\r\n\t\t\t\tlist.push({\r\n\t\t\t\t\ttitle: \"Attack\",\r\n\t\t\t\t\ttype: \"attack\"\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (this != marauroa.me) {\r\n\t\t\tlist.push({\r\n\t\t\t\ttitle: \"Push\",\r\n\t\t\t\ttype: \"push\"\r\n\t\t\t});\r\n\t\t}\r\n\t},\r\n\r\n\t/**\r\n\t * retrieves the entity's visible title\r\n\t */\r\n\tgetTitle: function() {\r\n\t\treturn this[\"title\"];\r\n\t},\r\n\r\n\t/**\r\n\t * says a text\r\n\t */\r\n\tsay: function (text) {\r\n\t\tif (!marauroa.me) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (marauroa.me.isInHearingRange(this)) {\r\n\t\t\tif (text.match(\"^!me\") == \"!me\") {\r\n\t\t\t\tstendhal.ui.chatLog.addLine(\"emote\", text.replace(/^!me/, this.getTitle()));\r\n\t\t\t} else {\r\n\t\t\t\tthis.addSpeechBubble(text);\r\n\t\t\t\tstendhal.ui.chatLog.addLine(\"normal\", this.getTitle() + \": \" + text);\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\taddSpeechBubble: function(text) {\r\n\t\tvar x = this[\"_x\"] * 32 + 32;\r\n\t\tvar y = this[\"_y\"] * 32 - 16;\r\n\t\tstendhal.ui.gamewindow.addTextSprite({\r\n\t\t\trealText: (text.length > 30) ? (text.substring(0, 30) + \"...\") : text,\r\n\t\t\ttimeStamp: Date.now(),\r\n\t\t\tdraw: function(ctx) {\r\n\t\t\t\tctx.lineWidth = 2;\r\n\t\t\t\tctx.font = \"14px Arial\";\r\n\t\t\t\tctx.fillStyle = '#ffffff';\r\n\t\t\t\t// get width of text\r\n\t\t\t\tvar width = ctx.measureText(this.realText).width + 8;\r\n\t\t\t\tctx.strokeStyle = \"#000000\";\r\n\t\t\t\tctx.strokeRect(x, y - 15, width, 20);\r\n\t\t\t\tctx.fillRect(x, y - 15, width, 20);\r\n\r\n\t\t\t\tctx.beginPath();\r\n\t\t\t\tctx.moveTo(x, y);\r\n\t\t\t\tctx.lineTo(x - 5, y + 8);\r\n\t\t\t\tctx.lineTo(x + 1, y + 5);\r\n\t\t\t\tctx.stroke();\r\n\t\t\t\tctx.closePath();\r\n\t\t\t\tctx.fill();\r\n\r\n\t\t\t\tctx.fillStyle = \"#000000\";\r\n\t\t\t\tctx.fillText(this.realText, x + 4, y);\r\n\t\t\t\treturn Date.now() > this.timeStamp + 2000 + 20 * this.realText.length;\r\n\t\t\t}\r\n\t\t});\r\n\t},\r\n\r\n\tdrawMultipartOutfit: function(ctx) {\r\n\t\t// layers in draw order\r\n\t\tvar layers = [];\r\n\r\n\t\tvar outfit = {};\r\n\t\tif (\"outfit_ext\" in this) {\r\n\t\t\tlayers = [\"body\", \"dress\", \"head\", \"mouth\", \"eyes\", \"mask\", \"hair\", \"hat\", \"detail\"];\r\n\r\n\t\t\tfor (const part of this[\"outfit_ext\"].split(\",\")) {\r\n\t\t\t\tif (part.includes(\"=\")) {\r\n\t\t\t\t\tvar tmp = part.split(\"=\");\r\n\t\t\t\t\toutfit[tmp[0]] = tmp[1];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tlayers = [\"body\", \"dress\", \"head\", \"hair\", \"detail\"];\r\n\r\n\t\t\toutfit[\"body\"] = this[\"outfit\"] % 100;\r\n\t\t\toutfit[\"dress\"] = Math.floor(this[\"outfit\"]/100) % 100;\r\n\t\t\toutfit[\"head\"] = Math.floor(this[\"outfit\"]/10000) % 100;\r\n\t\t\toutfit[\"hair\"] = Math.floor(this[\"outfit\"]/1000000) % 100;\r\n\t\t\toutfit[\"detail\"] = Math.floor(this[\"outfit\"]/100000000) % 100;\r\n\t\t}\r\n\r\n\t\tfor (const layer of layers) {\r\n\t\t\t// hair is not drawn under certain hats/helmets\r\n\t\t\tif (layer == \"hair\" && stendhal.HATS_NO_HAIR.includes(parseInt(outfit[\"hat\"]))) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\r\n\t\t\tif (layer in outfit) {\r\n\t\t\t\tconst img = this.getOutfitPart(layer, outfit[layer]);\r\n\t\t\t\tif (img) {\r\n\t\t\t\t\tthis.drawSprite(ctx, img);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\t/**\r\n\t * Get an outfit part (Image or a Promise)\r\n\t *\r\n\t * @param {string}  part\r\n\t * @param {Number} index\r\n\t */\r\n\tgetOutfitPart: function(part, index) {\r\n\t\tlet n = index;\r\n\t\tif (index < 10) {\r\n\t\t\tn = \"00\" + index;\r\n\t\t} else if(index < 100) {\r\n\t\t\tn = \"0\" + index;\r\n\t\t}\r\n\t\tconst filename = \"/data/sprites/outfit/\" + part + \"/\" + part + \"_\" + n + \".png\";\r\n\t\tconst colors = this[\"outfit_colors\"];\r\n\t\tlet colorname;\r\n\t\tif (part === \"body\" || part === \"head\") {\r\n\t\t\tcolorname = \"skin\";\r\n\t\t} else {\r\n\t\t\tcolorname = part;\r\n\t\t}\r\n\t\tif (typeof(colors) !== \"undefined\" && (typeof(colors[colorname]) !== \"undefined\")) {\r\n\t\t\treturn stendhal.data.sprites.getFiltered(filename, \"trueColor\", colors[colorname]);\r\n\t\t} else {\r\n\t\t\treturn stendhal.data.sprites.get(filename);\r\n\t\t}\r\n\t},\r\n\r\n\t/**\r\n\t * draw RPEntities\r\n\t */\r\n\tdraw: function(ctx) {\r\n\t\tif (typeof(this[\"ghostmode\"]) != \"undefined\" && marauroa.me && !marauroa.me.isAdmin()) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tthis.drawCombat(ctx);\r\n\t\tvar filename;\r\n\t\tif (typeof(this[\"outfit\"]) != \"undefined\" || typeof(this[\"outfit_ext\"]) != \"undefined\") {\r\n\t\t\tthis.drawMultipartOutfit(ctx);\r\n\t\t} else {\r\n\t\t\tfilename = \"/data/sprites/\" + this.spritePath + \"/\" + this[\"class\"];\r\n\t\t\tif (typeof(this[\"subclass\"]) != \"undefined\") {\r\n\t\t\t\tfilename = filename + \"/\" + this[\"subclass\"];\r\n\t\t\t}\r\n\t\t\tfilename = filename + \".png\";\r\n\t\t\tvar image = stendhal.data.sprites.get(filename);\r\n\t\t\tthis.drawSprite(ctx, image);\r\n\t\t}\r\n\t\tthis.drawAttack(ctx);\r\n\t\tthis.drawFloaters(ctx);\r\n\t\tthis.drawStatusIcons(ctx);\r\n\t},\r\n\r\n\tdrawStatusIcons: function(ctx) {\r\n\t\tfunction _drawAnimatedIcon(icon, delay, nFrames, xdim, ydim, x, y) {\r\n\t\t\tvar frame = Math.floor(Date.now() / delay) % nFrames;\r\n\t\t\tctx.drawImage(icon, frame * xdim, 0, xdim, ydim, x, y, xdim, ydim);\r\n\t\t}\r\n\t\tfunction drawAnimatedIcon(iconPath, delay, x, y) {\r\n\t\t\tvar icon = stendhal.data.sprites.get(iconPath);\r\n\t\t\tvar dim = icon.height;\r\n\t\t\tvar nFrames = icon.width / dim;\r\n\t\t\t_drawAnimatedIcon(icon, delay, nFrames, dim, dim, x, y);\r\n\t\t}\r\n\t\tfunction drawAnimatedIconWithFrames(iconPath, nFrames, delay, x, y) {\r\n\t\t\tvar icon = stendhal.data.sprites.get(iconPath);\r\n\t\t\tvar ydim = icon.height;\r\n\t\t\tvar xdim = icon.width / nFrames;\r\n\t\t\t_drawAnimatedIcon(icon, delay, nFrames, xdim, ydim, x, y);\r\n\t\t}\r\n\r\n\t\tvar x = this[\"_x\"] * 32 - 10;\r\n\t\tvar y = (this[\"_y\"] + 1) * 32;\r\n\t\tif (this.hasOwnProperty(\"choking\")) {\r\n\t\t\tctx.drawImage(stendhal.data.sprites.get(\"/data/sprites/ideas/choking.png\"), x, y - 10);\r\n\t\t} else if (this.hasOwnProperty(\"eating\")) {\r\n\t\t\tctx.drawImage(stendhal.data.sprites.get(\"/data/sprites/ideas/eat.png\"), x, y - 10);\r\n\t\t}\r\n\t\t// NPC and pet idea icons\r\n\t\tif (this.hasOwnProperty(\"idea\")) {\r\n\t\t\tctx.drawImage(stendhal.data.sprites.get(\"/data/sprites/ideas/\" + this[\"idea\"] + \".png\"),\r\n\t\t\t\t\tx + 32 * this[\"width\"], y - this[\"drawHeight\"]);\r\n\t\t}\r\n\t\tif (this.hasOwnProperty(\"away\")) {\r\n\t\t\tdrawAnimatedIcon(\"/data/sprites/ideas/away.png\", 1500, x + 32 * this[\"width\"], y - this[\"drawHeight\"]);\r\n\t\t}\r\n\t\tif (this.hasOwnProperty(\"grumpy\")) {\r\n\t\t\tdrawAnimatedIcon(\"/data/sprites/ideas/grumpy.png\", 1000, x + 5, y - this[\"drawHeight\"]);\r\n\t\t}\r\n\t\tif (this.hasOwnProperty(\"last_player_kill_time\")) {\r\n\t\t\tdrawAnimatedIconWithFrames(\"/data/sprites/ideas/pk.png\", 12, 300, x, y - this[\"drawHeight\"]);\r\n\t\t}\r\n\t\tif (this.hasOwnProperty(\"poisoned\")) {\r\n\t\t\tdrawAnimatedIcon(\"/data/sprites/status/poison.png\", 100, x + 32 * this[\"width\"] - 10, y - this[\"drawHeight\"]);\r\n\t\t}\r\n\t\t// NPC job icons\r\n\t\tif (this.hasOwnProperty(\"job_healer\")) {\r\n\t\t\tctx.drawImage(stendhal.data.sprites.get(\"/data/sprites/status/healer.png\"), x, y - 10);\r\n\t\t}\r\n\t\tif (this.hasOwnProperty(\"job_merchant\")) {\r\n\t\t\tctx.drawImage(stendhal.data.sprites.get(\"/data/sprites/status/merchant.png\"), x + 12, y - 10);\r\n\t\t}\r\n\t},\r\n\r\n\t/**\r\n\t * Draw colored ellipses (or rectangles on browsers that do not support\r\n\t * ellipses) when the entity is being attacked, or is attacking the user.\r\n\t */\r\n\tdrawCombat: function(ctx) {\r\n\t\tif (this.attackers && this.attackers.size > 0) {\r\n\t\t\tctx.lineWidth = 1;\r\n\t\t\t/*\r\n\t\t\t * As of 2015-9-15 CanvasRenderingContext2D.ellipse() is not\r\n\t\t\t * supported in most browsers. Fall back to rectangles on these.\r\n\t\t\t * Also on Chrome 45.0.2454.85 ellipse() does not seem to support\r\n\t\t\t * the begin angle parameter correctly, nor does the stroke\r\n\t\t\t * direction work as it should so it can't be used as a workaround.\r\n\t\t\t * Currently the second ellipse part is drawn as a full ellipse, but\r\n\t\t\t * the code below should eventually draw the right thing once\r\n\t\t\t * browsers catch up. Probably.\r\n\t\t\t */\r\n\t\t\tif (ctx.ellipse instanceof Function) {\r\n\t\t\t\tvar xRad = this[\"width\"] * 16;\r\n\t\t\t\tvar yRad = this[\"height\"] * 16 / Math.SQRT2;\r\n\t\t\t\tvar centerX = this[\"_x\"] * 32 + xRad;\r\n\t\t\t\tvar centerY = (this[\"_y\"] + this[\"height\"]) * 32 - yRad;\r\n\t\t\t\tctx.strokeStyle = \"#4a0000\";\r\n\t\t\t\tctx.beginPath();\r\n\t\t\t\tctx.ellipse(centerX, centerY, xRad, yRad, 0, Math.PI, false);\r\n\t\t\t\tctx.stroke();\r\n\t\t\t\tctx.strokeStyle = \"#e60a0a\";\r\n\t\t\t\tctx.beginPath();\r\n\t\t\t\tctx.ellipse(centerX, centerY, xRad, yRad, Math.PI, 2 * Math.PI, false);\r\n\t\t\t\tctx.stroke();\r\n\t\t\t} else {\r\n\t\t\t\tctx.strokeStyle = \"#e60a0a\";\r\n\t\t\t\tctx.strokeRect(32 * this[\"_x\"], 32 * this[\"_y\"], 32 * this[\"width\"], 32 * this[\"height\"]);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (this.getAttackTarget() === marauroa.me) {\r\n\t\t\tctx.lineWidth = 1;\r\n\t\t\t// See above about ellipses.\r\n\t\t\tif (ctx.ellipse instanceof Function) {\r\n\t\t\t\tvar xRad = this[\"width\"] * 16 - 1;\r\n\t\t\t\tvar yRad = this[\"height\"] * 16 / Math.SQRT2 - 1;\r\n\t\t\t\tvar centerX = this[\"_x\"] * 32 + xRad + 1;\r\n\t\t\t\tvar centerY = (this[\"_y\"] + this[\"height\"]) * 32 - yRad - 1;\r\n\t\t\t\tctx.strokeStyle = \"#ffc800\";\r\n\t\t\t\tctx.beginPath();\r\n\t\t\t\tctx.ellipse(centerX, centerY, xRad, yRad, 0, Math.PI, false);\r\n\t\t\t\tctx.stroke();\r\n\t\t\t\tctx.strokeStyle = \"#ffdd0a\";\r\n\t\t\t\tctx.beginPath();\r\n\t\t\t\tctx.ellipse(centerX, centerY, xRad, yRad, Math.PI, 2 * Math.PI, false);\r\n\t\t\t\tctx.stroke();\r\n\t\t\t} else {\r\n\t\t\t\tctx.strokeStyle = \"#ffdd0a\";\r\n\t\t\t\tctx.strokeRect(32 * this[\"_x\"] + 1, 32 * this[\"_y\"] + 1, 32 * this[\"width\"] - 2, 32 * this[\"height\"] - 2);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (this.attackResult) {\r\n\t\t\tif (this.attackResult.draw(ctx, (this[\"_x\"] + this[\"width\"]) * 32 - 10, (this[\"_y\"] + this[\"height\"]) * 32 - 10)) {\r\n\t\t\t\tthis.attackResult = null;\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\t/**\r\n\t * Draw entities in this.floaters array. Each floater should have\r\n\t * draw(ctx, x, y) method, where ctx is the canvas context, and x, y are\r\n\t * the coordinates where to start floating. The method should return true\r\n\t * when the floater should be removed.\r\n\t */\r\n\tdrawFloaters: function(ctx) {\r\n\t\tif (this.hasOwnProperty(\"floaters\")) {\r\n\t\t\tvar centerX = (this[\"_x\"] + this[\"width\"] / 2) * 32;\r\n\t\t\tvar topY = (this[\"_y\"] + 1) * 32 - this[\"drawHeight\"];\r\n\t\t\t// Grab an unchanging copy\r\n\t\t\tvar currentFloaters = this.floaters;\r\n\t\t\tfor (var i = 0; i < currentFloaters.length; i++) {\r\n\t\t\t\tvar floater = currentFloaters[i];\r\n\t\t\t\tif (floater.draw(ctx, centerX, topY)) {\r\n\t\t\t\t\t// copy the array and remove the specific element from the copy\r\n\t\t\t\t\tthis.floaters = this.floaters.slice();\r\n\t\t\t\t\tthis.floaters.splice(this.floaters.indexOf(floater), 1);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\t/**\r\n\t * @param {CanvasRenderingContext2D} ctx\r\n\t * @param {Image} image\r\n\t */\r\n\tdrawSprite: function(ctx, image) {\r\n\t\tvar localX = this[\"_x\"] * 32;\r\n\t\tvar localY = this[\"_y\"] * 32;\r\n\t\tif (image.height) { // image.complete is true on missing image files\r\n\t\t\tvar nFrames = 3;\r\n\t\t\tvar nDirections = 4;\r\n\t\t\tvar yRow = this[\"dir\"] - 1;\r\n\t\t\tvar frame = 1; // draw center column when idle\r\n\t\t\t// Ents are a hack in Java client too\r\n\t\t\tif (this[\"class\"] == \"ent\") {\r\n\t\t\t\tnFrames = 1;\r\n\t\t\t\tnDirections = 2;\r\n\t\t\t\tyRow = Math.floor((this[\"dir\"] - 1) / 2);\r\n\t\t\t\tframe = 0;\r\n\t\t\t}\r\n\t\t\tthis[\"drawHeight\"] = image.height / nDirections;\r\n\t\t\tthis[\"drawWidth\"] = image.width / nFrames;\r\n\t\t\tvar drawX = ((this[\"width\"] * 32) - this[\"drawWidth\"]) / 2;\r\n\t\t\tif (this[\"speed\"] > 0 && nFrames != 1) {\r\n\t\t\t\tvar animLength = nFrames * 2 - 2;\r\n\t\t\t\t// % Works normally with *floats* (just whose bright idea was\r\n\t\t\t\t// that?), so use floor() as a workaround\r\n\t\t\t\tframe = Math.floor(Date.now() / 100) % animLength;\r\n\t\t\t\tif (frame >= nFrames) {\r\n\t\t\t\t\tframe = animLength - frame;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tvar drawY = (this[\"height\"] * 32) - this[\"drawHeight\"];\r\n\t\t\tctx.drawImage(image, frame * this[\"drawWidth\"], yRow * this[\"drawHeight\"], this[\"drawWidth\"], this[\"drawHeight\"], localX + drawX, localY + drawY, this[\"drawWidth\"], this[\"drawHeight\"]);\r\n\t\t}\r\n\t},\r\n\r\n\tdrawTop: function(ctx) {\r\n\t\tvar localX = this[\"_x\"] * 32;\r\n\t\tvar localY = this[\"_y\"] * 32;\r\n\r\n\t\tthis.drawHealthBar(ctx, localX, localY);\r\n\t\tthis.drawTitle(ctx, localX, localY);\r\n\t},\r\n\r\n\tdrawHealthBar: function(ctx, x, y) {\r\n\t\tvar drawX = x + ((this[\"width\"] * 32) - this[\"drawWidth\"]) / 2;\r\n\t\tvar drawY = y + (this[\"height\"] * 32) - this[\"drawHeight\"] - HEALTH_BAR_HEIGHT;\r\n\r\n\t\tctx.strokeStyle = \"#000000\";\r\n\t\tctx.lineWidth = 2;\r\n\t\tctx.beginPath();\r\n\t\tctx.rect(drawX, drawY, this[\"drawWidth\"], HEALTH_BAR_HEIGHT - 2);\r\n\t\tctx.stroke();\r\n\r\n\t\tctx.fillStyle = \"#E0E0E0\";\r\n\t\tctx.fillRect(drawX, drawY, this[\"drawWidth\"], HEALTH_BAR_HEIGHT - 2);\r\n\r\n\t\t// Bar color\r\n\t\tvar hpRatio = this[\"hp\"] / this[\"base_hp\"];\r\n\t\tvar red = Math.floor(Math.min((1 - hpRatio) * 2, 1) * 255);\r\n\t\tvar green = Math.floor(Math.min(hpRatio * 2, 1) * 255);\r\n\t\tctx.fillStyle = \"rgb(\".concat(red, \",\", green, \",0)\");\r\n\t\tctx.fillRect(drawX, drawY, this[\"drawWidth\"] * hpRatio, HEALTH_BAR_HEIGHT - 2);\r\n\t},\r\n\r\n\tdrawTitle: function(ctx, x, y) {\r\n\t\tvar title = this.getTitle();\r\n\t\tif (title == undefined) {\r\n\t\t\ttitle = this[\"_name\"];\r\n\t\t\tif (title == undefined || title == \"\") {\r\n\t\t\t\ttitle = this[\"class\"];\r\n\t\t\t\tif (title == undefined) {\r\n\t\t\t\t\ttitle = this[\"type\"];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (typeof(title) != \"undefined\") {\r\n\t\t\tctx.font = \"14px Arial\";\r\n\t\t\tvar textMetrics = ctx.measureText(title);\r\n\t\t\tvar drawY = y + (this[\"height\"] * 32) - this[\"drawHeight\"] - HEALTH_BAR_HEIGHT;\r\n\t\t\tthis.drawOutlineText(ctx, title, this.titleStyle, x + (this[\"width\"] * 32 - textMetrics.width) / 2, drawY - 5 - HEALTH_BAR_HEIGHT);\r\n\t\t}\r\n\t},\r\n\r\n\tdrawAttack: function(ctx) {\r\n\t\tif (this.attackSprite == null) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (this.attackSprite.expired()) {\r\n\t\t\tthis.attackSprite = null;\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar localX = this[\"_x\"] * 32;\r\n\t\tvar localY = this[\"_y\"] * 32;\r\n\t\tthis.attackSprite.draw(ctx, localX, localY, this[\"drawWidth\"], this[\"drawHeight\"]);\r\n\t},\r\n\r\n\t// attack handling\r\n\tgetAttackTarget: function() {\r\n\t\t// If the attack target id was read before the target was available,\r\n\t\t// _target does not point to the correct entity. Look up the target\r\n\t\t// again, if _target does not exist, but it should.\r\n\t\tif (!this._target && this[\"target\"]) {\r\n\t\t\tthis._target = marauroa.currentZone[this[\"target\"]];\r\n\t\t\tif (this._target) {\r\n\t\t\t\tthis._target.onTargeted(this);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn this._target;\r\n\t},\r\n\r\n\tonDamaged: function(source, damage) {\r\n\t\tthis.attackResult = this.createResultIcon(\"/data/sprites/combat/hitted.png\");\r\n\t\tvar sounds = [\"attack-melee-01\", \"attack-melee-02\", \"attack-melee-03\", \"attack-melee-04\", \"attack-melee-05\", \"attack-melee-06\", \"attack-melee-07\"];\r\n\t\tvar index = Math.floor(Math.random() * Math.floor(sounds.length));\r\n\t\tstendhal.ui.sound.playLocalizedEffect(this[\"_x\"], this[\"_y\"], 20, 3, sounds[index], 1);\r\n\t},\r\n\r\n\tonBlocked: function(source) {\r\n\t\tthis.attackResult = this.createResultIcon(\"/data/sprites/combat/blocked.png\");\r\n\t\tvar sounds = [\"clang-metallic-1\", \"clang-dull-1\"];\r\n\t\tvar index = Math.floor(Math.random() * Math.floor(sounds.length));\r\n\t\tstendhal.ui.sound.playLocalizedEffect(this[\"_x\"], this[\"_y\"], 20, 3, sounds[index], 1);\r\n\t},\r\n\r\n\tonMissed: function(source) {\r\n\t\tthis.attackResult = this.createResultIcon(\"/data/sprites/combat/missed.png\");\r\n\t},\r\n\r\n\tonHPChanged: function(change) {\r\n\t\tif (change > 0) {\r\n\t\t\tthis.addFloater(\"+\" + change, \"#00ff00\");\r\n\t\t} else if (change < 0) {\r\n\t\t\tthis.addFloater(change.toString(), \"#ff0000\");\r\n\t\t}\r\n\t},\r\n\r\n\tonXPChanged: function(change) {\r\n\t\tif (change > 0) {\r\n\t\t\tthis.addFloater(\"+\" + change, \"#4169e1\");\r\n\t\t\tstendhal.ui.chatLog.addLine(\"significant_positive\", this.getTitle() + \" earns \" + change + \" experience points.\");\r\n\t\t} else if (change < 0) {\r\n\t\t\tthis.addFloater(change.toString(), \"#ff8f8f\");\r\n\t\t\tstendhal.ui.chatLog.addLine(\"significant_negative\", this.getTitle() + \" loses \" + Math.abs(change) + \" experience points.\");\r\n\t\t}\r\n\t},\r\n\r\n\taddFloater: function(message, color) {\r\n\t\tif (!this.hasOwnProperty(\"floaters\")) {\r\n\t\t\tthis.floaters = [];\r\n\t\t}\r\n\t\tvar self = this;\r\n\t\tthis.floaters.push({\r\n\t\t\tinitTime: Date.now(),\r\n\t\t\ttextOffset: null,\r\n\t\t\tdraw: function(ctx, x, y) {\r\n\t\t\t\tctx.font = \"14px Arial\";\r\n\t\t\t\tif (!this.textOffset) {\r\n\t\t\t\t\tthis.textOffset = ctx.measureText(message).width / 2;\r\n\t\t\t\t}\r\n\t\t\t\tvar timeDiff = Date.now() - this.initTime;\r\n\t\t\t\tself.drawOutlineText(ctx, message, color, x - this.textOffset, y - timeDiff / 50);\r\n\t\t\t\treturn (timeDiff > 2000);\r\n\t\t\t}\r\n\t\t});\r\n\t},\r\n\r\n\t/**\r\n\t * Create a closure for drawing attack result icons. The resulting object\r\n\t * has a method draw(context, x, y) which returns true when the attack\r\n\t * result has expired and draw() should no longer be called.\r\n\t *\r\n\t * @param imagePath path to the result icon\r\n\t * @return object for drawing the icon\r\n\t */\r\n\tcreateResultIcon: function(imagePath) {\r\n\t\treturn {\r\n\t\t\tinitTime: Date.now(),\r\n\t\t\timage: stendhal.data.sprites.get(imagePath),\r\n\t\t\tdraw: function(ctx, x, y) {\r\n\t\t\t\tctx.drawImage(this.image, x, y);\r\n\t\t\t\treturn (Date.now() - this.initTime > 1200);\r\n\t\t\t}\r\n\t\t};\r\n\t},\r\n\r\n\tonAttackPerformed: function(nature, ranged) {\r\n\t\tif (ranged) {\r\n\t\t\tvar color;\r\n\t\t\tswitch (nature) {\r\n\t\t\tcase \"0\":\r\n\t\t\tdefault:\r\n\t\t\t\tcolor = \"#c0c0c0\";\r\n\t\t\tbreak;\r\n\t\t\tcase \"1\":\r\n\t\t\t\tcolor = \"#ff6400\";\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"2\":\r\n\t\t\t\tcolor = \"#8c8cff\";\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"3\":\r\n\t\t\t\tcolor = \"#fff08c\";\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"4\":\r\n\t\t\t\tcolor = \"#404040\";\r\n\t\t\t}\r\n\t\t\tvar tgt = this.getAttackTarget();\r\n\t\t\tthis.attackSprite = (function(color, targetX, targetY) {\r\n\t\t\t\treturn {\r\n\t\t\t\t\tinitTime: Date.now(),\r\n\t\t\t\t\texpired: function() {\r\n\t\t\t\t\t\treturn Date.now() - this.initTime > 180;\r\n\t\t\t\t\t},\r\n\t\t\t\t\tdraw: function(ctx, x, y, entityWidth, entityHeight) {\r\n\t\t\t\t\t\tvar dtime = Date.now() - this.initTime;\r\n\t\t\t\t\t\t// We can use fractional \"frame\" for the lines. Just\r\n\t\t\t\t\t\t// draw the arrow where it should be at the moment.\r\n\t\t\t\t\t\tvar frame = Math.min(dtime / 60, 4);\r\n\r\n\t\t\t\t\t\tvar startX = x + entityWidth / 4;\r\n\t\t\t\t\t\tvar startY = y + entityHeight / 4;\r\n\r\n\t\t\t\t\t\tvar yLength = (targetY - startY) / 4;\r\n\t\t\t\t\t\tvar xLength = (targetX - startX) / 4;\r\n\r\n\t\t\t\t\t\tstartY += frame * yLength;\r\n\t\t\t\t\t\tvar endY = startY + yLength;\r\n\t\t\t\t\t\tstartX += frame * xLength;\r\n\t\t\t\t\t\tvar endX = startX + xLength;\r\n\r\n\t\t\t\t\t\tctx.strokeStyle = color;\r\n\t\t\t\t\t\tctx.lineWidth = 2;\r\n\t\t\t\t\t\tctx.moveTo(startX, startY);\r\n\t\t\t\t\t\tctx.lineTo(endX, endY);\r\n\t\t\t\t\t\tctx.stroke();\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t})(color, (tgt.x + tgt.width / 2) * 32, (tgt.y + tgt.height / 2) * 32);\r\n\t\t} else {\r\n\t\t\tvar imagePath;\r\n\t\t\tswitch (nature) {\r\n\t\t\tcase \"0\":\r\n\t\t\tdefault:\r\n\t\t\t\timagePath = \"/data/sprites/combat/blade_strike_cut.png\";\r\n\t\t\tbreak;\r\n\t\t\tcase \"1\":\r\n\t\t\t\timagePath = \"/data/sprites/combat/blade_strike_fire.png\";\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"2\":\r\n\t\t\t\timagePath = \"/data/sprites/combat/blade_strike_ice.png\";\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"3\":\r\n\t\t\t\timagePath = \"/data/sprites/combat/blade_strike_light.png\";\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"4\":\r\n\t\t\t\timagePath = \"/data/sprites/combat/blade_strike_dark.png\";\r\n\t\t\t}\r\n\t\t\tthis.attackSprite = (function(imagePath, ranged, dir) {\r\n\t\t\t\treturn {\r\n\t\t\t\t\tinitTime: Date.now(),\r\n\t\t\t\t\timage: stendhal.data.sprites.get(imagePath),\r\n\t\t\t\t\tframe: 0,\r\n\t\t\t\t\texpired: function() {\r\n\t\t\t\t\t\treturn Date.now() - this.initTime > 180;\r\n\t\t\t\t\t},\r\n\t\t\t\t\tdraw: function(ctx, x, y, entityWidth, entityHeight) {\r\n\t\t\t\t\t\tif (!this.image.height) {\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar yRow = dir - 1;\r\n\t\t\t\t\t\tvar drawHeight = this.image.height / 4;\r\n\t\t\t\t\t\tvar drawWidth = this.image.width / 3;\r\n\t\t\t\t\t\tvar dtime = Date.now() - this.initTime;\r\n\t\t\t\t\t\tvar frame = Math.floor(Math.min(dtime / 60, 3));\r\n\t\t\t\t\t\tvar centerX = x + (entityWidth - drawWidth) / 2;\r\n\t\t\t\t\t\tvar centerY = y + (entityHeight - drawHeight) / 2;\r\n\t\t\t\t\t\tctx.drawImage(this.image, frame * drawWidth, yRow * drawHeight,\r\n\t\t\t\t\t\t\t\tdrawWidth, drawHeight, centerX, centerY, drawWidth, drawHeight);\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t})(imagePath, ranged, this[\"dir\"]);\r\n\t\t}\r\n\t},\r\n\r\n\t/**\r\n\t * Called when this entity is selected as the attack target.\r\n\t *\r\n\t * @param attacked The entity that selected this as the target\r\n\t */\r\n\tonTargeted: function(attacker) {\r\n\t\tif (!this.attackers) {\r\n\t\t\tthis.attackers = { size: 0 };\r\n\t\t}\r\n\t\tif (!(attacker[\"id\"] in this.attackers)) {\r\n\t\t\tthis.attackers[attacker[\"id\"]] = true;\r\n\t\t\tthis.attackers.size += 1;\r\n\t\t}\r\n\t},\r\n\r\n\t/**\r\n\t * Called when an entity deselects this as its attack target.\r\n\t *\r\n\t * @param attacker The entity that had this as the attack target, but\r\n\t * \tstopped attacking\r\n\t */\r\n\tonAttackStopped: function(attacker) {\r\n\t\tif (attacker[\"id\"] in this.attackers) {\r\n\t\t\tdelete this.attackers[attacker[\"id\"]];\r\n\t\t\tthis.attackers.size -= 1;\r\n\t\t}\r\n\t},\r\n\r\n\tdestroy: function(obj) {\r\n\t\tif (this._target) {\r\n\t\t\tthis._target.onAttackStopped(this);\r\n\t\t}\r\n\t}\r\n});\r\n\r\n})();\r\n","/***************************************************************************\r\n *                   (C) Copyright 2003-2021 - Stendhal                    *\r\n ***************************************************************************\r\n *                                                                         *\r\n *   This program is free software; you can redistribute it and/or modify  *\r\n *   it under the terms of the GNU Affero General Public License as        *\r\n *   published by the Free Software Foundation; either version 3 of the    *\r\n *   License, or (at your option) any later version.                       *\r\n *                                                                         *\r\n ***************************************************************************/\r\n\r\n\"use strict\";\r\n\r\nvar marauroa = window.marauroa = window.marauroa || {};\r\nvar stendhal = window.stendhal = window.stendhal || {};\r\n\r\n/**\r\n * Player\r\n */\r\nmarauroa.rpobjectFactory[\"player\"] = marauroa.util.fromProto(marauroa.rpobjectFactory[\"rpentity\"], {\r\n\r\n\tminimapShow: true,\r\n\tminimapStyle: \"rgb(255, 255, 255)\",\r\n\tdir: 3,\r\n\r\n\tset: function(key, value) {\r\n\t\tmarauroa.rpobjectFactory[\"rpentity\"].set.apply(this, arguments);\r\n\t\tif (key === \"ghostmode\") {\r\n\t\t\tthis.minimapShow = false;\r\n\t\t}\r\n\r\n\t\t// stats\r\n\t\tif (marauroa.me !== this) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (stendhal.ui.stats.keys.indexOf(key) > -1) {\r\n\t\t\tstendhal.ui.stats.dirty = true;\r\n\t\t}\r\n\t},\r\n\r\n\t/**\r\n\t * Is this player an admin?\r\n\t */\r\n\tisAdmin: function() {\r\n\t\treturn (typeof(this[\"adminlevel\"]) !== \"undefined\" && this[\"adminlevel\"] > 600);\r\n\t},\r\n\r\n\tbuildActions: function(list) {\r\n\t\tmarauroa.rpobjectFactory[\"rpentity\"].buildActions.apply(this, arguments);\r\n\t\tvar playerName = this[\"_name\"];\r\n\t\tvar isUnknown = (marauroa.me !== this) && ((marauroa.me[\"buddies\"] == null) || !(playerName in marauroa.me[\"buddies\"]));\r\n\t\tif (isUnknown) {\r\n\t\t\tlist.push({\r\n\t\t\t\ttitle: \"Add to buddies\",\r\n\t\t\t\taction: function(entity) {\r\n\t\t\t\t\tvar action = {\r\n\t\t\t\t\t\t\"type\": \"addbuddy\",\r\n\t\t\t\t\t\t\"zone\": marauroa.currentZoneName,\r\n\t\t\t\t\t\t\"target\": playerName\r\n\t\t\t\t\t};\r\n\t\t\t\t\tmarauroa.clientFramework.sendAction(action);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tif (this.isIgnored()) {\r\n\t\t\tlist.push({\r\n\t\t\t\ttitle: \"Remove ignore\",\r\n\t\t\t\taction: function(entity) {\r\n\t\t\t\t\tvar action = {\r\n\t\t\t\t\t\t\"type\": \"unignore\",\r\n\t\t\t\t\t\t\"zone\": marauroa.currentZoneName,\r\n\t\t\t\t\t\t\"target\": playerName\r\n\t\t\t\t\t};\r\n\t\t\t\t\tmarauroa.clientFramework.sendAction(action);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t} else if (isUnknown) {\r\n\t\t\tlist.push({\r\n\t\t\t\ttitle: \"Ignore\",\r\n\t\t\t\taction: function(entity) {\r\n\t\t\t\t\tvar action = {\r\n\t\t\t\t\t\t\"type\": \"ignore\",\r\n\t\t\t\t\t\t\"zone\": marauroa.currentZoneName,\r\n\t\t\t\t\t\t\"target\": playerName\r\n\t\t\t\t\t};\r\n\t\t\t\t\tmarauroa.clientFramework.sendAction(action);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\tif (marauroa.me === this) {\r\n\t\t\tlist.push({\r\n\t\t\t\ttitle: \"Set outfit\",\r\n\t\t\t\taction: function(entity) {\r\n\t\t\t\t\tnew stendhal.ui.OutfitDialog();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tlist.push({\r\n\t\t\t\ttitle: \"Where\",\r\n\t\t\t\taction: function(entity) {\r\n\t\t\t\t\tvar action = {\r\n\t\t\t\t\t\t\"type\": \"where\",\r\n\t\t\t\t\t\t\"target\": playerName,\r\n\t\t\t\t\t};\r\n\t\t\t\t\tmarauroa.clientFramework.sendAction(action);\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t}\r\n\t/*\r\n\r\n\t\tlist.push({\r\n\t\t\ttitle: \"Trade\",\r\n\t\t\ttype: \"trade\"\r\n\t\t})\r\n\t\tlist.add(ActionType.INVITE.getRepresentation());\r\n\t\t*/\r\n\t},\r\n\r\n\tisIgnored: function() {\r\n\t\tif (!marauroa.me || !marauroa.me[\"!ignore\"]) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tvar temp = marauroa.me[\"!ignore\"]._objects;\r\n\t\treturn temp.length > 0 && (\"_\" + this[\"_name\"]) in temp[0];\r\n\t},\r\n\r\n\tdraw: function(ctx) {\r\n\t\tif (this.isIgnored()) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tmarauroa.rpobjectFactory[\"rpentity\"].draw.apply(this, arguments);\r\n\t},\r\n\r\n\tgetResistance: function() {\r\n\t\tif (typeof(this[\"ghostmode\"]) !== \"undefined\") {\r\n\t\t\treturn 0;\r\n\t\t}\r\n\t\treturn this[\"resistance\"];\r\n\t},\r\n\r\n\t/**\r\n\t * says a text\r\n\t */\r\n\tsay: function (text) {\r\n\t\tif (this.isIgnored()) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tmarauroa.rpobjectFactory[\"rpentity\"].say.apply(this, arguments);\r\n\t},\r\n\r\n\t/**\r\n\t * Can the player hear this chat message?\r\n\t */\r\n\tisInHearingRange: function(entity) {\r\n\t\treturn (this.isAdmin()\r\n\t\t\t|| ((Math.abs(this[\"x\"] - entity[\"x\"]) < 15)\r\n\t\t\t\t&& (Math.abs(this[\"y\"] - entity[\"y\"]) < 15)));\r\n\t},\r\n\r\n\tgetCursor: function(x, y) {\r\n\t\tif (this.isVisibleToAction()) {\r\n\t\t\treturn \"url(/data/sprites/cursor/look.png) 1 3, auto\";\r\n\t\t}\r\n\t\treturn \"url(/data/sprites/cursor/walk.png) 1 3, auto\";\r\n\t}\r\n\r\n});\r\n","/***************************************************************************\r\n *                   (C) Copyright 2003-2017 - Stendhal                    *\r\n ***************************************************************************\r\n *                                                                         *\r\n *   This program is free software; you can redistribute it and/or modify  *\r\n *   it under the terms of the GNU Affero General Public License as        *\r\n *   published by the Free Software Foundation; either version 3 of the    *\r\n *   License, or (at your option) any later version.                       *\r\n *                                                                         *\r\n ***************************************************************************/\r\n\r\n\"use strict\";\r\n\r\nvar marauroa = window.marauroa = window.marauroa || {};\r\n\r\n/**\r\n * Creature\r\n */\r\nmarauroa.rpobjectFactory[\"creature\"] = marauroa.util.fromProto(marauroa.rpobjectFactory[\"rpentity\"], {\r\n\tminimapStyle: \"rgb(255,255,0)\",\r\n\tspritePath: \"monsters\",\r\n\ttitleStyle: \"#ffc8c8\",\r\n\r\n\tonclick: function(x, y) {\r\n\t\tvar action = {\r\n\t\t\t\t\"type\": \"attack\",\r\n\t\t\t\t\"target\": \"#\" + this[\"id\"]\r\n\t\t\t};\r\n\t\tmarauroa.clientFramework.sendAction(action);\r\n\t},\r\n\r\n\t// Overrides the one in creature\r\n\tsay: function (text) {\r\n\t\tthis.addSpeechBubble(text);\r\n\t},\r\n\r\n\tgetCursor: function(x, y) {\r\n\t\treturn \"url(/data/sprites/cursor/attack.png) 1 3, auto\";\r\n\t}\r\n\r\n});\r\n","/***************************************************************************\r\n *                   (C) Copyright 2003-2017 - Stendhal                    *\r\n ***************************************************************************\r\n *                                                                         *\r\n *   This program is free software; you can redistribute it and/or modify  *\r\n *   it under the terms of the GNU Affero General Public License as        *\r\n *   published by the Free Software Foundation; either version 3 of the    *\r\n *   License, or (at your option) any later version.                       *\r\n *                                                                         *\r\n ***************************************************************************/\r\n\r\n\"use strict\";\r\n\r\nvar marauroa = window.marauroa = window.marauroa || {};\r\nvar stendhal = window.stendhal = window.stendhal || {};\r\n\r\nmarauroa.rpobjectFactory[\"domesticanimal\"] = marauroa.util.fromProto(marauroa.rpobjectFactory[\"rpentity\"], {\r\n\tdrawSprite: function(ctx, filename) {\r\n\t\tvar localX = this[\"_x\"] * 32;\r\n\t\tvar localY = this[\"_y\"] * 32;\r\n\t\tvar image = stendhal.data.sprites.get(this.imagePath);\r\n\t\tif (image.height) {\r\n\t\t\tvar nFrames = 3;\r\n\t\t\tvar nDirections = 4;\r\n\t\t\tvar yRow = this[\"dir\"] - 1;\r\n\t\t\tif (this[\"weight\"] >= this[\"largeWeight\"]) {\r\n\t\t\t\tyRow += 4;\r\n\t\t\t}\r\n\t\t\tthis[\"drawHeight\"] = image.height / nDirections / 2;\r\n\t\t\tthis[\"drawWidth\"] = image.width / nFrames;\r\n\t\t\tvar drawX = ((this[\"width\"] * 32) - this[\"drawWidth\"]) / 2;\r\n\t\t\tvar frame = 0;\r\n\t\t\tif (this[\"speed\"] > 0) {\r\n\t\t\t\t// % Works normally with *floats* (just whose bright idea was\r\n\t\t\t\t// that?), so use floor() as a workaround\r\n\t\t\t\tframe = Math.floor(Date.now() / 100) % nFrames;\r\n\t\t\t}\r\n\t\t\tvar drawY = (this[\"height\"] * 32) - this[\"drawHeight\"];\r\n\t\t\tctx.drawImage(image, frame * this[\"drawWidth\"], yRow * this[\"drawHeight\"], this[\"drawWidth\"], this[\"drawHeight\"], localX + drawX, localY + drawY, this[\"drawWidth\"], this[\"drawHeight\"]);\r\n\t\t}\r\n\t},\r\n\r\n\tgetCursor: function(x, y) {\r\n\t\treturn \"url(/data/sprites/cursor/look.png) 1 3, auto\";\r\n\t}\r\n\r\n});\r\n\r\nmarauroa.rpobjectFactory[\"sheep\"] = marauroa.util.fromProto(marauroa.rpobjectFactory[\"domesticanimal\"], {\r\n\timagePath: \"/data/sprites/sheep.png\",\r\n\tlargeWeight: 60\r\n});\r\n\r\nmarauroa.rpobjectFactory[\"cat\"] = marauroa.util.fromProto(marauroa.rpobjectFactory[\"domesticanimal\"], {\r\n\timagePath: \"/data/sprites/cat.png\",\r\n\tlargeWeight: 20\r\n});\r\n\r\nmarauroa.rpobjectFactory[\"baby_dragon\"] = marauroa.util.fromProto(marauroa.rpobjectFactory[\"domesticanimal\"], {\r\n\timagePath: \"/data/sprites/baby_dragon.png\",\r\n\tlargeWeight: 20,\r\n\t// A default title that does not have an underscore. Named pets set their\r\n\t// own title anyway\r\n\ttitle: \"baby dragon\"\r\n});\r\n","/***************************************************************************\r\n *                   (C) Copyright 2003-2017 - Stendhal                    *\r\n ***************************************************************************\r\n *                                                                         *\r\n *   This program is free software; you can redistribute it and/or modify  *\r\n *   it under the terms of the GNU Affero General Public License as        *\r\n *   published by the Free Software Foundation; either version 3 of the    *\r\n *   License, or (at your option) any later version.                       *\r\n *                                                                         *\r\n ***************************************************************************/\r\n\r\n\"use strict\";\r\n\r\nvar marauroa = window.marauroa = window.marauroa || {};\r\n\r\n/**\r\n * NPC\r\n */\r\nmarauroa.rpobjectFactory[\"npc\"] = marauroa.util.fromProto(marauroa.rpobjectFactory[\"rpentity\"], {\r\n\tminimapStyle: \"rgb(0,0,255)\",\r\n\tspritePath: \"npc\",\r\n\ttitleStyle: \"#c8c8ff\",\r\n\t\"hp\": 100,\r\n\t\"base_hp\": 100,\r\n\r\n\tdrawTop: function(ctx) {\r\n\t\tvar localX = this[\"_x\"] * 32;\r\n\t\tvar localY = this[\"_y\"] * 32;\r\n\t\tif (typeof(this[\"no_hpbar\"]) == \"undefined\") {\r\n\t\t\tthis.drawHealthBar(ctx, localX, localY);\r\n\t\t}\r\n\t\tif (typeof(this[\"unnamed\"]) == \"undefined\") {\r\n\t\t\tthis.drawTitle(ctx, localX, localY);\r\n\t\t}\r\n\t},\r\n\r\n\tgetCursor: function(x, y) {\r\n\t\treturn \"url(/data/sprites/cursor/look.png) 1 3, auto\";\r\n\t}\r\n\r\n});\r\n\r\nmarauroa.rpobjectFactory[\"training_dummy\"] = marauroa.rpobjectFactory[\"npc\"];\r\n","/***************************************************************************\r\n *                   (C) Copyright 2003-2017 - Stendhal                    *\r\n ***************************************************************************\r\n *                                                                         *\r\n *   This program is free software; you can redistribute it and/or modify  *\r\n *   it under the terms of the GNU Affero General Public License as        *\r\n *   published by the Free Software Foundation; either version 3 of the    *\r\n *   License, or (at your option) any later version.                       *\r\n *                                                                         *\r\n ***************************************************************************/\r\n\r\n\"use strict\";\r\n\r\nvar marauroa = window.marauroa = window.marauroa || {};\r\nvar stendhal = window.stendhal = window.stendhal || {};\r\n\r\nmarauroa.rpobjectFactory[\"sign\"] = marauroa.util.fromProto(marauroa.rpobjectFactory[\"entity\"], {\r\n\tzIndex: 5000,\r\n\t\"class\": \"default\",\r\n\r\n\tdraw: function(ctx) {\r\n\t\tif (!this.imagePath) {\r\n\t\t\tthis.imagePath = \"/data/sprites/signs/\" + this[\"class\"] + \".png\";\r\n\t\t}\r\n\t\tvar image = stendhal.data.sprites.get(this.imagePath);\r\n\t\tif (image.height) {\r\n\t\t\tvar localX = this[\"x\"] * 32;\r\n\t\t\tvar localY = this[\"y\"] * 32;\r\n\t\t\tctx.drawImage(image, localX, localY);\r\n\t\t}\r\n\t},\r\n\r\n\tisVisibleToAction: function(filter) {\r\n\t\treturn true;\r\n\t},\r\n\r\n\tgetCursor: function(x, y) {\r\n\t\treturn \"url(/data/sprites/cursor/look.png) 1 3, auto\";\r\n\t}\r\n});\r\n\r\nmarauroa.rpobjectFactory[\"blackboard\"] = marauroa.rpobjectFactory[\"sign\"];\r\nmarauroa.rpobjectFactory[\"rented_sign\"] = marauroa.rpobjectFactory[\"sign\"];\r\n","/***************************************************************************\r\n *                   (C) Copyright 2003-2017 - Stendhal                    *\r\n ***************************************************************************\r\n *                                                                         *\r\n *   This program is free software; you can redistribute it and/or modify  *\r\n *   it under the terms of the GNU Affero General Public License as        *\r\n *   published by the Free Software Foundation; either version 3 of the    *\r\n *   License, or (at your option) any later version.                       *\r\n *                                                                         *\r\n ***************************************************************************/\r\n\r\n\"use strict\";\r\n\r\nvar marauroa = window.marauroa = window.marauroa || {};\r\nvar stendhal = window.stendhal = window.stendhal || {};\r\n\r\n/**\r\n * Creature\r\n */\r\nmarauroa.rpobjectFactory[\"growing_entity_spawner\"] = marauroa.util.fromProto(marauroa.rpobjectFactory[\"entity\"], {\r\n\tzIndex: 3000,\r\n\r\n\t/**\r\n\t * is this entity visible to a specific action\r\n\t *\r\n\t * @param filter 0: short left click\r\n\t * @return true, if the entity is visible, false otherwise\r\n\t */\r\n\tisVisibleToAction: function(filter) {\r\n\t\treturn true;\r\n\t},\r\n\r\n\tbuildActions: function(list) {\r\n\t\tif (!this[\"menu\"]) {\r\n\t\t\tlist.push({\r\n\t\t\t\ttitle: \"Harvest\",\r\n\t\t\t\ttype: \"use\",\r\n\t\t\t});\r\n\t\t}\r\n\t\tmarauroa.rpobjectFactory[\"growing_entity_spawner\"].proto.buildActions.apply(this, arguments);\r\n\t},\r\n\r\n\tonclick: function(x, y) {\r\n\t\tvar action = {\r\n\t\t\t\"type\": \"use\",\r\n\t\t\t\"target\": \"#\" + this[\"id\"],\r\n\t\t\t\"zone\": marauroa.currentZoneName\r\n\t\t};\r\n\t\tmarauroa.clientFramework.sendAction(action);\r\n\t},\r\n\r\n\t/**\r\n\t * draw RPEntities\r\n\t */\r\n\tdraw: function(ctx) {\r\n\t\tvar localX = this[\"x\"] * 32;\r\n\t\tvar localY = this[\"y\"] * 32;\r\n\t\tvar image = stendhal.data.sprites.get(\"/data/sprites/\" + this[\"class\"] + \".png\");\r\n\t\tif (image.height) { // image.complete is true on missing image files\r\n\t\t\tvar count = parseInt(this[\"max_ripeness\"], 10) + 1;\r\n\t\t\tvar drawHeight = image.height / count;\r\n\t\t\tvar yRow = this[\"ripeness\"];\r\n\t\t\tctx.drawImage(image, 0, yRow * drawHeight, image.width, drawHeight,\r\n\t\t\t\t\tlocalX, localY - drawHeight + 32, image.width, drawHeight);\r\n\t\t}\r\n\t},\r\n\r\n\tgetCursor: function(x, y) {\r\n\t\treturn \"url(/data/sprites/cursor/harvest.png) 1 3, auto\";\r\n\t}\r\n\r\n});\r\n","/***************************************************************************\r\n *                      (C) Copyright 2020 - Stendhal                      *\r\n ***************************************************************************\r\n *                                                                         *\r\n *   This program is free software; you can redistribute it and/or modify  *\r\n *   it under the terms of the GNU Affero General Public License as        *\r\n *   published by the Free Software Foundation; either version 3 of the    *\r\n *   License, or (at your option) any later version.                       *\r\n *                                                                         *\r\n ***************************************************************************/\r\n\r\n\"use strict\";\r\n\r\nvar marauroa = window.marauroa = window.marauroa || {};\r\n\r\n/**\r\n * Portal\r\n */\r\nmarauroa.rpobjectFactory[\"door\"] = marauroa.util.fromProto(marauroa.rpobjectFactory[\"portal\"], {\r\n\tzIndex: 5000,\r\n\r\n\tdraw: function(ctx) {\r\n\t\tvar imagePath = \"/data/sprites/doors/\" + this[\"class\"] + \".png\";\r\n\t\tvar image = stendhal.data.sprites.get(imagePath);\r\n\t\tif (image.height) {\r\n\t\t\tvar x = (this[\"x\"] - 1) * 32;\r\n\t\t\tvar y = (this[\"y\"] - 1) * 32;\r\n\t\t\tvar height = image.height / 2;\r\n\r\n\t\t\tvar offsetY = height;\r\n\t\t\tif (this[\"open\"] === \"\") {\r\n\t\t\t\toffsetY = 0;\r\n\t\t\t}\r\n\t\t\tctx.drawImage(image, 0, offsetY, image.width, height, x, y, image.width, height);\r\n\t\t}\r\n\t},\r\n\r\n\tbuildActions: function(list) {\r\n\t\tlist.push({\r\n\t\t\ttitle: \"Look\",\r\n\t\t\ttype: \"look\"\r\n\t\t});\r\n\t\tlist.push({\r\n\t\t\ttitle: \"Use\",\r\n\t\t\ttype: \"use\"\r\n\t\t});\r\n\t},\r\n\r\n\tisVisibleToAction: function(filter) {\r\n\t\treturn true;\r\n\t},\r\n\r\n\r\n\t/**\r\n\t * Create the default action for this entity. If the entity specifies a\r\n\t * default action description, interpret it as an action command.\r\n\t */\r\n\tgetDefaultAction: function() {\r\n\t\treturn {\r\n\t\t\t\"type\": \"moveto\",\r\n\t\t\t\"x\": \"\" + this[\"x\"],\r\n\t\t\t\"y\": \"\" + this[\"y\"],\r\n\t\t\t\"zone\": marauroa.currentZoneName\r\n\t\t};\r\n\t},\r\n\r\n\tgetCursor: function(x, y) {\r\n\t\treturn \"url(/data/sprites/cursor/portal.png) 1 3, auto\";\r\n\t}\r\n\r\n});\r\n","/***************************************************************************\r\n *                   (C) Copyright 2003-2018 - Stendhal                    *\r\n ***************************************************************************\r\n *                                                                         *\r\n *   This program is free software; you can redistribute it and/or modify  *\r\n *   it under the terms of the GNU Affero General Public License as        *\r\n *   published by the Free Software Foundation; either version 3 of the    *\r\n *   License, or (at your option) any later version.                       *\r\n *                                                                         *\r\n ***************************************************************************/\r\n\r\n\"use strict\";\r\n\r\nvar marauroa = window.marauroa = window.marauroa || {};\r\nvar stendhal = window.stendhal = window.stendhal || {};\r\n\r\n(function() {\r\n\r\nmarauroa.rpobjectFactory[\"useable_entity\"] = marauroa.util.fromProto(marauroa.rpobjectFactory[\"entity\"], {\r\n\tzIndex: 3000,\r\n\taction: \"use\",\r\n\r\n\tinit: function() {\r\n\t\tthis.sprite = {\r\n\t\t\theight: 32,\r\n\t\t\twidth: 32\r\n\t\t};\r\n\t},\r\n\r\n\tset: function(key, value) {\r\n\t\tmarauroa.rpobjectFactory[\"entity\"].set.apply(this, arguments);\r\n\t\tif (key === \"class\" || key === \"name\") {\r\n\t\t\tthis.sprite.filename = \"/data/sprites/\"\r\n\t\t\t\t+ this[\"class\"] + \"/\" + this[\"_name\"] + \".png\";\r\n\t\t}\r\n\t\tif (key === \"state\") {\r\n\t\t\tthis.sprite.offsetY = this[\"state\"] * 32;\r\n\t\t}\r\n\t},\r\n\r\n\tisVisibleToAction: function(filter) {\r\n\t\treturn true;\r\n\t},\r\n\r\n});\r\n\r\n}());\r\n","/***************************************************************************\r\n *                   (C) Copyright 2003-2020 - Stendhal                    *\r\n ***************************************************************************\r\n *                                                                         *\r\n *   This program is free software; you can redistribute it and/or modify  *\r\n *   it under the terms of the GNU Affero General Public License as        *\r\n *   published by the Free Software Foundation; either version 3 of the    *\r\n *   License, or (at your option) any later version.                       *\r\n *                                                                         *\r\n ***************************************************************************/\r\n\r\n\"use strict\";\r\n\r\nvar marauroa = window.marauroa = window.marauroa || {};\r\nvar stendhal = window.stendhal = window.stendhal || {};\r\n\r\n/**\r\n * VisibleEntity\r\n */\r\nmarauroa.rpobjectFactory[\"visible_entity\"] = marauroa.util.fromProto(marauroa.rpobjectFactory[\"entity\"], {\r\n\tzIndex: 1,\r\n\r\n\tinit: function() {\r\n\t\tthis.sprite = {\r\n\t\t\theight: 32,\r\n\t\t\twidth: 32\r\n\t\t};\r\n\t},\r\n\r\n\tset: function(key, value) {\r\n\t\tmarauroa.rpobjectFactory[\"visible_entity\"].proto.set.apply(this, arguments);\r\n\t\tif (key === \"class\" || key === \"subclass\" || key === \"_name\") {\r\n\t\t\tthis.sprite.filename = \"/data/sprites/\"\r\n\t\t\t\t+ (this[\"class\"] || \"\") + \"/\"\r\n\t\t\t\t+ (this[\"subclass\"] || \"\") + \"/\"\r\n\t\t\t\t+ (this[\"_name\"] || \"\") + \".png\";\r\n\t\t} else if (key === \"state\") {\r\n\t\t\tthis.sprite.offsetY = value * 32;\r\n\t\t}\r\n\t},\r\n\r\n\tisVisibleToAction: function(filter) {\r\n\t\treturn true;\r\n\t},\r\n\r\n\tgetCursor: function(x, y) {\r\n\t\treturn \"url(/data/sprites/cursor/look.png) 1 3, auto\";\r\n\t}\r\n\r\n});\r\n\r\nmarauroa.rpobjectFactory[\"plant_grower\"] = marauroa.rpobjectFactory[\"visible_entity\"];\r\nmarauroa.rpobjectFactory[\"block\"] = marauroa.rpobjectFactory[\"visible_entity\"];\r\n","/***************************************************************************\r\n *                   (C) Copyright 2003-2017 - Stendhal                    *\r\n ***************************************************************************\r\n *                                                                         *\r\n *   This program is free software; you can redistribute it and/or modify  *\r\n *   it under the terms of the GNU Affero General Public License as        *\r\n *   published by the Free Software Foundation; either version 3 of the    *\r\n *   License, or (at your option) any later version.                       *\r\n *                                                                         *\r\n ***************************************************************************/\r\n\r\n\"use strict\";\r\n\r\nvar marauroa = window.marauroa = window.marauroa || {};\r\nvar stendhal = window.stendhal = window.stendhal || {};\r\n\r\n/**\r\n * walkblocker\r\n */\r\nmarauroa.rpobjectFactory[\"walkblocker\"] = marauroa.util.fromProto(marauroa.rpobjectFactory[\"entity\"], {\r\n\tzIndex: 3000,\r\n\r\n\tisVisibleToAction: function(filter) {\r\n\t\treturn true;\r\n\t},\r\n\r\n\tgetCursor: function(x, y) {\r\n\t\treturn \"url(/data/sprites/cursor/stop.png) 1 3, auto\";\r\n\t}\r\n\r\n});\r\n","/***************************************************************************\r\n *                   (C) Copyright 2003-2017 - Stendhal                    *\r\n ***************************************************************************\r\n *                                                                         *\r\n *   This program is free software; you can redistribute it and/or modify  *\r\n *   it under the terms of the GNU Affero General Public License as        *\r\n *   published by the Free Software Foundation; either version 3 of the    *\r\n *   License, or (at your option) any later version.                       *\r\n *                                                                         *\r\n ***************************************************************************/\r\n\r\n\"use strict\";\r\n\r\nvar marauroa = window.marauroa = window.marauroa || {};\r\nvar stendhal = window.stendhal = window.stendhal || {};\r\nstendhal.zone = stendhal.zone || {};\r\n\r\n\r\n/**\r\n * stendhal zone\r\n */\r\nstendhal.zone = {\r\n\tentityAt: function(x, y, filter) {\r\n\t\tx = x / 32;\r\n\t\ty = y / 32;\r\n\t\tvar res = stendhal.zone.ground;\r\n\t\tfor (var i in stendhal.zone.entities) {\r\n\t\t\tvar obj = stendhal.zone.entities[i];\r\n\t\t\tif (obj.isVisibleToAction(filter) && (obj[\"_x\"] <= x) && (obj[\"_y\"] <= y)\r\n\t\t\t\t&& (obj[\"_x\"] + (obj[\"width\"] || 1) >= x) && (obj[\"_y\"] + (obj[\"height\"] || 1) >= y)) {\r\n\r\n\t\t\t\tres = obj;\r\n\t\t\t}\r\n\t\t}\r\n\t\t// TODO: check draw area\r\n\r\n\t\treturn res;\r\n\t},\r\n\r\n\tsortEntities: function() {\r\n\t\tthis.entities = [];\r\n\t\tfor (var i in marauroa.currentZone) {\r\n\t\t\tif (marauroa.currentZone.hasOwnProperty(i) && typeof(marauroa.currentZone[i]) != \"function\") {\r\n\t\t\t\tthis.entities.push(marauroa.currentZone[i]);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis.entities.sort(function(entity1, entity2) {\r\n\t\t\tvar rv = entity1.zIndex - entity2.zIndex;\r\n\t\t\tif (rv == 0) {\r\n\t\t\t\trv = (entity1.y + entity1.height) - (entity2.y + entity2.height);\r\n\t\t\t\tif (rv == 0) {\r\n\t\t\t\t\trv = entity1.id - entity2.id;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn rv;\r\n\t\t});\r\n\t}\r\n};\r\n","/***************************************************************************\r\n *                   (C) Copyright 2003-2017 - Stendhal                    *\r\n ***************************************************************************\r\n *                                                                         *\r\n *   This program is free software; you can redistribute it and/or modify  *\r\n *   it under the terms of the GNU Affero General Public License as        *\r\n *   published by the Free Software Foundation; either version 3 of the    *\r\n *   License, or (at your option) any later version.                       *\r\n *                                                                         *\r\n ***************************************************************************/\r\n\r\n\"use strict\";\r\nvar marauroa = window.marauroa = window.marauroa || {};\r\nvar stendhal = window.stendhal = window.stendhal || {};\r\n\r\nstendhal.zone = stendhal.zone || {};\r\n\r\n/**\r\n * a pseudo entity which represents the ground\r\n */\r\nstendhal.zone.ground = {\r\n\r\n\tisVisibleToAction: function(filter) {\r\n\t\treturn false;\r\n\t},\r\n\r\n\r\n\t/**\r\n\t * Calculates whether the click was close enough to a zone border to trigger\r\n\t * a zone change.\r\n\t *\r\n\t * @param x x of click point in world coordinates\r\n\t * @param y y of click point in world coordinates\r\n\t * @return Direction of the zone to change to, <code>null</code> if no zone change should happen\r\n\t */\r\n\tcalculateZoneChangeDirection: function(x, y) {\r\n\t\tif (x < 15) {\r\n\t\t\treturn \"4\"; // LEFT\r\n\t\t}\r\n\t\tif (x > stendhal.data.map.zoneSizeX * 32 - 15) {\r\n\t\t\treturn \"2\"; // RIGHT\r\n\t\t}\r\n\t\tif (y < 15) {\r\n\t\t\treturn \"1\"; // UP\r\n\t\t}\r\n\t\tif (y > stendhal.data.map.zoneSizeY * 32 - 15) {\r\n\t\t\treturn \"3\"; // DOWN\r\n\t\t}\r\n\t\treturn null;\r\n\t},\r\n\r\n\tgetCursor: function(x, y) {\r\n\t\tif ((x < 15) || (y < 15) || (x > stendhal.data.map.zoneSizeX * 32 - 15) || (y > stendhal.data.map.zoneSizeY * 32 - 15)) {\r\n\t\t\treturn \"url(/data/sprites/cursor/walkborder.png) 1 3, auto\"\r\n\t\t}\r\n\t\tvar worldX = Math.floor(x / 32);\r\n\t\tvar worldY = Math.floor(y / 32);\r\n\t\tif (stendhal.data.map.collision(worldX, worldY)) {\r\n\t\t\treturn \"url(/data/sprites/cursor/stop.png) 1 3, auto\";\r\n\t\t}\r\n\t\treturn \"url(/data/sprites/cursor/walk.png) 1 3, auto\";\r\n\t},\r\n\r\n\tonclick: function(x, y, dblclick) {\r\n\t\tvar gameX = x + stendhal.ui.gamewindow.offsetX;\r\n\t\tvar gameY = y + stendhal.ui.gamewindow.offsetY;\r\n\t\tvar action = {\r\n\t\t\t\"type\": \"moveto\",\r\n\t\t\t\"x\": \"\" + Math.floor(gameX / 32),\r\n\t\t\t\"y\": \"\" + Math.floor(gameY / 32)\r\n\t\t};\r\n\r\n\t\tif (typeof dblclick == \"boolean\" && dblclick) {\r\n\t\t\taction[\"double_click\"] = \"\";\r\n\t\t}\r\n\r\n\t\tvar extend = this.calculateZoneChangeDirection(gameX, gameY);\r\n\t\tif (extend) {\r\n\t\t\taction.extend = extend;\r\n\t\t}\r\n\t\tmarauroa.clientFramework.sendAction(action);\r\n\t}\r\n\r\n};\r\n","/*\r\nThe MIT License (MIT)\r\n\r\nCopyright (c) 2014 Mihai Valentin\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy\r\nof this software and associated documentation files (the \"Software\"), to deal\r\nin the Software without restriction, including without limitation the rights\r\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\ncopies of the Software, and to permit persons to whom the Software is\r\nfurnished to do so, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in all\r\ncopies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\r\nSOFTWARE.\r\n\r\nglobal DataTransfer, DragEvent */\r\n\r\n/*! setDragImage-IE - polyfill for setDragImage method for Internet Explorer 10+\r\n https://github.com/MihaiValentin/setDragImage-IE */\r\n\r\n/**\r\n * this method preloads the image, so it will be already loaded when we will use it as a drag image\r\n * @param image\r\n */\r\nwindow.setDragImageIEPreload = function(image) {\r\n    var bodyEl,\r\n        preloadEl;\r\n\r\n    bodyEl = document.body;\r\n\r\n    // create the element that preloads the  image\r\n    preloadEl = document.createElement('div');\r\n    preloadEl.style.background = 'url(\"' + image.src + '\")';\r\n    preloadEl.style.position = 'absolute';\r\n    preloadEl.style.opacity = 0.001;\r\n\r\n    bodyEl.appendChild(preloadEl);\r\n\r\n    // after it has been preloaded, just remove the element so it won't stay forever in the DOM\r\n    setTimeout(function() {\r\n        bodyEl.removeChild(preloadEl);\r\n    }, 5000);\r\n};\r\n\r\n// if the setDragImage is not available, implement it\r\nif ('function' !== typeof DataTransfer.prototype.setDragImage) {\r\n    DataTransfer.prototype.setDragImage = function(image, offsetX, offsetY) {\r\n        var randomDraggingClassName,\r\n            dragStylesCSS,\r\n            dragStylesEl,\r\n            headEl,\r\n            parentFn,\r\n            eventTarget;\r\n\r\n        // generate a random class name that will be added to the element\r\n        randomDraggingClassName = 'setdragimage-ie-dragging-' + Math.round(Math.random() * Math.pow(10, 5)) + '-' + Date.now();\r\n\r\n        // prepare the rules for the random class\r\n        dragStylesCSS = [\r\n            '.' + randomDraggingClassName,\r\n            '{',\r\n            'background: url(\"' + image.src + '\") no-repeat #fff 0 0 !important;',\r\n            'width: ' + image.width + 'px !important;',\r\n            'height: ' + image.height + 'px !important;',\r\n            'text-indent: -9999px !important;',\r\n            'border: 0 !important;',\r\n            'outline: 0 !important;',\r\n            '}',\r\n            '.' + randomDraggingClassName + ' * {',\r\n            'display: none !important;',\r\n            '}'\r\n        ];\r\n        // create the element and add it to the head of the page\r\n        dragStylesEl = document.createElement('style');\r\n        dragStylesEl.innerText = dragStylesCSS.join('');\r\n        headEl = document.getElementsByTagName('head')[0];\r\n        headEl.appendChild(dragStylesEl);\r\n\r\n       \teventTarget = window.event.target;\r\n\r\n        // and add the class we prepared to it\r\n        eventTarget.classList.add(randomDraggingClassName);\r\n\r\n        /* immediately after adding the class, we remove it. in this way the browser will\r\n        have time to make a snapshot and use it just so it looks like the drag element */\r\n        setTimeout(function() {\r\n            // remove the styles\r\n            headEl.removeChild(dragStylesEl);\r\n            // remove the class\r\n            eventTarget.classList.remove(randomDraggingClassName);\r\n        }, 0);\r\n    };\r\n}\r\n","/***************************************************************************\r\n *                   (C) Copyright 2003-2017 - Stendhal                    *\r\n ***************************************************************************\r\n *                                                                         *\r\n *   This program is free software; you can redistribute it and/or modify  *\r\n *   it under the terms of the GNU Affero General Public License as        *\r\n *   published by the Free Software Foundation; either version 3 of the    *\r\n *   License, or (at your option) any later version.                       *\r\n *                                                                         *\r\n ***************************************************************************/\r\n\r\n\"use strict\";\r\n\r\nvar marauroa = window.marauroa = window.marauroa || {};\r\nvar stendhal = window.stendhal = window.stendhal || {};\r\nstendhal.ui = stendhal.ui || {};\r\n\r\n/**\r\n * buddylist\r\n */\r\nstendhal.ui.buddyList = {\r\n\r\n\tbuddies: [],\r\n\r\n\t// TODO: don't rebuilt the buddylist completely on every turn,\r\n\t//       but implement an observer\r\n\tupdate: function() {\r\n\t\tvar data = marauroa.me[\"buddies\"];\r\n\t\tvar buddies = [];\r\n\t\tfor (var buddy in data) {\r\n\t\t\tif (data.hasOwnProperty(buddy)) {\r\n\t\t\t\tvar entry = {\"name\": buddy};\r\n\t\t\t\tif (data[buddy] == \"true\") {\r\n\t\t\t\t\tentry.isOnline = true;\r\n\t\t\t\t\tentry.status = \"online\";\r\n\t\t\t\t} else {\r\n\t\t\t\t\tentry.isOnline = false;\r\n\t\t\t\t\tentry.status = \"offline\";\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tbuddies.push(entry);\r\n\t\t}\r\n\t\tstendhal.ui.buddyList.sort(buddies);\r\n\r\n\t\tvar html = \"\";\r\n\t\tfor (var i = 0; i < buddies.length; i++) {\r\n\t\t\thtml += \"<li class=\" + buddies[i].status + \"><img src=\\\"\";\r\n\t\t\tif (buddies[i].status == \"online\") {\r\n\t\t\t\thtml += \"/data/gui/buddy_online.png\";\r\n\t\t\t} else {\r\n\t\t\t\thtml += \"/data/gui/buddy_offline.png\";\r\n\t\t\t}\r\n\t\t\thtml += \"\\\"> \" + stendhal.ui.html.esc(buddies[i].name) + \"</li>\";\r\n\t\t}\r\n\r\n\t\tif (stendhal.ui.buddyList.lastHtml !== html) {\r\n\t\t\tvar buddyListUL = document.getElementById(\"buddyListUL\");\r\n\t\t\tbuddyListUL.innerHTML = html;\r\n\t\t\tstendhal.ui.buddyList.lastHtml = html;\r\n\t\t}\r\n\t\tstendhal.ui.buddyList.buddies = buddies;\r\n\t},\r\n\r\n\t/**\r\n\t * sorts the buddy list\r\n\t */\r\n\tsort: function(buddies) {\r\n\t\tbuddies.sort(function compare(a, b) {\r\n\t\t\t// online buddies first\r\n\t\t\tif (a.isOnline) {\r\n\t\t\t\tif (!b.isOnline) {\r\n\t\t\t\t\treturn -1;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tif (b.isOnline) {\r\n\t\t\t\t\treturn 1;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// sort by name\r\n\t\t\tif (a.name < b.name) {\r\n\t\t\t\treturn -1;\r\n\t\t\t}\r\n\t\t\tif (a.name > b.name) {\r\n\t\t\t\treturn 1;\r\n\t\t\t}\r\n\t\t\treturn 0;\r\n\t\t});\r\n\t},\r\n\r\n\tsetBuddyStatus: function(buddy, status) {\r\n\t\tstendhal.ui.buddyList.removeBuddy(buddy);\r\n\t\tvar newEntry = {\"name\": buddy, \"status\": status};\r\n\t\tstendhal.ui.buddyList.buddies.push(newEntry);\r\n\t\tstendhal.ui.buddyList.sort();\r\n\t},\r\n\r\n\thasBuddy: function(buddy) {\r\n    \tvar arrayLength = stendhal.ui.buddyList.buddies.length;\r\n    \tfor (var i = 0; i < arrayLength; i++) {\r\n\t\t\tif(stendhal.ui.buddyList.buddies[i].name === buddy) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n    \t}\r\n    \treturn false;\r\n\t},\r\n\r\n\tremoveBuddy: function(buddy) {\r\n\t\tvar arrayLength = stendhal.ui.buddyList.buddies.length;\r\n\t\tfor (var i = 0; i < arrayLength; i++) {\r\n\t\t\tif (stendhal.ui.buddyList.buddies[i].name === buddy) {\r\n\t\t\t\tstendhal.ui.buddyList.buddies.splice(i, 1);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\tbuildActions: function(actions) {\r\n\t\tif (stendhal.ui.buddyList.current.className === \"online\") {\r\n\t\t\tactions.push({\r\n\t\t\t\ttitle: \"Talk\",\r\n\t\t\t\taction: function(entity) {\r\n\t\t\t\t\tstendhal.ui.chatinput.setText(\"/msg \"\r\n\t\t\t\t\t\t\t+ stendhal.ui.buddyList.current.textContent.trim()\r\n\t\t\t\t\t\t\t+ \" \");\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tactions.push({\r\n\t\t\t\ttitle: \"Where\",\r\n\t\t\t\taction: function(entity) {\r\n\t\t\t\t\tvar action = {\r\n\t\t\t\t\t\t\"type\": \"where\",\r\n\t\t\t\t\t\t\"target\": stendhal.ui.buddyList.current.textContent.trim(),\r\n\t\t\t\t\t\t\"zone\": marauroa.currentZoneName\r\n\t\t\t\t\t};\r\n\t\t\t\t\tmarauroa.clientFramework.sendAction(action);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\t// Invite\r\n\t\t} else {\r\n\t\t\tactions.push({\r\n\t\t\t\ttitle: \"Leave Message\",\r\n\t\t\t\taction: function(entity) {\r\n\t\t\t\t\tstendhal.ui.chatinput.setText(\"/storemessage \"\r\n\t\t\t\t\t\t\t+ stendhal.ui.buddyList.current.textContent.trim()\r\n\t\t\t\t\t\t\t+ \" \");\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\tactions.push({\r\n\t\t\ttitle: \"Remove\",\r\n\t\t\taction: function(entity) {\r\n\t\t\t\tvar action = {\r\n\t\t\t\t\t\"type\": \"removebuddy\",\r\n\t\t\t\t\t\"target\": stendhal.ui.buddyList.current.textContent.trim(),\r\n\t\t\t\t\t\"zone\": marauroa.currentZoneName\r\n\t\t\t\t};\r\n\t\t\t\tmarauroa.clientFramework.sendAction(action);\r\n\t\t\t\tstendhal.ui.buddyList.removeBuddy(stendhal.ui.buddyList.current.textContent.trim());\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t},\r\n\r\n\tonMouseUp: function(event) {\r\n\r\n\t\t// get the <li> element. Ignore the click, if it was on the <ul> outside any <li>s.\r\n\t\tstendhal.ui.buddyList.current = null;\r\n\t\tif (event.target.tagName === \"LI\") {\r\n\t\t\tstendhal.ui.buddyList.current = event.target;\r\n\t\t} else if (event.target.tagName === \"IMG\") {\r\n\t\t\tstendhal.ui.buddyList.current = event.target.parentElement;\r\n\t\t}\r\n\r\n\t\tif (stendhal.ui.buddyList.current) {\r\n\t\t\tnew stendhal.ui.Menu(stendhal.ui.buddyList,\r\n\t\t\t\tMath.max(10, event.pageX - 50), event.pageY - 5);\r\n\t\t}\r\n\t}\r\n};\r\n","/***************************************************************************\r\n *                   (C) Copyright 2003-2017 - Stendhal                    *\r\n ***************************************************************************\r\n *                                                                         *\r\n *   This program is free software; you can redistribute it and/or modify  *\r\n *   it under the terms of the GNU Affero General Public License as        *\r\n *   published by the Free Software Foundation; either version 3 of the    *\r\n *   License, or (at your option) any later version.                       *\r\n *                                                                         *\r\n ***************************************************************************/\r\n\r\n\"use strict\";\r\n\r\nvar stendhal = window.stendhal = window.stendhal || {};\r\nstendhal.ui = stendhal.ui || {};\r\n\r\n/**\r\n * Chat Log\r\n */\r\nstendhal.ui.chatLog = {\r\n\taddLine: function(type, message) {\r\n\t\tvar chatElement = document.getElementById(\"chat\");\r\n\t\tif (!chatElement) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar date = new Date();\r\n\t\tvar time = \"\" + date.getHours() + \":\";\r\n\t\tif (date.getHours() < 10) {\r\n\t\t\ttime = \"0\" + time;\r\n\t\t}\r\n\t\tif (date.getMinutes() < 10) {\r\n\t\t\ttime = time + \"0\";\r\n\t\t}\r\n\t\ttime = time + date.getMinutes();\r\n\r\n\t\tvar div = document.createElement(\"div\");\r\n\t\tdiv.className = \"log\" + type;\r\n\t\tdiv.innerHTML = \"[\" + time + \"] \" + stendhal.ui.chatLog.formatLogEntry(message);\r\n\r\n\t\tvar isAtBottom = (chatElement.scrollHeight - chatElement.clientHeight) === chatElement.scrollTop;\r\n\t\tchatElement.appendChild(div);\r\n\r\n\t\tif (isAtBottom) {\r\n\t\t\tchatElement.scrollTop = chatElement.scrollHeight;\r\n\t\t}\r\n\t},\r\n\r\n\tformatLogEntry: function(message) {\r\n\t\tif (!message) {\r\n\t\t\treturn \"\";\r\n\t\t}\r\n\t\tvar res = \"\";\r\n\t\tvar delims = [\" \", \",\", \".\", \"!\", \"?\", \":\", \";\"];\r\n\t\tvar length = message.length;\r\n\t\tvar inHighlight = false, inUnderline = false,\r\n\t\t\tinHighlightQuote = false, inUnderlineQuote = false;\r\n\t\tfor (var i = 0; i < length; i++) {\r\n\t\t\tvar c = message[i];\r\n\r\n\t\t\tif (c === \"\\\\\") {\r\n\t\t\t\tvar n = message[i + 1];\r\n\t\t\t\tres += n;\r\n\t\t\t\ti++;\r\n\r\n\t\t\t// Highlight Start?\r\n\t\t\t} else if (c === \"#\") {\r\n\t\t\t\tif (inHighlight) {\r\n\t\t\t\t\tres += c;\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\tvar n = message[i + 1];\r\n\t\t\t\tif (n === \"#\") {\r\n\t\t\t\t\tres += c;\r\n\t\t\t\t\ti++;\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\tif (n === \"'\") {\r\n\t\t\t\t\tinHighlightQuote = true;\r\n\t\t\t\t\ti++;\r\n\t\t\t\t}\r\n\t\t\t\tinHighlight = true;\r\n\t\t\t\tres += \"<span class=\\\"logh\\\">\";\r\n\r\n\t\t\t// Underline start?\r\n\t\t\t} else if (c === \"\u00a7\") {\r\n\t\t\t\tif (inUnderline) {\r\n\t\t\t\t\tres += c;\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\tvar n = message[i + 1];\r\n\t\t\t\tif (n === \"\u00a7\") {\r\n\t\t\t\t\tres += c;\r\n\t\t\t\t\ti++;\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\tif (n === \"'\") {\r\n\t\t\t\t\tinUnderlineQuote = true;\r\n\t\t\t\t\ti++;\r\n\t\t\t\t}\r\n\t\t\t\tinUnderline = true;\r\n\t\t\t\tres += \"<span class=\\\"logi\\\">\";\r\n\r\n\t\t\t// End Highlight and Underline?\r\n\t\t\t} else if (c === \"'\") {\r\n\t\t\t\tif (inUnderlineQuote) {\r\n\t\t\t\t\tinUnderline = false;\r\n\t\t\t\t\tinUnderlineQuote = false;\r\n\t\t\t\t\tres += \"</span>\";\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\tif (inHighlightQuote) {\r\n\t\t\t\t\tinHighlight = false;\r\n\t\t\t\t\tinHighlightQuote = false;\r\n\t\t\t\t\tres += \"</span>\";\r\n\t\t\t\t}\r\n\r\n\t\t\t// HTML escape\r\n\t\t\t} else if (c === \"<\") {\r\n\t\t\t\tres += \"&lt;\";\r\n\r\n\t\t\t// End of word\r\n\t\t\t} else if (delims.indexOf(c) > -1) {\r\n\t\t\t\tvar n = message[i + 1];\r\n\t\t\t\tif (c === \" \" || n === \" \" || n == undefined) {\r\n\t\t\t\t\tif (inUnderline && !inUnderlineQuote && !inHighlightQuote) {\r\n\t\t\t\t\t\tinUnderline = false;\r\n\t\t\t\t\t\tres += \"</span>\" + c;\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (inHighlight && !inUnderlineQuote && !inHighlightQuote) {\r\n\t\t\t\t\t\tinHighlight = false;\r\n\t\t\t\t\t\tres += \"</span>\" + c;\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tres += c;\r\n\r\n\t\t\t// Normal characters\r\n\t\t\t} else {\r\n\t\t\t\tres += c;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Close opened formattings\r\n\t\tif (inUnderline) {\r\n\t\t\tres += \"</span>\";\r\n\t\t}\r\n\t\tif (inHighlight) {\r\n\t\t\tres += \"</span>\";\r\n\t\t}\r\n\r\n\t\treturn res;\r\n\t},\r\n\r\n\tclear: function() {\r\n\t\tdocument.getElementById(\"chat\").innerHTML = \"\";\r\n\t}\r\n}\r\n","/***************************************************************************\r\n *                   (C) Copyright 2003-2019 - Stendhal                    *\r\n ***************************************************************************\r\n *                                                                         *\r\n *   This program is free software; you can redistribute it and/or modify  *\r\n *   it under the terms of the GNU Affero General Public License as        *\r\n *   published by the Free Software Foundation; either version 3 of the    *\r\n *   License, or (at your option) any later version.                       *\r\n *                                                                         *\r\n ***************************************************************************/\r\n\r\n\"use strict\";\r\n\r\nvar marauroa = window.marauroa = window.marauroa || {};\r\nvar stendhal = window.stendhal = window.stendhal || {};\r\nstendhal.ui = stendhal.ui || {};\r\n\r\n/**\r\n * game window aka world view\r\n */\r\nstendhal.ui.gamewindow = {\r\n\t/** screen offsets in pixels. */\r\n\toffsetX: 0,\r\n\toffsetY: 0,\r\n\ttimeStamp: Date.now(),\r\n\ttextSprites: [],\r\n\r\n\tdraw: function() {\r\n\t\tvar startTime = new Date().getTime();\r\n\r\n\t\tif (marauroa.me && document.visibilityState === \"visible\") {\r\n\t\t\tif (marauroa.currentZoneName === stendhal.data.map.currentZoneName\r\n\t\t\t\t|| stendhal.data.map.currentZoneName === \"int_vault\"\r\n\t\t\t\t|| stendhal.data.map.currentZoneName === \"int_adventure_island\") {\r\n\t\t\t\tvar canvas = document.getElementById(\"gamewindow\");\r\n\t\t\t\tthis.targetTileWidth = 32;\r\n\t\t\t\tthis.targetTileHeight = 32;\r\n\t\t\t\tthis.drawingError = false;\r\n\r\n\t\t\t\tthis.ctx = canvas.getContext(\"2d\");\r\n\t\t\t\tthis.ctx.globalAlpha = 1.0;\r\n\t\t\t\tthis.adjustView(canvas);\r\n\t\t\t\tthis.ctx.fillStyle = \"black\";\r\n\t\t\t\tthis.ctx.fillRect(0, 0, 10000, 10000);\r\n\r\n\t\t\t\tvar tileOffsetX = Math.floor(this.offsetX / this.targetTileWidth);\r\n\t\t\t\tvar tileOffsetY = Math.floor(this.offsetY / this.targetTileHeight);\r\n\r\n\t\t\t\tfor (var drawingLayer=0; drawingLayer < stendhal.data.map.layers.length; drawingLayer++) {\r\n\t\t\t\t\tvar name = stendhal.data.map.layerNames[drawingLayer];\r\n\t\t\t\t\tif (name !== \"protection\" && name !== \"collision\" && name !== \"objects\"\r\n\t\t\t\t\t\t&& name !== \"blend_ground\" && name !== \"blend_roof\") {\r\n\t\t\t\t\t\tthis.paintLayer(canvas, drawingLayer, tileOffsetX, tileOffsetY);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (name === \"2_object\") {\r\n\t\t\t\t\t\tthis.drawEntities();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.drawEntitiesTop();\r\n\t\t\t\tthis.drawTextSprites();\r\n\t\t\t}\r\n\t\t}\r\n\t\tsetTimeout(function() {\r\n\t\t\tstendhal.ui.gamewindow.draw.apply(stendhal.ui.gamewindow, arguments);\r\n\t\t}, Math.max((1000/20) - (new Date().getTime()-startTime), 1));\r\n\r\n\t},\r\n\r\n\tpaintLayer: function(canvas, drawingLayer, tileOffsetX, tileOffsetY) {\r\n\t\tconst layer = stendhal.data.map.layers[drawingLayer];\r\n\t\tconst yMax = Math.min(tileOffsetY + canvas.height / this.targetTileHeight + 1, stendhal.data.map.zoneSizeY);\r\n\t\tconst xMax = Math.min(tileOffsetX + canvas.width / this.targetTileWidth + 1, stendhal.data.map.zoneSizeX);\r\n\r\n\t\tfor (let y = tileOffsetY; y < yMax; y++) {\r\n\t\t\tfor (let x = tileOffsetX; x < xMax; x++) {\r\n\t\t\t\tlet gid = layer[y * stendhal.data.map.zoneSizeX + x];\r\n\t\t\t\tconst flip = gid & 0xE0000000;\r\n\t\t\t\tgid &= 0x1FFFFFFF;\r\n\r\n\t\t\t\tif (gid > 0) {\r\n\t\t\t\t\tconst tileset = stendhal.data.map.getTilesetForGid(gid);\r\n\t\t\t\t\tconst base = stendhal.data.map.firstgids[tileset];\r\n\t\t\t\t\tconst idx = gid - base;\r\n\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\tif (stendhal.data.map.aImages[tileset].height > 0) {\r\n\t\t\t\t\t\t\tthis.drawTile(stendhal.data.map.aImages[tileset], idx, x, y, flip);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} catch (e) {\r\n\t\t\t\t\t\tconsole.error(e);\r\n\t\t\t\t\t\tthis.drawingError = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\tdrawTile: function(tileset, idx, x, y, flip = 0) {\r\n\t\tconst tilesetWidth = tileset.width;\r\n\t\tconst tilesPerRow = Math.floor(tilesetWidth / stendhal.data.map.tileWidth);\r\n\t\tconst pixelX = x * this.targetTileWidth;\r\n\t\tconst pixelY = y * this.targetTileHeight;\r\n\r\n\t\tif (flip === 0) {\r\n\t\t\tthis.ctx.drawImage(tileset,\r\n\t\t\t\t\t(idx % tilesPerRow) * stendhal.data.map.tileWidth,\r\n\t\t\t\t\tMath.floor(idx / tilesPerRow) * stendhal.data.map.tileHeight,\r\n\t\t\t\t\tstendhal.data.map.tileWidth, stendhal.data.map.tileHeight,\r\n\t\t\t\t\tpixelX, pixelY,\r\n\t\t\t\t\tthis.targetTileWidth, this.targetTileHeight);\r\n\t\t} else {\r\n\t\t\tconst ctx = this.ctx;\r\n\t\t\tctx.translate(pixelX, pixelY);\r\n\t\t\t// an ugly hack to restore the previous transformation matrix\r\n\t\t\tconst restore = [[1, 0, 0, 1, -pixelX, -pixelY]];\r\n\r\n\t\t\tif ((flip & 0x80000000) !== 0) {\r\n\t\t\t\t// flip horizontally\r\n\t\t\t\tctx.transform(-1, 0, 0, 1, 0, 0);\r\n\t\t\t\tctx.translate(-this.targetTileWidth, 0);\r\n\r\n\t\t\t\trestore.push([-1, 0, 0, 1, 0, 0]);\r\n\t\t\t\trestore.push([1, 0, 0, 1, this.targetTileWidth, 0]);\r\n\t\t\t}\r\n\t\t\tif ((flip & 0x40000000) !== 0) {\r\n\t\t\t\t// flip vertically\r\n\t\t\t\tctx.transform(1, 0, 0, -1, 0, 0);\r\n\t\t\t\tctx.translate(0, -this.targetTileWidth);\r\n\r\n\t\t\t\trestore.push([1, 0, 0, -1, 0, 0]);\r\n\t\t\t\trestore.push([1, 0, 0, 1, 0, this.targetTileHeight]);\r\n\t\t\t}\r\n\t\t\tif ((flip & 0x20000000) !== 0) {\r\n\t\t\t\t// Coordinate swap\r\n\t\t\t\tctx.transform(0, 1, 1, 0, 0, 0);\r\n\t\t\t\trestore.push([0, 1, 1, 0, 0, 0]);\r\n\t\t\t}\r\n\r\n\t\t\tthis.drawTile(tileset, idx, 0, 0);\r\n\r\n\t\t\trestore.reverse();\r\n\t\t\tfor (const args of restore) {\r\n\t\t\t\tctx.transform.apply(ctx, args);\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\tdrawEntities: function() {\r\n\t\tvar currentTime = new Date().getTime();\r\n\t\tvar time = currentTime - this.timeStamp;\r\n\t\tthis.timeStamp = currentTime;\r\n\t\tfor (var i in stendhal.zone.entities) {\r\n\t\t\tvar entity = stendhal.zone.entities[i];\r\n\t\t\tif (typeof(entity.draw) != \"undefined\") {\r\n\t\t\t\tentity.updatePosition(time);\r\n\t\t\t\tentity.draw(this.ctx);\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\tdrawEntitiesTop: function() {\r\n\t\tvar i;\r\n\t\tfor (i in stendhal.zone.entities) {\r\n\t\t\tif (typeof(stendhal.zone.entities[i].drawTop) != \"undefined\") {\r\n\t\t\t\tstendhal.zone.entities[i].drawTop(this.ctx);\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\tdrawTextSprites: function(ctx) {\r\n\t\tfor (var i = 0; i < this.textSprites.length; i++) {\r\n\t\t\tvar sprite = this.textSprites[i];\r\n\t\t\tvar remove = sprite.draw(this.ctx);\r\n\t\t\tif (remove) {\r\n\t\t\t\tthis.textSprites.splice(i, 1);\r\n\t\t\t\ti--;\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\tadjustView: function(canvas) {\r\n\t\t// IE does not support ctx.resetTransform(), so use the following workaround:\r\n\t\tthis.ctx.setTransform(1, 0, 0, 1, 0, 0);\r\n\r\n\t\t// Coordinates for a screen centered on player\r\n\t\tvar centerX = marauroa.me[\"_x\"] * this.targetTileWidth + this.targetTileWidth / 2 - canvas.width / 2;\r\n\t\tvar centerY = marauroa.me[\"_y\"] * this.targetTileHeight + this.targetTileHeight / 2 - canvas.height / 2;\r\n\r\n\t\t// Keep the world within the screen view\r\n\t\tcenterX = Math.min(centerX, stendhal.data.map.zoneSizeX * this.targetTileWidth - canvas.width);\r\n\t\tcenterX = Math.max(centerX, 0);\r\n\r\n\t\tcenterY = Math.min(centerY, stendhal.data.map.zoneSizeY * this.targetTileHeight - canvas.height);\r\n\t\tcenterY = Math.max(centerY, 0);\r\n\r\n\t\tthis.offsetX = Math.round(centerX);\r\n\t\tthis.offsetY = Math.round(centerY);\r\n\t\tthis.ctx.translate(-this.offsetX, -this.offsetY);\r\n\t},\r\n\r\n\taddTextSprite: function(sprite) {\r\n\t\tthis.textSprites.push(sprite);\r\n\t},\r\n\r\n\t// Mouse click handling\r\n\tonMouseDown: (function() {\r\n\t\tvar entity;\r\n\t\tvar startX;\r\n\t\tvar startY;\r\n\r\n\t\tfunction _onMouseDown(e) {\r\n\t\t\tvar pos = stendhal.ui.html.extractPosition(e);\r\n\t\t\tif (stendhal.ui.globalpopup) {\r\n\t\t\t\tstendhal.ui.globalpopup.close();\r\n\t\t\t}\r\n\r\n\t\t\tstartX = pos.offsetX;\r\n\t\t\tstartY = pos.offsetY;\r\n\r\n\t\t\tvar x = pos.offsetX + stendhal.ui.gamewindow.offsetX;\r\n\t\t\tvar y = pos.offsetY + stendhal.ui.gamewindow.offsetY;\r\n\t\t\tentity = stendhal.zone.entityAt(x, y);\r\n\t\t\tstendhal.ui.timestampMouseDown = +new Date();\r\n\r\n\t\t\tif (e.type !== \"dblclick\") {\r\n\t\t\t\te.target.addEventListener(\"mousemove\", onDrag);\r\n\t\t\t\te.target.addEventListener(\"mouseup\", onMouseUp);\r\n\t\t\t\te.target.addEventListener(\"touchmove\", onDrag);\r\n\t\t\t\te.target.addEventListener(\"touchend\", onMouseUp);\r\n\t\t\t} else if (entity == stendhal.zone.ground) {\r\n\t\t\t\tentity.onclick(pos.offsetX, pos.offsetY, true);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tfunction isRightClick(e) {\r\n\t\t\tif (+new Date() - stendhal.ui.timestampMouseDown > 300) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\tif (e.which) {\r\n\t\t\t\treturn (e.which === 3);\r\n\t\t\t} else {\r\n\t\t\t\treturn (e.button === 2);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tfunction onMouseUp(e) {\r\n\t\t\tvar pos = stendhal.ui.html.extractPosition(e);\r\n\t\t\tif (isRightClick(e)) {\r\n\t\t\t\tif (entity != stendhal.zone.ground) {\r\n\t\t\t\t\tnew stendhal.ui.Menu(entity, pos.pageX - 50, pos.pageY - 5);\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tentity.onclick(pos.offsetX, pos.offsetY);\r\n\t\t\t}\r\n\t\t\tcleanUp(pos);\r\n\t\t\tpos.target.focus();\r\n\t\t\te.preventDefault();\r\n\t\t}\r\n\r\n\t\tfunction onDrag(e) {\r\n\t\t\tvar pos = stendhal.ui.html.extractPosition(e);\r\n\t\t\tvar xDiff = startX - pos.offsetX;\r\n\t\t\tvar yDiff = startY - pos.offsetY;\r\n\t\t\t// It's not really a click if the mouse has moved too much.\r\n\t\t\tif (xDiff * xDiff + yDiff * yDiff > 5) {\r\n\t\t\t\tcleanUp(e);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tfunction cleanUp(e) {\r\n\t\t\tentity = null;\r\n\t\t\te.target.removeEventListener(\"mouseup\", onMouseUp);\r\n\t\t\te.target.removeEventListener(\"mousemove\", onDrag);\r\n\t\t\te.target.removeEventListener(\"touchend\", onMouseUp);\r\n\t\t\te.target.removeEventListener(\"touchmove\", onDrag);\r\n\t\t}\r\n\r\n\t\treturn _onMouseDown;\r\n\t})(),\r\n\r\n\tonMouseMove: function(e) {\r\n\t\tvar pos = stendhal.ui.html.extractPosition(e);\r\n\t\tvar x = pos.offsetX + stendhal.ui.gamewindow.offsetX;\r\n\t\tvar y = pos.offsetY + stendhal.ui.gamewindow.offsetY;\r\n\t\tvar entity = stendhal.zone.entityAt(x, y);\r\n\t\tdocument.getElementById(\"gamewindow\").style.cursor = entity.getCursor(x, y);\r\n\t},\r\n\r\n\t// ***************** Drag and drop ******************\r\n\tonDragStart: function(e) {\r\n\t\tvar pos = stendhal.ui.html.extractPosition(e);\r\n\t\tvar draggedEntity = stendhal.zone.entityAt(pos.offsetX + stendhal.ui.gamewindow.offsetX,\r\n\t\t\t\tpos.offsetY + stendhal.ui.gamewindow.offsetY);\r\n\r\n\t\tvar img = undefined;\r\n\t\tif (draggedEntity.type === \"item\") {\r\n\t\t\timg = stendhal.data.sprites.getAreaOf(stendhal.data.sprites.get(draggedEntity.sprite.filename), 32, 32);\r\n\t\t} else if (draggedEntity.type === \"corpse\") {\r\n\t\t\timg = stendhal.data.sprites.get(draggedEntity.sprite.filename);\r\n\t\t} else {\r\n\t\t\te.preventDefault();\r\n\t\t\treturn;\r\n\t\t}\r\n\t\twindow.event = e; // required by setDragImage polyfil\r\n\t\te.dataTransfer.setDragImage(img, 0, 0);\r\n\t\te.dataTransfer.setData(\"Text\", JSON.stringify({\r\n\t\t\tpath: draggedEntity.getIdPath(),\r\n\t\t\tzone: marauroa.currentZoneName\r\n\t\t}));\r\n\t},\r\n\r\n\tonDragOver: function(e) {\r\n\t\te.preventDefault(); // Necessary. Allows us to drop.\r\n\t\te.dataTransfer.dropEffect = \"move\";\r\n\t\treturn false;\r\n\t},\r\n\r\n\tonDrop: function(e) {\r\n\t\tvar pos = stendhal.ui.html.extractPosition(e);\r\n\t\tvar datastr = e.dataTransfer.getData(\"Text\") || e.dataTransfer.getData(\"text/x-stendhal\");\r\n\t\tif (datastr) {\r\n\t\t\tvar data = JSON.parse(datastr);\r\n\t\t\tvar action = {\r\n\t\t\t\t\"x\": Math.floor((pos.offsetX + stendhal.ui.gamewindow.offsetX) / 32).toString(),\r\n\t\t\t\t\"y\": Math.floor((pos.offsetY + stendhal.ui.gamewindow.offsetY) / 32).toString(),\r\n\t\t\t\t\"zone\" : data.zone\r\n\t\t\t};\r\n\t\t\tvar id = data.path.substr(1, data.path.length - 2);\r\n\t\t\tvar drop = /\\t/.test(id);\r\n\t\t\tif (drop) {\r\n\t\t\t\taction[\"type\"] = \"drop\";\r\n\t\t\t\taction[\"source_path\"] = data.path;\r\n\t\t\t} else {\r\n\t\t\t\taction[\"type\"] = \"displace\";\r\n\t\t\t\taction[\"baseitem\"] = id;\r\n\t\t\t}\r\n\r\n\t\t\t// if ctrl is pressed, we ask for the quantity\r\n\t\t\tif (e.ctrlKey) {\r\n\t\t\t\tnew stendhal.ui.DropNumberDialog(action, pos.pageX - 50, pos.pageY - 25);\r\n\t\t\t} else {\r\n\t\t\t\tmarauroa.clientFramework.sendAction(action);\r\n\t\t\t}\r\n\t\t}\r\n\t\te.stopPropagation();\r\n\t\te.preventDefault();\r\n\t},\r\n\r\n\tonContentMenu: function(e) {\r\n\t\te.preventDefault();\r\n\t}\r\n\r\n};\r\n","/***************************************************************************\r\n *                   (C) Copyright 2003-2017 - Stendhal                    *\r\n ***************************************************************************\r\n *                                                                         *\r\n *   This program is free software; you can redistribute it and/or modify  *\r\n *   it under the terms of the GNU Affero General Public License as        *\r\n *   published by the Free Software Foundation; either version 3 of the    *\r\n *   License, or (at your option) any later version.                       *\r\n *                                                                         *\r\n ***************************************************************************/\r\n\r\n\"use strict\";\r\n\r\nvar stendhal = window.stendhal = window.stendhal || {};\r\nstendhal.ui = stendhal.ui || {};\r\n\r\n/**\r\n * HTML code manipulation.\r\n */\r\nstendhal.ui.html = {\r\n\tesc: function(msg){\r\n\t\treturn msg.replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/\"/g, '&quot;').replace(/\\n/g, \"<br>\");\r\n\t},\r\n\r\n\textractKeyCode: function(event) {\r\n\t\tif (event.which) {\r\n\t\t\treturn event.which;\r\n\t\t} else {\r\n\t\t\treturn e.keyCode;\r\n\t\t}\r\n\t},\r\n\r\n\tniceName: function(s) {\r\n\t\tif (!s) {\r\n\t\t\treturn \"\";\r\n\t\t}\r\n\t\tlet temp = s.replace(/_/g, \" \").trim();\r\n\t\treturn temp.charAt(0).toUpperCase() + temp.slice(1);\r\n\t},\r\n\r\n\textractPosition: function(event) {\r\n\t\tif (event.changedTouches) {\r\n\t\t\tvar pos = {\r\n\t\t\t\tpageX: Math.round(event.changedTouches[0].pageX),\r\n\t\t\t\tpageY: Math.round(event.changedTouches[0].pageY),\r\n\t\t\t\ttarget: event.changedTouches[0].target\r\n\t\t\t}\r\n\t\t\tpos.offsetX = pos.pageX - event.changedTouches[0].target.offsetLeft;\r\n\t\t\tpos.offsetY = pos.pageY - event.changedTouches[0].target.offsetTop;\r\n\t\t\treturn pos;\r\n\t\t}\r\n\t\treturn event;\r\n\t}\r\n};\r\n","/***************************************************************************\r\n *                   (C) Copyright 2003-2021 - Stendhal                    *\r\n ***************************************************************************\r\n *                                                                         *\r\n *   This program is free software; you can redistribute it and/or modify  *\r\n *   it under the terms of the GNU Affero General Public License as        *\r\n *   published by the Free Software Foundation; either version 3 of the    *\r\n *   License, or (at your option) any later version.                       *\r\n *                                                                         *\r\n ***************************************************************************/\r\n\r\n\"use strict\";\r\n\r\nvar marauroa = window.marauroa = window.marauroa || {};\r\nvar stendhal = window.stendhal = window.stendhal || {};\r\nstendhal.ui = stendhal.ui || {};\r\n\r\n/**\r\n * mini map\r\n */\r\nstendhal.ui.minimap = {\r\n\r\n\twidth: 128,\r\n\theight: 128,\r\n\ttitleHeight: 15,\r\n\tminimumScale: 2,\r\n\r\n\tzoneChange: function() {\r\n\t\tstendhal.ui.minimap.mapWidth = stendhal.data.map.zoneSizeX;\r\n\t\tstendhal.ui.minimap.mapHeight = stendhal.data.map.zoneSizeY;\r\n\t\tstendhal.ui.minimap.scale = Math.max(stendhal.ui.minimap.minimumScale, Math.min(stendhal.ui.minimap.height / stendhal.ui.minimap.mapHeight, stendhal.ui.minimap.width / stendhal.ui.minimap.mapWidth));\r\n\t\tstendhal.ui.minimap.createBackgroundImage();\r\n\t},\r\n\r\n\tupdateBasePosition: function() {\r\n\t\tif (!marauroa.me)\r\n\t\t{\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tstendhal.ui.minimap.xOffset = 0;\r\n\t\tstendhal.ui.minimap.yOffset = 0;\r\n\r\n\t\tvar imageWidth = stendhal.ui.minimap.mapWidth * stendhal.ui.minimap.scale;\r\n\t\tvar imageHeight = stendhal.ui.minimap.mapHeight * stendhal.ui.minimap.scale;\r\n\r\n\t\tvar xpos = Math.round((marauroa.me[\"x\"] * stendhal.ui.minimap.scale) + 0.5) - stendhal.ui.minimap.width / 2;\r\n\t\tvar ypos = Math.round((marauroa.me[\"y\"] * stendhal.ui.minimap.scale) + 0.5) - stendhal.ui.minimap.width / 2;\r\n\r\n\t\tif (imageWidth > stendhal.ui.minimap.width) {\r\n\t\t\t// need to pan width\r\n\t\t\tif ((xpos + stendhal.ui.minimap.width) > imageWidth) {\r\n\t\t\t\t// x is at the screen border\r\n\t\t\t\tstendhal.ui.minimap.xOffset = imageWidth - stendhal.ui.minimap.width;\r\n\t\t\t} else if (xpos > 0) {\r\n\t\t\t\tstendhal.ui.minimap.xOffset = xpos;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (imageHeight > stendhal.ui.minimap.height) {\r\n\t\t\t// need to pan height\r\n\t\t\tif ((ypos + stendhal.ui.minimap.height) > imageHeight) {\r\n\t\t\t\t// y is at the screen border\r\n\t\t\t\tstendhal.ui.minimap.yOffset = imageHeight - stendhal.ui.minimap.height;\r\n\t\t\t} else if (ypos > 0) {\r\n\t\t\t\tstendhal.ui.minimap.yOffset = ypos;\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\tdraw: function() {\r\n\t\tif (marauroa.currentZoneName === stendhal.data.map.currentZoneName\r\n\t\t\t|| stendhal.data.map.currentZoneName === \"int_vault\"\r\n\t\t\t|| stendhal.data.map.currentZoneName === \"int_adventure_island\") {\r\n\r\n\t\t\tstendhal.ui.minimap.scale = 10;\r\n\r\n\t\t\tstendhal.ui.minimap.zoneChange();\r\n\t\t\tstendhal.ui.minimap.updateBasePosition();\r\n\t\t\tvar canvas = document.getElementById(\"minimap\");\r\n\r\n\t\t\tvar ctx = canvas.getContext(\"2d\");\r\n\t\t\t// IE does not support ctx.resetTransform(), so use the following workaround:\r\n\t\t\tctx.setTransform(1, 0, 0, 1, 0, 0);\r\n\r\n\t\t\t// The area outside of the map\r\n\t\t\tctx.fillStyle = \"#606060\";\r\n\t\t\tctx.fillRect(0, 0, stendhal.ui.minimap.width, stendhal.ui.minimap.height);\r\n\r\n\t\t\tctx.translate(Math.round(-stendhal.ui.minimap.xOffset), Math.round(-stendhal.ui.minimap.yOffset));\r\n\t\t\tstendhal.ui.minimap.drawBackground(ctx);\r\n\t\t\tstendhal.ui.minimap.drawEntities(ctx);\r\n\t\t}\r\n\t},\r\n\r\n\tdrawBackground: function(ctx) {\r\n\t\tctx.save();\r\n\t\t// imageSmoothingEnabled is the standard property but browsers haven't\r\n\t\t// yet caught up\r\n\t\tctx.imageSmoothingEnabled = false;\r\n\t\tctx.mozImageSmoothingEnabled = false;\r\n\t\tctx.msImageSmoothingEnabled = false;\r\n\r\n\t\tctx.scale(stendhal.ui.minimap.scale, stendhal.ui.minimap.scale);\r\n\t\tif (stendhal.ui.minimap.bgImage) {\r\n\t\t\tctx.drawImage(stendhal.ui.minimap.bgImage, 0, 0);\r\n\t\t}\r\n\t\tctx.restore();\r\n\t},\r\n\r\n\tcreateBackgroundImage: function() {\r\n\t\tvar width = stendhal.ui.minimap.mapWidth;\r\n\t\tvar height = stendhal.ui.minimap.mapHeight;\r\n\t\tif (width <= 0 || height <= 0) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (stendhal.data.map.collisionData !== stendhal.ui.minimap.lastZone) {\r\n\t\t\tstendhal.ui.minimap.lastZone = stendhal.data.map.collisionData;\r\n\t\t\tstendhal.ui.minimap.bgImage = document.createElement(\"canvas\");\r\n\t\t\tvar ctx = stendhal.ui.minimap.bgImage.getContext(\"2d\");\r\n\t\t\tvar imgData = ctx.createImageData(width, height);\r\n\r\n\t\t\tfor (var y = 0; y < height; y++) {\r\n\t\t\t\tfor (var x = 0; x < width; x++) {\r\n\t\t\t\t\t// RGBA array. Find the actual position\r\n\t\t\t\t\tvar pos = 4 * (y * width + x);\r\n\t\t\t\t\tif (stendhal.data.map.collision(x, y)) {\r\n\t\t\t\t\t\t// red collision\r\n\t\t\t\t\t\timgData.data[pos] = 255;\r\n\t\t\t\t\t} else if (stendhal.data.map.isProtected(x, y)) {\r\n\t\t\t\t\t\t// light green for protection\r\n\t\t\t\t\t\timgData.data[pos] = 202;\r\n\t\t\t\t\t\timgData.data[pos + 1] = 230;\r\n\t\t\t\t\t\timgData.data[pos + 2] = 202;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t// light gray elsewhere\r\n\t\t\t\t\t\timgData.data[pos] = 224;\r\n\t\t\t\t\t\timgData.data[pos + 1] = 224;\r\n\t\t\t\t\t\timgData.data[pos + 2] = 224;\r\n\t\t\t\t\t}\r\n\t\t\t\t\timgData.data[pos + 3] = 255;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tstendhal.ui.minimap.bgImage.width  = width;\r\n\t\t\tstendhal.ui.minimap.bgImage.height = height;\r\n\r\n\t\t\tctx.putImageData(imgData, 0, 0);\r\n\t\t}\r\n\t},\r\n\r\n\tdrawEntities: function(ctx) {\r\n\t\tctx.fillStyle = \"rgb(255,0,0)\";\r\n\t\tctx.strokeStyle = \"rgb(0,0,0)\";\r\n\r\n\t\tfor (var i in marauroa.currentZone) {\r\n\t\t\tvar o = marauroa.currentZone[i];\r\n\t\t\tif (typeof(o[\"x\"]) != \"undefined\" && typeof(o[\"y\"]) != \"undefined\" && (o.minimapShow || (marauroa.me[\"adminlevel\"] && marauroa.me[\"adminlevel\"] >= 600))) {\r\n\t\t\t\t// not supported by IE <= 8\r\n\t\t\t\tif (typeof(ctx.fillText) != \"undefined\") {\r\n//\t\t\t\t\tstendhal.ui.minimap.ctx.fillText(o.id, o.x * stendhal.ui.minimap.scale, o.y * stendhal.ui.minimap.scale);\r\n\t\t\t\t}\r\n\t\t\t\tif (typeof(o.minimapStyle) != \"undefined\") {\r\n\t\t\t\t\tctx.strokeStyle = o.minimapStyle;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tctx.strokeStyle = \"rgb(128, 128, 128)\";\r\n\t\t\t\t}\r\n\t\t\t\tctx.strokeRect(o[\"x\"] * stendhal.ui.minimap.scale, o[\"y\"] * stendhal.ui.minimap.scale, o[\"width\"] * stendhal.ui.minimap.scale, o[\"height\"] * stendhal.ui.minimap.scale);\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\tonClick: function(e) {\r\n\t\tvar x = Math.floor((e.offsetX + stendhal.ui.minimap.xOffset) / stendhal.ui.minimap.scale);\r\n\t\tvar y = Math.floor((e.offsetY + stendhal.ui.minimap.yOffset) / stendhal.ui.minimap.scale);\r\n\t\tif (!stendhal.data.map.collision(x, y)) {\r\n\t\t\tvar action = {\r\n\t\t\t\t\ttype: \"moveto\",\r\n\t\t\t\t\tx: x.toString(),\r\n\t\t\t\t\ty: y.toString()\r\n\t\t\t};\r\n\r\n\t\t\tif (\"type\" in e && e[\"type\"] === \"dblclick\") {\r\n\t\t\t\taction[\"double_click\"] = \"\";\r\n\t\t\t}\r\n\r\n\t\t\tmarauroa.clientFramework.sendAction(action);\r\n\t\t}\r\n\t}\r\n};\r\n","/***************************************************************************\r\n *                   (C) Copyright 2003-2019 - Stendhal                    *\r\n ***************************************************************************\r\n *                                                                         *\r\n *   This program is free software; you can redistribute it and/or modify  *\r\n *   it under the terms of the GNU Affero General Public License as        *\r\n *   published by the Free Software Foundation; either version 3 of the    *\r\n *   License, or (at your option) any later version.                       *\r\n *                                                                         *\r\n ***************************************************************************/\r\n\r\n\r\n\"use strict\";\r\n\r\nvar marauroa = window.marauroa = window.marauroa || {};\r\nvar stendhal = window.stendhal = window.stendhal || {};\r\nstendhal.ui = stendhal.ui || {};\r\n\r\n/**\r\n * handling of key presses and releases\r\n */\r\nstendhal.ui.keyhandler = {\r\n\tpressedKeys: [],\r\n\r\n\textractMoveOrFaceActionFromEvent: function(event) {\r\n\t\tif (event.shiftKey) {\r\n\t\t\treturn \"face\";\r\n\t\t}\r\n\t\treturn \"move\";\r\n\t},\r\n\r\n\textractDirectionFromKeyCode: function(code) {\r\n\t\tvar dir = code - 37;\r\n\t\tif (dir === 0) {\r\n\t\t\tdir = 4;\r\n\t\t}\r\n\t\treturn dir;\r\n\t},\r\n\r\n\r\n\tonKeyDown: function(e) {\r\n\t\tvar event = e;\r\n\t\tif (!event) {\r\n\t\t\tevent = window.event;\r\n\t\t}\r\n\t\tvar code = stendhal.ui.html.extractKeyCode(event);\r\n\r\n\t\tif (code >= 37 && code <= 40) {\r\n\t\t\t// if this is a repeated event, stop further processing\r\n\t\t\tif (stendhal.ui.keyhandler.pressedKeys.indexOf(code) > -1) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tstendhal.ui.keyhandler.pressedKeys.push(code);\r\n\r\n\t\t\tvar type = stendhal.ui.keyhandler.extractMoveOrFaceActionFromEvent(event);\r\n\t\t\tvar dir = stendhal.ui.keyhandler.extractDirectionFromKeyCode(code);\r\n\t\t\tvar action = {\"type\": type, \"dir\": \"\"+dir};\r\n\t\t\tmarauroa.clientFramework.sendAction(action);\r\n\t\t} else {\r\n\t\t\t// move focus to chat-input on keydown\r\n\t\t\t// but don't do that for Ctrl+C, etc.\r\n\t\t\tif (!event.altKey && !event.metaKey && !event.ctrlKey && event.key !== \"Control\") {\r\n\t\t\t\tif (document.activeElement.localName !== \"input\") {\r\n\t\t\t\t\tdocument.getElementById(\"chatinput\").focus();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\tonKeyUp: function(e) {\r\n\t\tvar event = e\r\n\t\tif (!event) {\r\n\t\t\tevent = window.event;\r\n\t\t}\r\n\t\tvar code = stendhal.ui.html.extractKeyCode(event);\r\n\r\n\t\tif (code >= 37 && code <= 40) {\r\n\t\t\tvar code = stendhal.ui.html.extractKeyCode(event);\r\n\t\t\tvar i = stendhal.ui.keyhandler.pressedKeys.indexOf(code);\r\n\t\t\tif (i > -1) {\r\n\t\t\t\tstendhal.ui.keyhandler.pressedKeys.splice(i, 1);\r\n\t\t\t}\r\n\r\n\t\t\tvar action = {\"type\": \"stop\"};\r\n\t\t\tmarauroa.clientFramework.sendAction(action);\r\n\r\n\t\t\tif (stendhal.ui.keyhandler.pressedKeys.length > 0) {\r\n\t\t\t\tcode = stendhal.ui.keyhandler.pressedKeys[0];\r\n\t\t\t\tvar type = stendhal.ui.keyhandler.extractMoveOrFaceActionFromEvent(event);\r\n\t\t\t\tvar dir = stendhal.ui.keyhandler.extractDirectionFromKeyCode(code);\r\n\t\t\t\tvar action = {\"type\": type, \"dir\": \"\"+dir};\r\n\t\t\t\tmarauroa.clientFramework.sendAction(action);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n","/***************************************************************************\r\n *                   (C) Copyright 2003-2017 - Stendhal                    *\r\n ***************************************************************************\r\n *                                                                         *\r\n *   This program is free software; you can redistribute it and/or modify  *\r\n *   it under the terms of the GNU Affero General Public License as        *\r\n *   published by the Free Software Foundation; either version 3 of the    *\r\n *   License, or (at your option) any later version.                       *\r\n *                                                                         *\r\n ***************************************************************************/\r\n\r\n\"use strict\";\r\n\r\nvar stendhal = window.stendhal = window.stendhal || {};\r\nstendhal.ui = stendhal.ui || {};\r\n\r\nstendhal.ui.sound = {\r\n\tlayers: [\"music\", \"ambient\", \"creature\", \"sfx\", \"gui\"],\r\n\r\n\tplayLocalizedEffect: function(x, y, radius, layer, soundName, volume) {\r\n\t\tif (!stendhal.config.sound.play) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// Further adjustments if the sound has a radius\r\n\t\tif (radius) {\r\n\t\t\tif (!marauroa.me || !x) {\r\n\t\t\t\t// Can't calculate the distance yet. Ignore the sound.\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tvar xdist = marauroa.me[\"_x\"] - x;\r\n\t\t\tvar ydist = marauroa.me[\"_y\"] - y;\r\n\t\t\tvar dist2 = xdist * xdist + ydist * ydist;\r\n\t\t\tif (dist2 > radius * radius) {\r\n\t\t\t\t// Outside the specified radius\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t// The sound api does not guarantee anything about how the volume\r\n\t\t\t// works, so it does not matter much how we scale it.\r\n\t\t\tvolume *= Math.min(radius * radius / (dist2 * 20), 1);\r\n\t\t}\r\n\r\n\t\tvar sound = new Audio();\r\n\t\tsound.autoplay = true;\r\n\t\tsound.volume = volume;\r\n\t\tsound.src = \"/data/sounds/\" + soundName + \".ogg\";\r\n\t},\r\n\r\n\tplayGlobalizedEffect: function(soundName, volume) {\r\n\t\tif (!stendhal.config.sound.play) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst sound = new Audio(\"/data/sounds/\" + soundName + \".ogg\");\r\n\t\tif (volume != null) {\r\n\t\t\tsound.volume = volume;\r\n\t\t}\r\n\t\tsound.autoplay = true;\r\n\t}\r\n};\r\n","/***************************************************************************\r\n *                   (C) Copyright 2003-2017 - Stendhal                    *\r\n ***************************************************************************\r\n *                                                                         *\r\n *   This program is free software; you can redistribute it and/or modify  *\r\n *   it under the terms of the GNU Affero General Public License as        *\r\n *   published by the Free Software Foundation; either version 3 of the    *\r\n *   License, or (at your option) any later version.                       *\r\n *                                                                         *\r\n ***************************************************************************/\r\n\r\n\"use strict\";\r\n\r\nvar marauroa = window.marauroa = window.marauroa || {};\r\nvar stendhal = window.stendhal = window.stendhal || {};\r\nstendhal.ui = stendhal.ui || {};\r\n\r\n/**\r\n * buddylist\r\n */\r\nstendhal.ui.stats = {\r\n\tkeys: ['hp', 'base_hp', 'atk', 'atk_item', 'atk_xp', 'def', 'def_item', 'def_xp', 'xp', 'level'],\r\n\r\n\tupdate: function() {\r\n\t\tif (!stendhal.ui.stats.dirty) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tstendhal.ui.stats.dirty = false;\r\n\t\tvar div = document.getElementById(\"stats\");\r\n\t\tvar object = marauroa.me;\r\n\t\tdiv.innerText =\r\n\t\t\t\"HP: \" + object[\"hp\"] + \" / \" + object[\"base_hp\"] + \"\\r\\n\"\r\n\t\t\t+ \"ATK: \" + object[\"atk\"] + \" x \" + object[\"atk_item\"] + \"\\r\\n\"\r\n\t\t\t+ \"DEF: \" + object[\"def\"] + \" x \" + object[\"def_item\"] + \"\\r\\n\"\r\n\t\t\t+ \"XP: \" + object[\"xp\"] + \"\\r\\n\"\r\n\t\t\t+ \"Level: \" + object[\"level\"];\r\n\t}\r\n};\r\n","/***************************************************************************\r\n *                   (C) Copyright 2003-2017 - Stendhal                    *\r\n ***************************************************************************\r\n *                                                                         *\r\n *   This program is free software; you can redistribute it and/or modify  *\r\n *   it under the terms of the GNU Affero General Public License as        *\r\n *   published by the Free Software Foundation; either version 3 of the    *\r\n *   License, or (at your option) any later version.                       *\r\n *                                                                         *\r\n ***************************************************************************/\r\n\r\n\"use strict\";\r\n\r\nvar marauroa = window.marauroa = window.marauroa || {};\r\nvar stendhal = window.stendhal = window.stendhal || {};\r\nstendhal.ui = stendhal.ui || {};\r\n\r\nstendhal.ui.chatinput = {\r\n\thistory: [],\r\n\thistoryIndex: 0,\r\n\r\n\tclear: function() {\r\n\t\tdocument.getElementById(\"chatinput\").value = \"\";\r\n\t},\r\n\r\n\tsetText: function(text) {\r\n\t\tvar chatinput = document.getElementById(\"chatinput\");\r\n\t\tchatinput.value = text;\r\n\t\tchatinput.focus();\r\n\t},\r\n\r\n\tfromHistory: function(i) {\r\n\t\tstendhal.ui.chatinput.historyIndex = stendhal.ui.chatinput.historyIndex + i;\r\n\t\tif (stendhal.ui.chatinput.historyIndex < 0) {\r\n\t\t\tstendhal.ui.chatinput.historyIndex = 0;\r\n\t\t}\r\n\t\tif (stendhal.ui.chatinput.historyIndex >= stendhal.ui.chatinput.history.length) {\r\n\t\t\tstendhal.ui.chatinput.historyIndex = stendhal.ui.chatinput.history.length;\r\n\t\t\tstendhal.ui.chatinput.clear();\r\n\t\t} else {\r\n\t\t\tdocument.getElementById(\"chatinput\").value = stendhal.ui.chatinput.history[stendhal.ui.chatinput.historyIndex];\r\n\t\t}\r\n\t},\r\n\r\n\tonKeyDown: function(e) {\r\n\t\tvar event = e;\r\n\t\tif (!event) {\r\n\t\t\tevent = window.event;\r\n\t\t}\r\n\t\tvar code = stendhal.ui.html.extractKeyCode(event);\r\n\r\n\t\t// chat history\r\n\t\tif (event.shiftKey) {\r\n\t\t\tif (code === 38) {\r\n\t\t\t\tstendhal.ui.chatinput.fromHistory(-1);\r\n\t\t\t} else if (code === 40){\r\n\t\t\t\tstendhal.ui.chatinput.fromHistory(1);\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\tonKeyPress: function(e) {\r\n\t\tif (e.keyCode === 13) {\r\n\t\t\tstendhal.ui.chatinput.send();\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn true;\r\n\t},\r\n\r\n\tremember: function(text) {\r\n\t\tif (stendhal.ui.chatinput.history.length > 100) {\r\n\t\t\tstendhal.ui.chatinput.history.shift();\r\n\t\t}\r\n\t\tstendhal.ui.chatinput.history[stendhal.ui.chatinput.history.length] = text;\r\n\t\tstendhal.ui.chatinput.historyIndex = stendhal.ui.chatinput.history.length;\r\n\t},\r\n\r\n\tsend: function() {\r\n\t\tvar val = document.getElementById(\"chatinput\").value;\r\n\t\tvar array = val.split(\" \");\r\n\t\tif (array[0] === \"/choosecharacter\") {\r\n\t\t\tmarauroa.clientFramework.chooseCharacter(array[1]);\r\n\t\t} else if (val === '/close') {\r\n\t\t\tmarauroa.clientFramework.close();\r\n\t\t} else {\r\n\t\t\tif (stendhal.slashActionRepository.execute(val)) {\r\n\t\t\t\tstendhal.ui.chatinput.remember(val);\r\n\t\t\t}\r\n\t\t}\r\n\t\tstendhal.ui.chatinput.clear();\r\n\t}\r\n};\r\n","/***************************************************************************\r\n *                   (C) Copyright 2003-2018 - Stendhal                    *\r\n ***************************************************************************\r\n *                                                                         *\r\n *   This program is free software; you can redistribute it and/or modify  *\r\n *   it under the terms of the GNU Affero General Public License as        *\r\n *   published by the Free Software Foundation; either version 3 of the    *\r\n *   License, or (at your option) any later version.                       *\r\n *                                                                         *\r\n ***************************************************************************/\r\n\r\n\"use strict\";\r\n\r\nvar stendhal = window.stendhal = window.stendhal || {};\r\n\r\nstendhal.slashActionRepository = {\r\n\t\"add\": {\r\n\t\texecute: function(type, params, remainder) {\r\n\t\t\tif (params == null) {\r\n\t\t\t\treturn false;\r\n\t\t\t};\r\n\r\n\t\t\tconst action = {\r\n\t\t\t\t\"type\": \"addbuddy\",\r\n\t\t\t\t\"target\": params[0]\r\n\t\t\t};\r\n\r\n\t\t\tmarauroa.clientFramework.sendAction(action);\r\n\t\t\treturn true;\r\n\t\t},\r\n\t\tgetMinParams: 1,\r\n\t\tgetMaxParams: 1\r\n\t},\r\n\r\n\t\"adminnote\": {\r\n\t\texecute: function(type, params, remainder) {\r\n\t\t\tvar action = {\r\n\t\t\t\t\"type\": type,\r\n\t\t\t\t\"target\": params[0],\r\n\t\t\t\t\"note\": remainder\r\n\t\t\t};\r\n\t\t\tmarauroa.clientFramework.sendAction(action);\r\n\t\t\treturn true;\r\n\t\t},\r\n\t\tgetMinParams: 1,\r\n\t\tgetMaxParams: 1\r\n\t},\r\n\r\n\t\"adminlevel\": {\r\n\t\texecute: function(type, params, remainder) {\r\n\t\t\tvar action = {\r\n\t\t\t\t\"type\": type,\r\n\t\t\t\t\"target\": params[0],\r\n\t\t\t};\r\n\t\t\tif (params.length >= 2) {\r\n\t\t\t\taction[\"newlevel\"] = params[1];\r\n\t\t\t}\r\n\t\t\tmarauroa.clientFramework.sendAction(action);\r\n\t\t\treturn true;\r\n\t\t},\r\n\t\tgetMinParams: 1,\r\n\t\tgetMaxParams: 2\r\n\t},\r\n\r\n\t\"alter\": {\r\n\t\texecute: function(type, params, remainder) {\r\n\t\t\tvar action = {\r\n\t\t\t\t\"type\": type,\r\n\t\t\t\t\"target\": params[0],\r\n\t\t\t\t\"stat\": params[1],\r\n\t\t\t\t\"mode\": params[2],\r\n\t\t\t\t\"value\": remainder\r\n\t\t\t};\r\n\t\t\tmarauroa.clientFramework.sendAction(action);\r\n\t\t\treturn true;\r\n\t\t},\r\n\t\tgetMinParams: 3,\r\n\t\tgetMaxParams: 3\r\n\t},\r\n\r\n\t\"altercreature\": {\r\n\t\texecute: function(type, params, remainder) {\r\n\t\t\tconst action = {\r\n\t\t\t\t\"type\": \"altercreature\",\r\n\t\t\t\t\"target\": params[0],\r\n\t\t\t\t\"text\": params[1]\r\n\t\t\t};\r\n\r\n\t\t\tmarauroa.clientFramework.sendAction(action);\r\n\t\t\treturn true;\r\n\t\t},\r\n\t\tgetMinParams: 2,\r\n\t\tgetMaxParams: 2\r\n\t},\r\n\r\n\t\"alterkill\": {\r\n\t\texecute: function(type, params, remainder) {\r\n\t\t\tconst target = params[0];\r\n\t\t\tconst killtype = params[1];\r\n\t\t\tconst count = params[2];\r\n\t\t\tvar creature = null;\r\n\r\n\t\t\tif (remainder != null && remainder != \"\") {\r\n\t\t\t\t// NOTE: unlike Java client, Javascript client automatically trims whitespace in \"remainder\" parameter\r\n\t\t\t\tcreature = remainder;\r\n\t\t\t}\r\n\r\n\t\t\tconst action = {\r\n\t\t\t\t\"type\": \"alterkill\",\r\n\t\t\t\t\"target\": target,\r\n\t\t\t\t\"killtype\": killtype,\r\n\t\t\t\t\"count\": count\r\n\t\t\t};\r\n\t\t\tif (creature != null) {\r\n\t\t\t\taction[\"creature\"] = creature;\r\n\t\t\t}\r\n\r\n\t\t\tmarauroa.clientFramework.sendAction(action);\r\n\t\t\treturn true;\r\n\t\t},\r\n\t\tgetMinParams: 3,\r\n\t\tgetMaxParams: 3\r\n\t},\r\n\r\n\t\"alterquest\": {\r\n\t\texecute: function(type, params, remainder) {\r\n\t\t\tconst action = {\r\n\t\t\t\t\"type\": \"alterquest\",\r\n\t\t\t\t\"target\": params[0],\r\n\t\t\t\t\"name\": params[1]\r\n\t\t\t};\r\n\r\n\t\t\tif (params[2] != null) {\r\n\t\t\t\taction[\"state\"] = params[2];\r\n\t\t\t}\r\n\r\n\t\t\tmarauroa.clientFramework.sendAction(action);\r\n\t\t\treturn true;\r\n\t\t},\r\n\t\tgetMinParams: 2,\r\n\t\tgetMaxParams: 3\r\n\t},\r\n\r\n\t\"answer\": {\r\n\t\texecute: function(type, params, remainder) {\r\n\t\t\tif (remainder == null || remainder == \"\") {\r\n\t\t\t\treturn false;\r\n\t\t\t};\r\n\r\n\t\t\tconst action = {\r\n\t\t\t\t\"type\": \"answer\",\r\n\t\t\t\t\"text\": remainder\r\n\t\t\t};\r\n\r\n\t\t\tmarauroa.clientFramework.sendAction(action);\r\n\t\t\treturn true;\r\n\t\t},\r\n\t\tgetMinParams: 1,\r\n\t\tgetMaxParams: 0\r\n\t},\r\n\r\n\t\"away\": {\r\n\t\texecute: function(type, params, remainder) {\r\n\t\t\tvar msg = null;\r\n\t\t\tif (remainder.length != 0) {\r\n\t\t\t\tmsg = remainder;\r\n\t\t\t};\r\n\r\n\t\t\tvar action = {\r\n\t\t\t\t\"type\": \"away\",\r\n\t\t\t\t\"message\": msg\r\n\t\t\t};\r\n\r\n\t\t\tmarauroa.clientFramework.sendAction(action);\r\n\t\t\treturn true;\r\n\t\t},\r\n\t\tgetMinParams: 0,\r\n\t\tgetMaxParams: 0\r\n\t},\r\n\r\n\t\"ban\": {\r\n\t\texecute: function(type, params, remainder) {\r\n\t\t\tvar action = {\r\n\t\t\t\t\"type\": \"ban\",\r\n\t\t\t\t\"target\": params[0],\r\n\t\t\t\t\"hours\": params[1],\r\n\t\t\t\t\"reason\": remainder\r\n\t\t\t};\r\n\t\t\tmarauroa.clientFramework.sendAction(action);\r\n\t\t\treturn true;\r\n\t\t},\r\n\t\tgetMinParams: 2,\r\n\t\tgetMaxParams: 2\r\n\t},\r\n\r\n\t\"chat\": {\r\n\t\texecute: function(type, params, remainder) {\r\n\t\t\tvar action = {\r\n\t\t\t\t\"type\": type,\r\n\t\t\t\t\"text\": remainder\r\n\t\t\t};\r\n\t\t\tmarauroa.clientFramework.sendAction(action);\r\n\t\t\treturn true;\r\n\t\t},\r\n\t\tgetMinParams: 0,\r\n\t\tgetMaxParams: 0\r\n\t},\r\n\r\n\t\"clear\": {\r\n\t\texecute: function(type, params, remainder) {\r\n\t\t\tstendhal.ui.chatLog.clear();\r\n\t\t\treturn true;\r\n\t\t},\r\n\t\tgetMinParams: 0,\r\n\t\tgetMaxParams: 0\r\n\t},\r\n\r\n\t\"drop\": {\r\n\t\texecute: function(type, params, remainder) {\r\n\t\t\tconsole.log(type, params, remainder);\r\n\t\t\tlet name = remainder;\r\n\t\t\tlet quantity = parseInt(params[0], 10);\r\n\t\t\tconsole.log(name, quantity);\r\n\t\t\tif (isNaN(quantity)) {\r\n\t\t\t\tname = (params[0] + \" \" + remainder).trim();\r\n\t\t\t\tquantity = 0;\r\n\t\t\t}\r\n\t\t\tconsole.log(name, quantity);\r\n\t\t\tvar action = {\r\n\t\t\t\t\"type\": \"drop\",\r\n\t\t\t\t\"source_name\": name,\r\n\t\t\t\t\"quantity\": \"\" + quantity,\r\n\t\t\t\t\"x\": \"\" + marauroa.me.x,\r\n\t\t\t\t\"y\": \"\" + marauroa.me.y\r\n\t\t\t};\r\n\t\t\tconsole.log(action);\r\n\t\t\tmarauroa.clientFramework.sendAction(action);\r\n\t\t\treturn true;\r\n\t\t},\r\n\t\tgetMinParams: 0,\r\n\t\tgetMaxParams: 1\r\n\t},\r\n\r\n\t\"gag\": {\r\n\t\texecute: function(type, params, remainder) {\r\n\t\t\tvar action = {\r\n\t\t\t\t\"type\": \"gag\",\r\n\t\t\t\t\"target\": params[0],\r\n\t\t\t\t\"minutes\": params[1],\r\n\t\t\t\t\"reason\": remainder\r\n\t\t\t};\r\n\t\t\tmarauroa.clientFramework.sendAction(action);\r\n\t\t\treturn true;\r\n\t\t},\r\n\t\tgetMinParams: 2,\r\n\t\tgetMaxParams: 2\r\n\t},\r\n\r\n\t\"group\": {\r\n\t\texecute: function(type, params, remainder) {\r\n\t\t\tvar action = {\r\n\t\t\t\t\"type\": \"group_management\",\r\n\t\t\t\t\"action\": params[0],\r\n\t\t\t\t\"params\": remainder\r\n\t\t\t};\r\n\t\t\tmarauroa.clientFramework.sendAction(action);\r\n\t\t\treturn true;\r\n\t\t},\r\n\t\tgetMinParams: 1,\r\n\t\tgetMaxParams: 1\r\n\t},\r\n\r\n\t\"grumpy\": {\r\n\t\texecute: function(type, params, remainder) {\r\n\t\t\tvar reason = null;\r\n\t\t\tif (remainder.length != 0) {\r\n\t\t\t\treason = remainder;\r\n\t\t\t};\r\n\r\n\t\t\tvar action = {\r\n\t\t\t\t\"type\": \"grumpy\",\r\n\t\t\t\t\"reason\": reason\r\n\t\t\t};\r\n\r\n\t\t\tmarauroa.clientFramework.sendAction(action);\r\n\t\t\treturn true;\r\n\t\t},\r\n\t\tgetMinParams: 0,\r\n\t\tgetMaxParams: 0\r\n\t},\r\n\r\n\r\n\t\"help\": {\r\n\t\texecute: function(type, params, remainder) {\r\n\t\t\tvar msg = [\r\n\t\t\t\t\"For a detailed reference, visit #https://stendhalgame.org/wiki/Stendhal_Manual\",\r\n\t\t\t\t\"Here are the most-used commands:\",\r\n\t\t\t\t\"* CHATTING:\",\r\n\t\t\t\t\"- /me <action> \\tShow a message about what you are doing.\",\r\n\t\t\t\t\"- /tell <player> <message> \\tSend a private message to #player.\",\r\n\t\t\t\t\"- /answer <message>\",\r\n\t\t\t\t\"\\t\\tSend a private message to the last player who sent a message to you.\",\r\n\t\t\t\t\"- // <message>\\tSend a private message to the last player you sent a message to.\",\r\n\t\t\t\t\"- /storemessage <player> <message> \\t\\tStore a private message to deliver for an offline #player.\",\r\n\t\t\t\t\"- /who \\tList all players currently online.\",\r\n\t\t\t\t\"- /where <player> \\tShow the current location of #player.\",\r\n\t\t\t\t\"- /sentence <text> \\tSet message on stendhalgame.org profile page and what players see when using #Look.\",\r\n\t\t\t\t\"* SUPPORT:\",\r\n\t\t\t\t\"- /support <message> \\t\\tAsk an administrator for help.\",\r\n\t\t\t\t\"- /faq \\t\\tOpen Stendhal FAQs wiki page in browser.\",\r\n\t\t\t\t\"* ITEM MANIPULATION:\",\r\n\t\t\t\t\"- /markscroll <text> \\t\\tMark your empty scroll and add a #text label.\",\r\n\t\t\t\t\"* BUDDIES AND ENEMIES:\",\r\n\t\t\t\t\"- /add <player> \\tAdd #player to your buddy list.\",\r\n\t\t\t\t\"- /remove <player>\",\r\n\t\t\t\t\"\\t\\tRemove #player from your buddy list.\",\r\n\t\t\t\t\"- /ignore <player> [minutes|*|- [reason...]] \\t\\tAdd #player to your ignore list.\",\r\n\t\t\t\t\"- /ignore \\tFind out who is on your ignore list.\",\r\n\t\t\t\t\"- /unignore <player> \\t\\tRemove #player from your ignore list.\",\r\n\t\t\t\t\"* STATUS:\",\r\n\t\t\t\t\"- /away <message> \\t\\tSet an away message.\",\r\n\t\t\t\t\"- /away \\tRemove away status.\",\r\n\t\t\t\t\"- /grumpy <message> \\t\\tSet a message to ignore all non-buddies.\",\r\n\t\t\t\t\"- /grumpy \\tRemove grumpy status.\",\r\n\t\t\t\t\"- /name <pet> <name> \\t\\tGive a name to your pet.\",\r\n\t\t\t\t\"- /profile [name] \\tOpens a player profile page on stendhalgame.org.\",\r\n\t\t\t\t\"* PLAYER CONTROL:\",\r\n//\t\t\t\t\"- /clickmode \\tSwitches between single click mode and double click mode.\",\r\n\t\t\t\t\"- /walk \\tToggles autowalk on/off.\",\r\n\t\t\t\t\"- /stopwalk \\tTurns autowalk off.\",\r\n\t\t\t\t\"- /movecont <on|off> \\tToggle continuous movement (allows players to continue walking after map change or teleport without releasing direction key).\",\r\n/*\t\t\t\t\"* CLIENT SETTINGS:\",\r\n\t\t\t\t\"- /mute \\tMute or unmute the sounds.\",\r\n\t\t\t\t\"- /volume \\tLists or sets the volume for sound and music.\",*/\r\n\t\t\t\t\"* MISC:\",\r\n\t\t\t\t\"- /info \\t\\tFind out what the current server time is.\",\r\n\t\t\t\t\"- /clear \\tClear chat log.\",\r\n\t\t\t\t\"- /help \\tShow help information.\",\r\n\t\t\t\t\"- /removedetail \\tRemove the detail layer (e.g. balloon, umbrella, etc.) from character.\"\r\n\t\t\t];\r\n\t\t\tfor (var i = 0; i < msg.length; i++) {\r\n\t\t\t\tstendhal.ui.chatLog.addLine(\"info\", msg[i]);\r\n\t\t\t}\r\n\t\t\treturn true;\r\n\t\t},\r\n\t\tgetMinParams: 0,\r\n\t\tgetMaxParams: 0\r\n\t},\r\n\r\n\r\n\t\"gmhelp\": {\r\n\t\texecute: function(type, params, remainder) {\r\n\t\t\tvar msg = null;\r\n\r\n\t\t\tif (params[0] == null) {\r\n\t\t\t\tmsg = [\r\n\t\t\t\t\t\"For a detailed reference, visit #https://stendhalgame.org/wiki/Stendhal:Administration\",\r\n\t\t\t\t\t\"Here are the most-used GM commands:\",\r\n\t\t\t\t\t\"* GENERAL:\",\r\n\t\t\t\t\t\"- /gmhelp [alter|script|support]\",\r\n\t\t\t\t\t\"\\t\\tFor more info about alter, script or the supportanswer shortcuts.\",\r\n\t\t\t\t\t\"- /adminnote <player> <note>\",\r\n\t\t\t\t\t\"\\t\\tLogs a note about #player.\",\r\n\t\t\t\t\t\"- /inspect <player>\",\r\n\t\t\t\t\t\"\\t\\tShow complete details of #player.\",\r\n\t\t\t\t\t\"- /inspectkill <player> <creature>\",\r\n\t\t\t\t\t\"\\t\\tShow creature kill counts of #player for #creature.\",\r\n\t\t\t\t\t\"- /inspectquest <player> <quest_slot>\",\r\n\t\t\t\t\t\"\\t\\tShow the state of quest for #player.\",\r\n\t\t\t\t\t\"- /script <scriptname>\",\r\n\t\t\t\t\t\"\\t\\tLoad (or reload) a script on the server. See #/gmhelp #script for details.\",\r\n\t\t\t\t\t\"* CHATTING:\",\r\n\t\t\t\t\t\"- /supportanswer <player> <message>\",\r\n\t\t\t\t\t\"\\t\\tReplies to a support question. Replace #message with $faq, $faqsocial, $ignore, $faqpvp, $wiki, $knownbug, $bugstracker, $rules, $notsupport or $spam shortcuts if desired.\",\r\n\t\t\t\t\t\"- /tellall <message>\",\r\n\t\t\t\t\t\"\\t\\tSend a private message to all logged-in players.\",\r\n\t\t\t\t\t\"* PLAYER CONTROL:\",\r\n\t\t\t\t\t\"- /teleportto <name>\",\r\n\t\t\t\t\t\"\\t\\tTeleport yourself near the specified player or NPC.\",\r\n\t\t\t\t\t\"- /teleclickmode \\tMakes you teleport to the location you double click.\",\r\n\t\t\t\t\t\"- /ghostmode \\tMakes yourself invisible and intangible.\",\r\n\t\t\t\t\t\"- /invisible \\tToggles whether or not you are invisible to creatures.\",\r\n\t\t\t\t\t\"* ENTITY MANIPULATION:\",\r\n\t\t\t\t\t\"- /adminlevel <player> [<newlevel>]\",\r\n\t\t\t\t\t\"\\t\\tDisplay or set the adminlevel of the specified #player.\",\r\n\t\t\t\t\t\"- /jail <player> <minutes> <reason>\",\r\n\t\t\t\t\t\"\\t\\tImprisons #player for a given length of time.\",\r\n\t\t\t\t\t\"- /gag <player> <minutes> <reason>\",\r\n\t\t\t\t\t\"\\t\\tGags #player for a given length of time (player is unable to send messages to anyone).\",\r\n\t\t\t\t\t\"- /ban <character> <hours> <reason>\",\r\n\t\t\t\t\t\"\\t\\tBans the account of the character from logging onto the game server or website for the specified amount of hours (-1 till end of time).\",\r\n\t\t\t\t\t\"- /teleport <player> <zone> <x> <y>\",\r\n\t\t\t\t\t\"\\t\\tTeleport #player to the given location.\",\r\n\t\t\t\t\t\"- /alter <player> <attrib> <mode> <value>\",\r\n\t\t\t\t\t\"\\t\\tAlter stat #attrib of #player by the given amount; #mode can be ADD, SUB, SET or UNSET. See #/gmhelp #alter for details.\",\r\n\t\t\t\t\t\"- /altercreature <id> name;atk;def;hp;xp\",\r\n\t\t\t\t\t\"\\t\\tChange values of the creature. Use #- as a placeholder to keep default value. Useful in raids.\",\r\n\t\t\t\t\t\"- /alterkill <player> <type> <count> <creature>\",\r\n\t\t\t\t\t\"\\t\\tChange number of #creature killed #type (\\\"solo\\\" or \\\"shared\\\") to #count for #player.\",\r\n\t\t\t\t\t\"- /alterquest <player> <questslot> <value>\",\r\n\t\t\t\t\t\"\\t\\tUpdate the #questslot for #player to be #value.\",\r\n\t\t\t\t\t\"- /summon <creature|item> [x] [y]\",\r\n\t\t\t\t\t\"- /summon <stackable item> [quantity]\",\r\n\t\t\t\t\t\"- /summon <stackable item> <x> <y> [quantity]\",\r\n\t\t\t\t\t\"\\t\\tSummon the specified item or creature at co-ordinates #x, #y in the current zone.\",\r\n\t\t\t\t\t\"- /summonat <player> <slot> [amount] <item>\",\r\n\t\t\t\t\t\"\\t\\tSummon the specified item into the specified slot of <player>; <amount> defaults to 1 if not specified.\",\r\n\t\t\t\t\t\"- /destroy <entity> \\tDestroy an entity completely.\",\r\n\t\t\t\t\t\"* MISC:\",\r\n\t\t\t\t\t\"- /jailreport [<player>]\",\r\n\t\t\t\t\t\"\\t\\tList the jailed players and their sentences.\"\r\n\t\t\t\t];\r\n\t\t\t} else if ((params.length == 1) && (params[0] != null)) {\r\n\t\t\t\tif (\"alter\" == params[0]) {\r\n\t\t\t\t\tmsg = [\r\n\t\t\t\t\t\t\"/alter <player> <attrib> <mode> <value>\",\r\n\t\t\t\t\t\t\"\\t\\tAlter stat <attrib> of <player> by the given amount; <mode> can be ADD, SUB, SET or UNSET.\",\r\n\t\t\t\t\t\t\"\\t\\t- Examples of <attrib>: atk, def, base_hp, hp, atk_xp, def_xp, xp, outfit\",\r\n\t\t\t\t\t\t\"\\t\\t- When modifying 'outfit', you should use SET mode and provide an 8-digit number; the first 2 digits are the 'hair' setting, then 'head', 'outfit', then 'body'\",\r\n\t\t\t\t\t\t\"\\t\\t  For example: #'/alter testplayer outfit set 12109901'\",\r\n\t\t\t\t\t\t\"\\t\\t  This will make <testplayer> look like danter\"\r\n\t\t\t\t\t];\r\n\t\t\t\t} else if (\"script\" == params[0]) {\r\n\t\t\t\t\tmsg = [\r\n\t\t\t\t\t\t\"usage: /script [-list|-load|-unload|-execute] [params]\",\r\n\t\t\t\t\t\t\"\\t-list : shows available scripts. In this mode can be given one optional parameter for filenames filtering, with using well-known wildcards for filenames ('*' and '?', for example \\\"*.class\\\" for java-only scripts).\",\r\n\t\t\t\t\t\t\"\\t-load : load script with first parameter's filename.\",\r\n\t\t\t\t\t\t\"\\t-unload : unload script with first parameter's filename from server\",\r\n\t\t\t\t\t\t\"\\t-execute : run selected script.\",\r\n\t\t\t\t\t\t\"\",\r\n\t\t\t\t\t\t\"All scripts are ran using: /script scriptname [params]. After running a script you can remove any traces of it with /script -unload scriptname, this would remove any summoned creatures, for example. It's good practise to do this after summoning creatures for a raid using scripts.\",\r\n\t\t\t\t\t\t\"#/script #AdminMaker.class : For test servers only, summons an adminmaker to aid testing.\",\r\n\t\t\t\t\t\t\"#/script #AdminSign.class #zone #x #y #text : Makes an AdminSign in zone at (x,y) with text. To put it next to you do /script AdminSign.class - - - text.\",\r\n\t\t\t\t\t\t\"#/script #AlterQuest.class #player #questname #state : Update the quest for a player to be in a certain state. Omit #state to remove the quest.\",\r\n\t\t\t\t\t\t\"#/script #DeepInspect.class #player : Deep inspects a player and all his/her items.\",\r\n\t\t\t\t\t\t\"#/script #DropPlayerItems.class #player #[amount] #item : Drop the specified amount of items from the player if they are equipped in the bag or body.\",\r\n\t\t\t\t\t\t\"#/script #EntitySearch.class #nonrespawn : Shows the locations of all creatures that don't respawn, for example creatures that were summoned by a GM, deathmatch creatures, etc.\",\r\n\t\t\t\t\t\t\"#/script #FixDM.class #player : sets a player's DeathMatch slot to victory status.\",\r\n\t\t\t\t\t\t\"#/script #ListNPCs.class : lists all npcs and their position.\",\r\n\t\t\t\t\t\t\"#/script #LogoutPlayer.class #player : kicks a player from the game.\",\r\n\t\t\t\t\t\t\"#/script #NPCShout.class #npc #text : NPC shouts text.\",\r\n\t\t\t\t\t\t\"#/script #NPCShoutZone.class #npc #zone #text : NPC shouts text to players in given zone. Use - in place of zone to make it your current zone.\",\r\n\t\t\t\t\t\t\"#/script #Plague.class #1 #creature : summon a plague of raid creatures around you.\",\r\n\t\t\t\t\t\t\"#/script #WhereWho.class : Lists where all the online players are\",\r\n\t\t\t\t\t\t\"#/script #Maria.class : Summons Maria, who sells food&drinks. Don't forget to -unload her after you're done.\",\r\n\t\t\t\t\t\t\"#/script #ServerReset.class : use only in a real emergency to shut down server. If possible please warn the players to logout and give them some time. It kills the server the hard way.\",\r\n\t\t\t\t\t\t\"#/script #ResetSlot.class #player #slot : Resets the named slot such as !kills or !quests. Useful for debugging.\"\r\n\t\t\t\t\t];\r\n\t\t\t\t/* TODO:\r\n\t\t\t\t} else if (\"support\" == params[0]) {\r\n\t\t\t\t\tmsg = buildHelpSupportResponse();\r\n\t\t\t\t*/\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\r\n\t\t\tfor (var i = 0; i < msg.length; i++) {\r\n\t\t\t\tstendhal.ui.chatLog.addLine(\"info\", msg[i]);\r\n\t\t\t}\r\n\r\n\t\t\treturn true;\r\n\t\t},\r\n\t\tgetMinParams: 0,\r\n\t\tgetMaxParams: 1\r\n\t},\r\n\r\n\r\n\t\"ignore\": {\r\n\t\texecute: function(type, params, remainder) {\r\n\t\t\tconst action = {\r\n\t\t\t\t\t\"type\": \"ignore\"\r\n\t\t\t};\r\n\r\n\t\t\tif (params[0] == null) {\r\n\t\t\t\taction[\"list\"] = \"1\";\r\n\t\t\t} else {\r\n\t\t\t\taction[\"target\"] = params[0];\r\n\t\t\t\tvar duration = params[1];\r\n\r\n\t\t\t\tif (duration != null) {\r\n\t\t\t\t\t/*\r\n\t\t\t\t\t * Ignore \"forever\" values\r\n\t\t\t\t\t */\r\n\t\t\t\t\tif (duration != \"*\" || duration != \"-\") {\r\n\t\t\t\t\t\t/*\r\n\t\t\t\t\t\t * Validate it's a number\r\n\t\t\t\t\t\t */\r\n\t\t\t\t\t\tif (isNaN(duration)) {\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\taction[\"duration\"] = duration;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (remainder.length != 0) {\r\n\t\t\t\t\taction[\"reason\"] = remainder;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tmarauroa.clientFramework.sendAction(action);\r\n\t\t\treturn true;\r\n\t\t},\r\n\t\tgetMinParams: 0,\r\n\t\tgetMaxParams: 2\r\n\t},\r\n\r\n\t\"inspectkill\": {\r\n\t\texecute: function(type, params, remainder) {\r\n\t\t\tconst target = params[0];\r\n\t\t\tvar creature = null;\r\n\t\t\tif (remainder != null && remainder != \"\") {\r\n\t\t\t\t// NOTE: unlike Java client, Javascript client automatically trims whitespace in \"remainder\" parameter\r\n\t\t\t\tcreature = remainder;\r\n\t\t\t}\r\n\r\n\t\t\tconst action = {\r\n\t\t\t\t\"type\": \"inspectkill\",\r\n\t\t\t\t\"target\": target\r\n\t\t\t};\r\n\t\t\tif (creature != null) {\r\n\t\t\t\taction[\"creature\"] = creature;\r\n\t\t\t}\r\n\r\n\t\t\tmarauroa.clientFramework.sendAction(action);\r\n\t\t\treturn true;\r\n\t\t},\r\n\t\tgetMinParams: 1,\r\n\t\tgetMaxParams: 1\r\n\t},\r\n\r\n\t\"inspectquest\": {\r\n\t\texecute: function(type, params, remainder) {\r\n\t\t\tvar action = {\r\n\t\t\t\t\t\"type\": \"inspectquest\",\r\n\t\t\t\t\t\"target\": params[0],\r\n\t\t\t\t\t\"quest_slot\": params[1]\r\n\t\t\t};\r\n\t\t\tmarauroa.clientFramework.sendAction(action);\r\n\t\t\treturn true;\r\n\t\t},\r\n\t\tgetMinParams: 2,\r\n\t\tgetMaxParams: 2\r\n\t},\r\n\r\n\r\n\t\"jail\": {\r\n\t\texecute: function(type, params, remainder) {\r\n\t\t\tvar action = {\r\n\t\t\t\t\"type\": \"jail\",\r\n\t\t\t\t\"target\": params[0],\r\n\t\t\t\t\"minutes\": params[1],\r\n\t\t\t\t\"reason\": remainder\r\n\t\t\t};\r\n\t\t\tmarauroa.clientFramework.sendAction(action);\r\n\t\t\treturn true;\r\n\t\t},\r\n\t\tgetMinParams: 2,\r\n\t\tgetMaxParams: 2\r\n\t},\r\n\r\n\t\"/\" : {\r\n\t\texecute: function(type, params, remainder) {\r\n\t\t\tif (typeof(stendhal.slashActionRepository.lastPlayerTell) != \"undefined\") {\r\n\t\t\t\tvar action = {\r\n\t\t\t\t\t\"type\": \"tell\",\r\n\t\t\t\t\t\"target\": stendhal.slashActionRepository.lastPlayerTell,\r\n\t\t\t\t\t\"text\": remainder\r\n\t\t\t\t};\r\n\t\t\t\tmarauroa.clientFramework.sendAction(action);\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t},\r\n\t\tgetMinParams: 0,\r\n\t\tgetMaxParams: 0\r\n\t},\r\n\r\n\t\"me\": {\r\n\t\texecute: function(type, params, remainder) {\r\n\t\t\tvar action = {\r\n\t\t\t\t\"type\": \"emote\",\r\n\t\t\t\t\"text\": remainder\r\n\t\t\t};\r\n\t\t\tmarauroa.clientFramework.sendAction(action);\r\n\t\t\treturn true;\r\n\t\t},\r\n\t\tgetMinParams: 0,\r\n\t\tgetMaxParams: 0\r\n\t},\r\n\r\n\t\"movecont\": {\r\n\t\texecute: function(type, params, remainder) {\r\n\t\t\tvar action = {\r\n\t\t\t\t\"type\": \"move.continuous\",\r\n\t\t\t};\r\n\r\n\t\t\tconst state = params[0].toLowerCase();\r\n\r\n\t\t\tif (state == \"on\") {\r\n\t\t\t\taction[\"move.continuous\"] = \"\";\r\n\t\t\t} else if (state != \"off\") {\r\n\t\t\t\tstendhal.ui.chatLog.addLine(\"error\", \"Argument must be either \\\"on\\\" or \\\"off\\\".\");\r\n\t\t\t\treturn false;\r\n\t\t\t};\r\n\r\n\t\t\tmarauroa.clientFramework.sendAction(action);\r\n\r\n\t\t\tvar msg = \"Continuous movement \";\r\n\t\t\tif (state == \"on\") {\r\n\t\t\t\tmsg += \"enabled\";\r\n\t\t\t} else {\r\n\t\t\t\tmsg += \"disabled\";\r\n\t\t\t}\r\n\t\t\tmsg += \".\";\r\n\r\n\t\t\tstendhal.ui.chatLog.addLine(\"info\", msg);\r\n\t\t\treturn true;\r\n\t\t},\r\n\t\tgetMinParams: 1,\r\n\t\tgetMaxParams: 1\r\n\t},\r\n\r\n\t\"msg\" : {\r\n\t\texecute: function(type, params, remainder) {\r\n\t\t\tstendhal.slashActionRepository.lastPlayerTell = params[0];\r\n\t\t\tvar action = {\r\n\t\t\t\t\"type\": \"tell\",\r\n\t\t\t\t\"target\": params[0],\r\n\t\t\t\t\"text\": remainder\r\n\t\t\t};\r\n\t\t\tmarauroa.clientFramework.sendAction(action);\r\n\t\t\treturn true;\r\n\t\t},\r\n\t\tgetMinParams: 1,\r\n\t\tgetMaxParams: 1\r\n\t},\r\n\r\n\t\"p\": {\r\n\t\texecute: function(type, params, remainder) {\r\n\t\t\tvar action = {\r\n\t\t\t\t\"type\": \"group_message\",\r\n\t\t\t\t\"text\": remainder\r\n\t\t\t};\r\n\t\t\tmarauroa.clientFramework.sendAction(action);\r\n\t\t\treturn true;\r\n\t\t},\r\n\t\tgetMinParams: 0,\r\n\t\tgetMaxParams: 0\r\n\t},\r\n\r\n\t\"progressstatus\": {\r\n\t\texecute: function(type, params, remainder) {\r\n\t\t\tvar action = {\r\n\t\t\t\t\"type\": type\r\n\t\t\t}\r\n\r\n\t\t\tif (remainder.length > 0) {\r\n\t\t\t\tif (remainder.indexOf(\"Open Quests\") > -1) {\r\n\t\t\t\t\taction[\"progress_type\"] = \"Open Quests\";\r\n\t\t\t\t\tremainder = remainder.substring(12);\r\n\t\t\t\t} else if (remainder.indexOf(\"Completed Quests\") > -1) {\r\n\t\t\t\t\taction[\"progress_type\"] = \"Completed Quests\";\r\n\t\t\t\t\tremainder = remainder.substring(17);\r\n\t\t\t\t} else if (remainder.indexOf(\"Production\") > -1) {\r\n\t\t\t\t\taction[\"progress_type\"] = \"Production\";\r\n\t\t\t\t\tremainder = remainder.substring(11);\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t}\r\n\t\t\t\tif (remainder) {\r\n\t\t\t\t\taction[\"item\"] = remainder;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tmarauroa.clientFramework.sendAction(action);\r\n\t\t\treturn true;\r\n\t\t},\r\n\t\tgetMinParams: 0,\r\n\t\tgetMaxParams: 0\r\n\t},\r\n\r\n\t\"remove\": {\r\n\t\texecute: function(type, params, remainder) {\r\n\t\t\tif (params == null) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\r\n\t\t\tconst action = {\r\n\t\t\t\t\"type\": \"removebuddy\",\r\n\t\t\t\t\"target\": params[0]\r\n\t\t\t};\r\n\r\n\t\t\tmarauroa.clientFramework.sendAction(action);\r\n\t\t\treturn true;\r\n\t\t},\r\n\t\tgetMinParams: 1,\r\n\t\tgetMaxParams: 1\r\n\t},\r\n\r\n\t\"sentence\": {\r\n\t\texecute: function(type, params, remainder) {\r\n\t\t\tif (params == null) {\r\n\t\t\t\treturn false;\r\n\t\t\t};\r\n\r\n\t\t\tconst action = {\r\n\t\t\t\t\"type\": \"sentence\",\r\n\t\t\t\t\"value\": remainder\r\n\t\t\t};\r\n\r\n\t\t\tmarauroa.clientFramework.sendAction(action);\r\n\t\t\treturn true;\r\n\t\t},\r\n\t\tgetMinParams: 0,\r\n\t\tgetMaxParams: 0\r\n\t},\r\n\r\n\t\"settings\": {\r\n\t\texecute: function(type, params, remainder) {\r\n\t\t\tstendhal.ui.settings.onOpenSettingsMenu();\r\n\t\t\treturn true;\r\n\t\t},\r\n\t\tgetMinParams: 0,\r\n\t\tgetMaxParams: 0\r\n\t},\r\n\r\n\t\"stopwalk\": {\r\n\t\texecute: function(type, params, remainder) {\r\n\t\t\tconst action = {\r\n\t\t\t\t\"type\": \"walk\",\r\n\t\t\t\t\"mode\": \"stop\"\r\n\t\t\t};\r\n\t\t\tmarauroa.clientFramework.sendAction(action);\r\n\t\t\treturn true;\r\n\t\t},\r\n\t\tgetMinParams: 0,\r\n\t\tgetMaxParams: 0\r\n\t},\r\n\r\n\t\"summon\": {\r\n\t\texecute: function(type, params, remainder) {\r\n\t\t\tvar x = null;\r\n\t\t\tvar y = null;\r\n\t\t\tvar quantity = null;\r\n\r\n\t\t\tvar nameBuilder = [];\r\n\t\t\tfor (var idx = 0; idx < params.length; idx++) {\r\n\t\t\t\tconst str = params[idx];\r\n\t\t\t\tif (str.match(\"[0-9].*\")) {\r\n\t\t\t\t\tif (x == null) {\r\n\t\t\t\t\t\tx = str;\r\n\t\t\t\t\t} else if (y == null) {\r\n\t\t\t\t\t\ty = str;\r\n\t\t\t\t\t} else if (quantity == null) {\r\n\t\t\t\t\t\tquantity = str;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tnameBuilder.push(str);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tnameBuilder.push(str);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// use x value as quantity if y was not specified\r\n\t\t\tif (quantity == null && y == null && x != null) {\r\n\t\t\t\tquantity = x;\r\n\t\t\t\tx = null;\r\n\t\t\t}\r\n\r\n\t\t\tvar creature = nameBuilder.join(\" \");\r\n\t\t\tif (x == null || y == null) {\r\n\t\t\t\t// for some reason, the action does not accept the x,y coordinates if they are not a string\r\n\t\t\t\tx = marauroa.me.x.toString();\r\n\t\t\t\ty = marauroa.me.y.toString();\r\n\t\t\t}\r\n\r\n\t\t\tvar action = {\r\n\t\t\t\t\"type\": type,\r\n\t\t\t\t\"creature\": creature,\r\n\t\t\t\t\"x\": x,\r\n\t\t\t\t\"y\": y,\r\n\t\t\t\t\"quantity\": quantity\r\n\t\t\t};\r\n\t\t\tmarauroa.clientFramework.sendAction(action);\r\n\t\t\treturn true;\r\n\t\t},\r\n\t\tgetMinParams: 1,\r\n\t\tgetMaxParams: -1 // XXX: is this the proper way to allow an unlimited number of arguments?\r\n\t},\r\n\r\n\t\"summonat\": {\r\n\t\texecute: function(type, params, remainder) {\r\n\t\t\tvar amount = params[2];\r\n\t\t\t// don't require first parameter to be integer amount\r\n\t\t\tif (isNaN(amount)) {\r\n\t\t\t\tif (remainder) {\r\n\t\t\t\t\tremainder = amount + \" \" + remainder;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tremainder = amount;\r\n\t\t\t\t}\r\n\t\t\t\tamount = \"1\";\r\n\t\t\t}\r\n\r\n\t\t\tvar action = {\r\n\t\t\t\t\"type\": type,\r\n\t\t\t\t\"target\": params[0],\r\n\t\t\t\t\"slot\": params[1],\r\n\t\t\t\t\"amount\": amount,\r\n\t\t\t\t\"item\": remainder\r\n\t\t\t};\r\n\t\t\tmarauroa.clientFramework.sendAction(action);\r\n\t\t\treturn true;\r\n\t\t},\r\n\t\tgetMinParams: 3,\r\n\t\tgetMaxParams: 3\r\n\t},\r\n\r\n\t\"support\": {\r\n\t\texecute: function(type, params, remainder) {\r\n\t\t\tvar action = {\r\n\t\t\t\t\"type\": \"support\",\r\n\t\t\t\t\"text\": remainder\r\n\t\t\t};\r\n\t\t\tmarauroa.clientFramework.sendAction(action);\r\n\t\t\treturn true;\r\n\t\t},\r\n\t\tgetMinParams: 0,\r\n\t\tgetMaxParams: 0\r\n\t},\r\n\r\n\t\"supportanswer\" : {\r\n\t\texecute: function(type, params, remainder) {\r\n\t\t\tvar action = {\r\n\t\t\t\t\"type\": \"supportanswer\",\r\n\t\t\t\t\"target\": params[0],\r\n\t\t\t\t\"text\": remainder\r\n\t\t\t};\r\n\t\t\tmarauroa.clientFramework.sendAction(action);\r\n\t\t\treturn true;\r\n\t\t},\r\n\t\tgetMinParams: 1,\r\n\t\tgetMaxParams: 1\r\n\t},\r\n\r\n\t\"teleport\": {\r\n\t\texecute: function(type, params, remainder) {\r\n\t\t\tvar action = {\r\n\t\t\t\t\"type\": \"teleport\",\r\n\t\t\t\t\"target\": params[0],\r\n\t\t\t\t\"zone\": params[1],\r\n\t\t\t\t\"x\": params[2],\r\n\t\t\t\t\"y\": params[3]\r\n\t\t\t};\r\n\t\t\tmarauroa.clientFramework.sendAction(action);\r\n\t\t\treturn true;\r\n\t\t},\r\n\t\tgetMinParams: 4,\r\n\t\tgetMaxParams: 4\r\n\t},\r\n\r\n\t\"teleportto\": {\r\n\t\texecute: function(type, params, remainder) {\r\n\t\t\tvar action = {\r\n\t\t\t\t\"type\": \"teleportto\",\r\n\t\t\t\t\"target\": remainder,\r\n\t\t\t};\r\n\t\t\tmarauroa.clientFramework.sendAction(action);\r\n\t\t\treturn true;\r\n\t\t},\r\n\t\tgetMinParams: 0,\r\n\t\tgetMaxParams: 0\r\n\t},\r\n\r\n\t\"tellall\": {\r\n\t\texecute: function(type, params, remainder) {\r\n\t\t\tvar action = {\r\n\t\t\t\t\"type\": \"tellall\",\r\n\t\t\t\t\"text\": remainder\r\n\t\t\t};\r\n\t\t\tmarauroa.clientFramework.sendAction(action);\r\n\t\t\treturn true;\r\n\t\t},\r\n\t\tgetMinParams: 0,\r\n\t\tgetMaxParams: 0\r\n\t},\r\n\r\n\t\"walk\": {\r\n\t\texecute: function(type, params, remainder) {\r\n\t\t\tconst action = {\r\n\t\t\t\t\"type\": \"walk\"\r\n\t\t\t};\r\n\t\t\tmarauroa.clientFramework.sendAction(action);\r\n\t\t\treturn true;\r\n\t\t},\r\n\t\tgetMinParams: 0,\r\n\t\tgetMaxParams: 0\r\n\t},\r\n\r\n\t\"atlas\": {\r\n\t\texecute: function(type, params, remainder) {\r\n\t\t\twindow.location = \"https://stendhalgame.org/world/atlas.html?me=\"\r\n\t\t\t\t+ marauroa.currentZoneName + \".\" + marauroa.me.x + \".\" + marauroa.me.y;\r\n\t\t},\r\n\t\tgetMinParams: 0,\r\n\t\tgetMaxParams: 0\r\n\t},\r\n\r\n\t\"beginnersguide\": {\r\n\t\texecute: function(type, params, remainder) {\r\n\t\t\twindow.location = \"https://stendhalgame.org/wiki/Stendhal_Beginner's_Guide\";\r\n\t\t},\r\n\t\tgetMinParams: 0,\r\n\t\tgetMaxParams: 0\r\n\t},\r\n\r\n\t\"characterselector\": {\r\n\t\texecute: function(type, params, remainder) {\r\n\t\t\twindow.location = \"https://stendhalgame.org/account/mycharacters.html\";\r\n\t\t},\r\n\t\tgetMinParams: 0,\r\n\t\tgetMaxParams: 0\r\n\t},\r\n\r\n\t\"faq\": {\r\n\t\texecute: function(type, params, remainder) {\r\n\t\t\twindow.location = \"https://stendhalgame.org/wiki/Stendhal_FAQ\";\r\n\t\t},\r\n\t\tgetMinParams: 0,\r\n\t\tgetMaxParams: 0\r\n\t},\r\n\r\n\t\"manual\": {\r\n\t\texecute: function(type, params, remainder) {\r\n\t\t\twindow.location = \"https://stendhalgame.org/wiki/Stendhal_Manual/Controls_and_Game_Settings\";\r\n\t\t},\r\n\t\tgetMinParams: 0,\r\n\t\tgetMaxParams: 0\r\n\t},\r\n\r\n\t\"profile\": {\r\n\t\texecute: function(type, params, remainder) {\r\n\t\t\tvar url = \"https://stendhalgame.org/character/\";\r\n\t\t\tvar name = null;\r\n\r\n\t\t\tif (params.length > 0 && params[0] != null) {\r\n\t\t\t\tname = params[0];\r\n\t\t\t} else {\r\n\t\t\t\tname = marauroa.me[\"_name\"];\r\n\t\t\t\tif (name == null) {\r\n\t\t\t\t\t// DEBUG:\r\n\t\t\t\t\tconsole.log(\"Getting default username failed!\");\r\n\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\turl += name + \".html\";\r\n\t\t\tstendhal.ui.chatLog.addLine(\"info\", \"Trying to open #\" + url + \" in your browser.\");\r\n\t\t\twindow.location = url;\r\n\t\t\treturn true;\r\n\t\t},\r\n\t\tgetMinParams: 0,\r\n\t\tgetMaxParams: 1\r\n\t},\r\n\r\n\t\"rules\": {\r\n\t\texecute: function(type, params, remainder) {\r\n\t\t\twindow.location = \"https://stendhalgame.org/wiki/Stendhal_Rules\";\r\n\t\t},\r\n\t\tgetMinParams: 0,\r\n\t\tgetMaxParams: 0\r\n\t},\r\n\r\n\t\"changepassword\": {\r\n\t\texecute: function(type, params, remainder) {\r\n\t\t\twindow.location = \"https://stendhalgame.org/account/change-password.html\";\r\n\t\t},\r\n\t\tgetMinParams: 0,\r\n\t\tgetMaxParams: 0\r\n\t},\r\n\r\n\r\n\t\"loginhistory\": {\r\n\t\texecute: function(type, params, remainder) {\r\n\t\t\twindow.location = \"https://stendhalgame.org/account/history.html\";\r\n\t\t},\r\n\t\tgetMinParams: 0,\r\n\t\tgetMaxParams: 0\r\n\t},\r\n\r\n\t\"halloffame\": {\r\n\t\texecute: function(type, params, remainder) {\r\n\t\t\twindow.location = \"https://stendhalgame.org/world/hall-of-fame/active_overview.html\";\r\n\t\t},\r\n\t\tgetMinParams: 0,\r\n\t\tgetMaxParams: 0\r\n\t},\r\n\r\n\t\"storemessage\": {\r\n\t\texecute: function(type, params, remainder) {\r\n\t\t\tvar action = {\r\n\t\t\t\t\"type\": \"storemessage\",\r\n\t\t\t\t\"target\": params[0],\r\n\t\t\t\t\"text\": remainder\r\n\t\t\t};\r\n\t\t\tmarauroa.clientFramework.sendAction(action);\r\n\t\t\treturn true;\r\n\t\t},\r\n\t\tgetMinParams: 1,\r\n\t\tgetMaxParams: 1\r\n\t},\r\n\r\n\t\"_default\": {\r\n\t\texecute: function(type, params, remainder) {\r\n\t\t\tvar action = {\r\n\t\t\t\t\"type\": type\r\n\t\t\t};\r\n\t\t\tif (typeof(params[0] != \"undefined\")) {\r\n\t\t\t\taction[\"target\"] = params[0];\r\n\t\t\t\tif (remainder != \"\") {\r\n\t\t\t\t\taction[\"args\"] = remainder;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tmarauroa.clientFramework.sendAction(action);\r\n\t\t\treturn true;\r\n\t\t},\r\n\t\tgetMinParams: 0,\r\n\t\tgetMaxParams: 1\r\n\t},\r\n\r\n\texecute: function(line) {\r\n\t\tvar array = line.trim().split(\" \");\r\n\r\n\t\t// clean whitespace\r\n\t\tfor (var i in array) {\r\n\t\t\tarray[i] = array[i].trim();\r\n\t\t}\r\n\t\tarray = array.filter(Boolean);\r\n\t\tif (array.length == 0) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tvar name = array[0];\r\n\t\tif (name[0] != \"/\") {\r\n\t\t\tname = \"/chat\";\r\n\t\t} else {\r\n\t\t\tarray.shift();\r\n\t\t}\r\n\t\tname = name.substr(1);\r\n\t\tvar action;\r\n\t\tif (typeof(stendhal.slashActionRepository[name]) == \"undefined\") {\r\n\t\t\taction = stendhal.slashActionRepository[\"_default\"];\r\n\t\t} else {\r\n\t\t\taction = stendhal.slashActionRepository[name];\r\n\t\t}\r\n\r\n\t\t// use executing character if name parameter not supplied\r\n\t\tif (name == \"where\" && array.length == 0) {\r\n\t\t\tarray[0] = marauroa.me[\"_name\"];\r\n\t\t}\r\n\r\n\t\tif (action.getMinParams <= array.length) {\r\n\t\t\tvar remainder = \"\";\r\n\t\t\tfor (var i = action.getMaxParams; i < array.length; i++) {\r\n\t\t\t\tremainder = remainder + array[i] + \" \";\r\n\t\t\t}\r\n\t\t\tarray.slice(action.getMaxParams);\r\n\t\t\treturn action.execute(name, array, remainder.trim());\r\n\t\t} else {\r\n\t\t\tstendhal.ui.chatLog.addLine(\"error\", \"Missing arguments. Try /help\");\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n};\r\n// answer, sentence, drop, add, remove, away, grumpy, profile, clickmode, walk, stopwalk, movecont, mute, settings\r\nstendhal.slashActionRepository[\"supporta\"] = stendhal.slashActionRepository[\"supportanswer\"];\r\nstendhal.slashActionRepository[\"tell\"] = stendhal.slashActionRepository[\"msg\"];\r\n","/***************************************************************************\r\n *                   (C) Copyright 2003-2017 - Stendhal                    *\r\n ***************************************************************************\r\n *                                                                         *\r\n *   This program is free software; you can redistribute it and/or modify  *\r\n *   it under the terms of the GNU Affero General Public License as        *\r\n *   published by the Free Software Foundation; either version 3 of the    *\r\n *   License, or (at your option) any later version.                       *\r\n *                                                                         *\r\n ***************************************************************************/\r\n\r\n\"use strict\";\r\n\r\nvar marauroa = window.marauroa = window.marauroa || {};\r\nvar stendhal = window.stendhal = window.stendhal || {};\r\n\r\n\r\nmarauroa.rpeventFactory[\"attack\"] = marauroa.util.fromProto(marauroa.rpeventFactory[\"_default\"], {\r\n\texecute: function(entity) {\r\n\r\n\t\tvar target = entity.getAttackTarget();\r\n\t\tif (!target) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (this.hasOwnProperty(\"hit\")) {\r\n\t\t\tvar damage = parseInt(this[\"damage\"], 10);\r\n\t\t\tif (damage !== 0) {\r\n\t\t\t\ttarget.onDamaged(entity, damage);\r\n\t\t\t} else {\r\n\t\t\t\ttarget.onBlocked(entity);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\ttarget.onMissed(entity);\r\n\t\t}\r\n\t\tentity.onAttackPerformed(this[\"type\"], this.hasOwnProperty(\"ranged\"));\r\n\t}\r\n});\r\n\r\n\r\nmarauroa.rpeventFactory[\"examine\"] = marauroa.util.fromProto(marauroa.rpeventFactory[\"_default\"], {\r\n\texecute: function(rpobject) {\r\n\t\tif (rpobject !== marauroa.me) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tnew stendhal.ui.ImageViewer(this[\"title\"], this[\"caption\"], this[\"path\"]);\r\n\t}\r\n});\r\n\r\n\r\nmarauroa.rpeventFactory[\"global_visual_effect\"] = marauroa.util.fromProto(marauroa.rpeventFactory[\"_default\"], {\r\n\texecute: function(rpobject) {\r\n\t\t// TODO: new GlobalVisualEffectEvent();\r\n\t}\r\n});\r\n\r\n\r\nmarauroa.rpeventFactory[\"group_change_event\"] = marauroa.util.fromProto(marauroa.rpeventFactory[\"_default\"], {\r\n\texecute: function(rpobject) {\r\n\t\tif (rpobject !== marauroa.me) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tstendhal.data.group.updateGroupStatus(this[\"members\"], this[\"leader\"], this[\"lootmode\"]);\r\n\t}\r\n});\r\n\r\n\r\nmarauroa.rpeventFactory[\"group_invite_event\"] = marauroa.util.fromProto(marauroa.rpeventFactory[\"_default\"], {\r\n\texecute: function(rpobject) {\r\n\t\tif (rpobject !== marauroa.me) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (this[\"expire\"]) {\r\n\t\t\tstendhal.ui.chatLog.addLine(\"normal\", \"Your group invite by \" + this[\"leader\"] + \" has expired.\");\r\n\t\t} else {\r\n\t\t\tstendhal.ui.chatLog.addLine(\"normal\", \"Your have been invited by \" + this[\"leader\"] + \" to join a group.\");\r\n\t\t\tstendhal.ui.chatLog.addLine(\"normal\", \"To join, type: /group join \" + this[\"leader\"]);\r\n\t\t\tstendhal.ui.chatLog.addLine(\"normal\", \"To leave the group at any time, type: /group part \" + this[\"leader\"]);\r\n\t\t}\r\n\t}\r\n});\r\n\r\n\r\nmarauroa.rpeventFactory[\"image_event\"] = marauroa.util.fromProto(marauroa.rpeventFactory[\"_default\"], {\r\n\texecute: function(rpobject) {\r\n\t\t// TODO: new ImageEffectEvent();\r\n\t\tconsole.log(\"image_event\", this, rpobject);\r\n\t}\r\n});\r\n\r\n\r\nmarauroa.rpeventFactory[\"player_logged_on\"] = marauroa.util.fromProto(marauroa.rpeventFactory[\"_default\"], {\r\n\texecute: function(rpobject) {\r\n\t\t// TODO: new PlayerLoggedOnEvent();\r\n\t}\r\n});\r\n\r\n\r\nmarauroa.rpeventFactory[\"player_logged_out\"] = marauroa.util.fromProto(marauroa.rpeventFactory[\"_default\"], {\r\n\texecute: function(rpobject) {\r\n\t\t// TODO: new PlayerLoggedOutEvent();\r\n\t}\r\n});\r\n\r\n\r\nmarauroa.rpeventFactory[\"private_text\"] = marauroa.util.fromProto(marauroa.rpeventFactory[\"_default\"], {\r\n\texecute: function(rpobject) {\r\n\t\tstendhal.ui.chatLog.addLine(this[\"texttype\"].toLowerCase(), this[\"text\"]);\r\n\t}\r\n});\r\n\r\n\r\nmarauroa.rpeventFactory[\"progress_status_event\"] = marauroa.util.fromProto(marauroa.rpeventFactory[\"_default\"], {\r\n\texecute: function(rpobject) {\r\n\t\tvar progressType = this[\"progress_type\"];\r\n\t\tvar dataItems = this[\"data\"].substring(1, this[\"data\"].length - 1).split(/\\t/);\r\n\r\n\t\tif (!this[\"progress_type\"]) {\r\n\t\t\tstendhal.ui.travellog.open(dataItems);\r\n\t\t} else if (!this[\"item\"]) {\r\n\t\t\tstendhal.ui.travellog.progressTypeData(progressType, dataItems);\r\n\t\t} else {\r\n\t\t\tstendhal.ui.travellog.itemData(progressType, this[\"item\"], this[\"description\"], dataItems);\r\n\t\t}\r\n\t}\r\n});\r\n\r\n\r\nmarauroa.rpeventFactory[\"reached_achievement\"] = marauroa.util.fromProto(marauroa.rpeventFactory[\"_default\"], {\r\n\texecute: function(rpobject) {\r\n\t\t// TODO: new ReachedAchievementEvent();\r\n\t}\r\n});\r\n\r\n\r\nmarauroa.rpeventFactory[\"show_item_list\"] = marauroa.util.fromProto(marauroa.rpeventFactory[\"_default\"], {\r\n\texecute: function(rpobject) {\r\n\t\tif (this.hasOwnProperty(\"title\")) {\r\n\t\t\tstendhal.ui.chatLog.addLine(\"normal\", this[\"title\"]);\r\n\t\t}\r\n\t\tif (this.hasOwnProperty(\"caption\")) {\r\n\t\t\tstendhal.ui.chatLog.addLine(\"normal\", this[\"caption\"]);\r\n\t\t}\r\n\t\tif (this.hasOwnProperty(\"content\")) {\r\n\t\t\tstendhal.ui.chatLog.addLine(\"normal\", \"Item\\t-\\tPrice\\t-\\tDescription\");\r\n\t\t\tfor (var obj in this[\"content\"]) {\r\n\t\t\t\tif (this[\"content\"].hasOwnProperty(obj)) {\r\n\t\t\t\t\tvar slotObj = this[\"content\"][obj];\r\n\t\t\t\t\tvar data = this[\"content\"][obj][\"a\"];\r\n\t\t\t\t\tstendhal.ui.chatLog.addLine(\"normal\", data[\"subclass\"] + \"\\t\"\r\n\t\t\t\t\t\t\t+ data[\"price\"] + \"\\t\" + data[\"description_info\"]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n});\r\n\r\n\r\nmarauroa.rpeventFactory[\"sound_event\"] = marauroa.util.fromProto(marauroa.rpeventFactory[\"_default\"], {\r\n\texecute: function(rpobject) {\r\n\t\tvar volume = 1;\r\n\t\t// Adjust by the server specified volume, if any\r\n\t\tif (this.hasOwnProperty(\"volume\")) {\r\n\t\t\tvolume *= parseInt(this[\"volume\"], 10) / 100;\r\n\t\t}\r\n\t\tvar radius = parseInt(this[\"radius\"], 10);\r\n\r\n\t\tstendhal.ui.sound.playLocalizedEffect(rpobject[\"_x\"], rpobject[\"_y\"], radius, this[\"layer\"], this[\"sound\"], volume);\r\n\t}\r\n});\r\n\r\n\r\nmarauroa.rpeventFactory[\"text\"] = marauroa.util.fromProto(marauroa.rpeventFactory[\"_default\"], {\r\n\texecute: function(rpobject) {\r\n\t\trpobject.say(this[\"text\"]);\r\n\t}\r\n});\r\n\r\n\r\nmarauroa.rpeventFactory[\"trade_state_change_event\"] = marauroa.util.fromProto(marauroa.rpeventFactory[\"_default\"], {\r\n\texecute: function(rpobject) {\r\n\t\t// TODO: new TradeStateChangeEvent();\r\n\t}\r\n});\r\n\r\n\r\nmarauroa.rpeventFactory[\"transition_graph\"] = marauroa.util.fromProto(marauroa.rpeventFactory[\"_default\"], {\r\n\texecute: function(rpobject) {\r\n\t\t// TODO: new TransitionGraphEvent();\r\n\t}\r\n});\r\n\r\n\r\nmarauroa.rpeventFactory[\"view_change\"] = marauroa.util.fromProto(marauroa.rpeventFactory[\"_default\"], {\r\n\texecute: function(rpobject) {\r\n\t\t// TODO: new ViewChangeEvent();\r\n\t}\r\n});\r\n// Dummy comment to prevent accidental re-push of a rebase done into the wrong direction\r\n\r\nmarauroa.rpeventFactory[\"bestiary\"] = marauroa.util.fromProto(marauroa.rpeventFactory[\"_default\"], {\r\n\texecute: function(rpobject) {\r\n\t\tif (!this.hasOwnProperty(\"enemies\")) {\r\n\t\t\t// FIXME: proper logging of errors?\r\n\t\t\tconsole.log(\"ERROR: event does not have \\\"enemies\\\" attribute\");\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst title = \"Bestiary\";\r\n\t\tvar header = [\"\\\"???\\\" = unknown\"];\r\n\r\n\t\tconst hasRare = this[\"enemies\"].includes(\"(rare)\");\r\n\t\tconst hasAbnormal = this[\"enemies\"].includes(\"(abnormal)\");\r\n\r\n\t\t// show explanation of \"rare\" & \"abnormal\" creatures in header\r\n\t\tif (hasRare || hasAbnormal) {\r\n\t\t\tvar subheader = \"\";\r\n\t\t\tif (!hasRare) {\r\n\t\t\t\tsubheader += \"\\\"abnormal\\\"\";\r\n\t\t\t} else {\r\n\t\t\t\tsubheader += \"\\\"rare\\\"\";\r\n\t\t\t\tif (hasAbnormal) {\r\n\t\t\t\t\tsubheader += \" and \\\"abnormal\\\"\";\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\theader[1] = subheader + \" creatures not required for achievements\";\r\n\t\t}\r\n\r\n\t\t// spacing for clarity\r\n\t\theader[2] = \"------------------\";\r\n\r\n\t\t// FIXME: hack until a proper window is implemented\r\n\t\tstendhal.ui.chatLog.addLine(\"normal\", title + \":\");\r\n\t\tfor (h of header) {\r\n\t\t\tstendhal.ui.chatLog.addLine(\"normal\", h);\r\n\t\t}\r\n\r\n\t\tconst enemies = this[\"enemies\"].split(\";\");\r\n\t\tfor (e of enemies) {\r\n\t\t\tconst info = e.split(\",\");\r\n\t\t\tconst name = info[0];\r\n\t\t\tvar solo = \" \";\r\n\t\t\tvar shared = \" \";\r\n\t\t\tif (info[1] == \"true\") {\r\n\t\t\t\tsolo = \"\u2714\";\r\n\t\t\t}\r\n\t\t\tif (info[2] == \"true\") {\r\n\t\t\t\tshared = \"\u2714\";\r\n\t\t\t}\r\n\r\n\t\t\t// FIXME: hack until a proper window is implemented\r\n\t\t\tstendhal.ui.chatLog.addLine(\"normal\", name + \":   solo [\" + solo + \"], shared [\" + shared + \"]\");\r\n\t\t}\r\n\t}\r\n});\r\n","/***************************************************************************\r\n *                   (C) Copyright 2015-2017 - Stendhal                    *\r\n ***************************************************************************\r\n *                                                                         *\r\n *   This program is free software; you can redistribute it and/or modify  *\r\n *   it under the terms of the GNU Affero General Public License as        *\r\n *   published by the Free Software Foundation; either version 3 of the    *\r\n *   License, or (at your option) any later version.                       *\r\n *                                                                         *\r\n ***************************************************************************/\r\n\r\n\"use strict\";\r\n\r\nvar marauroa = window.marauroa = window.marauroa || {};\r\nvar stendhal = window.stendhal = window.stendhal || {};\r\nstendhal.ui = stendhal.ui || {};\r\n\r\n/**\r\n * @constructor\r\n */\r\nstendhal.ui.Popup = function(title, content, x, y) {\r\n\r\n\tconst closeSound = \"click-1\";\r\n\r\n\tthis.close = function() {\r\n\t\tif (that.onClose) {\r\n\t\t\tthat.onClose.call(that);\r\n\t\t}\r\n\t\tvar popupcontainer = document.getElementById(\"popupcontainer\");\r\n\t\tif (popupcontainer.contains(that.popupdiv)) {\r\n\t\t\tpopupcontainer.removeChild(that.popupdiv);\r\n\t\t}\r\n\t};\r\n\r\n\tfunction createTitleHtml() {\r\n\t\treturn \"<div class='popuptitle background'><div class='popuptitleclose'>X</div>\" + stendhal.ui.html.esc(title) + \"</div>\";\r\n\t}\r\n\r\n\tfunction onClose(e) {\r\n\t\tthat.close();\r\n\t\te.preventDefault();\r\n\r\n\t\tstendhal.ui.sound.playGlobalizedEffect(closeSound);\r\n\t}\r\n\r\n\t/**\r\n\t * start draging of popup window\r\n\t */\r\n\tfunction onMouseDown(e) {\r\n\t\twindow.addEventListener(\"mousemove\", onMouseMovedDuringDrag, true);\r\n\t\twindow.addEventListener(\"mouseup\", onMouseUpDuringDrag, true);\r\n\t\te.preventDefault();\r\n\t\tvar box = that.popupdiv.getBoundingClientRect();\r\n\t\tthat.offsetX = e.clientX - box.left - window.pageXOffset;\r\n\t\tthat.offsetY = e.clientY - box.top - window.pageYOffset;\r\n\t}\r\n\r\n\t/**\r\n\t * updates position of popup window during drag\r\n\t */\r\n\tfunction onMouseMovedDuringDrag(e) {\r\n\t\tthat.popupdiv.style.left = e.clientX - that.offsetX + 'px';\r\n\t\tthat.popupdiv.style.top = e.clientY - that.offsetY + 'px';\r\n\t}\r\n\r\n\t/**\r\n\t * deregister global event listeners used for dragging popup window\r\n\t */\r\n\tfunction onMouseUpDuringDrag(e) {\r\n\t\twindow.removeEventListener(\"mousemove\", onMouseMovedDuringDrag, true);\r\n\t\twindow.removeEventListener(\"mouseup\", onMouseUpDuringDrag, true);\r\n\t}\r\n\r\n\r\n\tvar that = this;\r\n\tvar popupcontainer = document.getElementById(\"popupcontainer\");\r\n\tthis.popupdiv = document.createElement('div');\r\n\tthis.popupdiv.style.position = \"absolute\";\r\n\tthis.popupdiv.style.left = x + \"px\";\r\n\tthis.popupdiv.style.top = y + \"px\";\r\n\tthis.popupdiv.className = \"popupdiv\";\r\n\tvar temp = content;\r\n\tif (title) {\r\n\t\ttemp = createTitleHtml() + content;\r\n\t}\r\n\tthis.popupdiv.innerHTML = temp;\r\n\tthis.popupdiv.querySelector(\".popuptitle\").addEventListener(\"mousedown\", onMouseDown);\r\n\tthis.popupdiv.querySelector(\".popuptitleclose\").addEventListener(\"click\", onClose);\r\n\tpopupcontainer.appendChild(this.popupdiv);\r\n}\r\n\r\n\r\n/**\r\n * @constructor\r\n */\r\nstendhal.ui.Menu = function(entity, x, y) {\r\n\tif (stendhal.ui.globalpopup) {\r\n\t\tstendhal.ui.globalpopup.popup.close();\r\n\t}\r\n\r\n\tvar actions = [];\r\n\tvar that = this;\r\n\tentity.buildActions(actions);\r\n\tif (marauroa.me[\"adminlevel\"] && marauroa.me[\"adminlevel\"] >= 600) {\r\n\t\tactions.push({\r\n\t\t\ttitle: \"(*) Inspect\",\r\n\t\t\taction: function(entity) {\r\n\t\t\t\tconsole.log(entity);\r\n\t\t\t}\r\n\t\t});\r\n\t\t// FIXME: cannot destroy items equipped in player's inventory slots\r\n\t\tactions.push({\r\n\t\t\ttitle: \"(*) Destroy\",\r\n\t\t\taction: function(entity) {\r\n\t\t\t\tvar action = {\r\n\t\t\t\t\t\"type\": \"destroy\",\r\n\t\t\t\t\t\"target\": \"#\" + entity[\"id\"],\r\n\t\t\t\t}\r\n\t\t\t\tmarauroa.clientFramework.sendAction(action);\r\n\t\t\t}\r\n\t\t});\r\n\t\tactions.push({\r\n\t\t\ttitle: \"(*) Alter\",\r\n\t\t\taction: function(entity) {\r\n\t\t\t\tstendhal.ui.chatinput.setText(\"/alter #\"\r\n\t\t\t\t\t\t+ entity[\"id\"]\r\n\t\t\t\t\t\t+ \" \");\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\tvar content = \"<div class=\\\"actionmenu\\\">\";\r\n\tfor (var i = 0; i < actions.length; i++) {\r\n\t\tcontent += \"<button id=\\\"actionbutton.\" + i + \"\\\">\" + stendhal.ui.html.esc(actions[i].title) + \"</button><br>\";\r\n\t}\r\n\tcontent += \"</div>\";\r\n\tthis.popup = new stendhal.ui.Popup(\"Action\", content, x, y);\r\n\r\n\tthis.popup.popupdiv.addEventListener(\"click\", function(e) {\r\n\t\tvar i = e.target.id.substring(13);\r\n\t\tif (i === undefined || i === \"\" || i < 0) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tthat.popup.close();\r\n\r\n\t\tif (actions && i < actions.length) {\r\n\t\t\tif (actions[i].action) {\r\n\t\t\t\tactions[i].action(entity);\r\n\t\t\t} else {\r\n\t\t\t\tvar action = {\r\n\t\t\t\t\t\"type\": actions[i].type,\r\n\t\t\t\t\t\"target_path\": entity.getIdPath(),\r\n\t\t\t\t\t\"zone\": marauroa.currentZoneName\r\n\t\t\t\t};\r\n\t\t\t\t// for top level entities, include \"target\", which is required for example on attack-action\r\n\t\t\t\tif ('[' + entity.id + ']' === entity.getIdPath()) {\r\n\t\t\t\t\taction['target'] = '#' + entity.id;\r\n\t\t\t\t}\r\n\t\t\t\tmarauroa.clientFramework.sendAction(action);\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n\r\n\tthis.close = function() {\r\n\t\tthis.popup.close();\r\n\t\tstendhal.ui.globalpopup = null;\r\n\t}\r\n\tstendhal.ui.globalpopup = this;\r\n}\r\n\r\n\r\n/**\r\n * @constructor\r\n */\r\nstendhal.ui.DropNumberDialog = function(action, x, y) {\r\n\tif (stendhal.ui.globalpopup) {\r\n\t\tstendhal.ui.globalpopup.popup.close();\r\n\t}\r\n\r\n\tthis.action = action;\r\n\tvar content = \"<input type=\\\"number\\\" min=\\\"0\\\" value=\\\"1\\\" id=\\\"dropnumberdialogvalue\\\"><button id=\\\"dropnumberdialogbutton\\\">Drop</button>\";\r\n\tthis.popup = new stendhal.ui.Popup(\"Quantity\", content, x, y);\r\n\r\n\tvar that = this;\r\n\tdocument.getElementById(\"dropnumberdialogbutton\").addEventListener(\"click\", function(e) {\r\n\t\tvar quantity = document.getElementById(\"dropnumberdialogvalue\").value;\r\n\t\tif (quantity && quantity > 0) {\r\n\t\t\tthat.action[\"quantity\"] = quantity;\r\n\t\t\tmarauroa.clientFramework.sendAction(that.action);\r\n\t\t}\r\n\t\tthat.popup.close();\r\n\t});\r\n\r\n\tthis.close = function() {\r\n\t\tthis.popup.close();\r\n\t\tstendhal.ui.globalpopup = null;\r\n\t}\r\n\tdocument.getElementById(\"dropnumberdialogvalue\").focus();\r\n\tstendhal.ui.globalpopup = this;\r\n}\r\n\r\n\r\n/**\r\n * @constructor\r\n */\r\nstendhal.ui.ImageViewer = function(title, caption, path) {\r\n\tif (stendhal.ui.globalpopup) {\r\n\t\tstendhal.ui.globalpopup.popup.close();\r\n\t}\r\n\r\n\tvar content = \"<h3>\" + stendhal.ui.html.esc(caption) + \"</h3><img src=\\\"\" + stendhal.ui.html.esc(path) + \"\\\">\";\r\n\tthis.popup = new stendhal.ui.Popup(title, content, 100, 50);\r\n\r\n\tthis.close = function() {\r\n\t\tthis.popup.close();\r\n\t\tstendhal.ui.globalpopup = null;\r\n\t}\r\n\tstendhal.ui.globalpopup = this;\r\n}\r\n","/***************************************************************************\r\n *                   (C) Copyright 2003-2021 - Stendhal                    *\r\n ***************************************************************************\r\n *                                                                         *\r\n *   This program is free software; you can redistribute it and/or modify  *\r\n *   it under the terms of the GNU Affero General Public License as        *\r\n *   published by the Free Software Foundation; either version 3 of the    *\r\n *   License, or (at your option) any later version.                       *\r\n *                                                                         *\r\n ***************************************************************************/\r\n\r\n\"use strict\";\r\n\r\nvar marauroa = window.marauroa = window.marauroa || {};\r\nvar stendhal = window.stendhal = window.stendhal || {};\r\nstendhal.ui = stendhal.ui || {};\r\n\r\n\r\n/**\r\n * slot name, slot size, object (a corpse or chest) or null for marauroa.me,\r\n * which changes on zone change.\r\n *\r\n * @constructor\r\n */\r\nstendhal.ui.ItemContainerWindow = function(slot, size, object, suffix, quickPickup, defaultImage) {\r\n\tthis.update = function() {\r\n\t\trender();\r\n\t};\r\n\r\n\tfunction render() {\r\n\t\tvar myobject = object || marauroa.me;\r\n\t\tvar cnt = 0;\r\n\t\tif (myobject[slot]) {\r\n\t\t\tfor (var i = 0; i < myobject[slot].count(); i++) {\r\n\t\t\t\tvar o = myobject[slot].getByIndex(i);\r\n\t\t\t\tvar e = document.getElementById(slot + suffix + cnt);\r\n\t\t\t\te.style.backgroundImage = \"url(/data/sprites/items/\" + o[\"class\"] + \"/\" + o[\"subclass\"] + \".png \" + \")\";\r\n\t\t\t\te.textContent = o.formatQuantity();\r\n\t\t\t\te.dataItem = o;\r\n\t\t\t\tcnt++;\r\n\t\t\t}\r\n\t\t}\r\n\t\tfor (var i = cnt; i < size; i++) {\r\n\t\t\tvar e = document.getElementById(slot + suffix + i);\r\n\t\t\tif (defaultImage) {\r\n\t\t\t\te.style.backgroundImage = \"url(/data/gui/\" + defaultImage + \")\";\r\n\t\t\t} else {\r\n\t\t\t\te.style.backgroundImage = \"none\";\r\n\t\t\t}\r\n\t\t\te.textContent = \"\";\r\n\t\t\te.dataItem = null;\r\n\t\t}\r\n\t}\r\n\r\n\tfunction onDragStart(e) {\r\n\t\tvar myobject = object || marauroa.me;\r\n\t\tif (!myobject[slot]) {\r\n\t\t\te.preventDefault();\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tvar slotNumber = e.target.id.slice(slot.length + suffix.length);\r\n\t\tvar item = myobject[slot].getByIndex(slotNumber);\r\n\t\tif (item) {\r\n\t\t\tvar img = stendhal.data.sprites.getAreaOf(stendhal.data.sprites.get(item.sprite.filename), 32, 32);\r\n\t\t\twindow.event = e; // required by setDragImage polyfil\r\n\t\t\te.dataTransfer.setDragImage(img, 0, 0);\r\n\t\t\te.dataTransfer.setData(\"Text\", JSON.stringify({\r\n\t\t\t\tpath: item.getIdPath(),\r\n\t\t\t\tzone: marauroa.currentZoneName\r\n\t\t\t}));\r\n\t\t} else {\r\n\t\t\te.preventDefault();\r\n\t\t}\r\n\t}\r\n\r\n\tfunction onDragOver(e) {\r\n\t\te.preventDefault();\r\n\t\te.dataTransfer.dropEffect = \"move\";\r\n\t\treturn false;\r\n\t}\r\n\r\n\tfunction onDrop(e) {\r\n\t\tvar myobject = object || marauroa.me;\r\n\t\tvar datastr = e.dataTransfer.getData(\"Text\") || e.dataTransfer.getData(\"text/x-stendhal\");\r\n\t\tif (datastr) {\r\n\t\t\tvar data = JSON.parse(datastr);\r\n\t\t\tvar targetPath = \"[\" + myobject[\"id\"] + \"\\t\" + slot + \"]\";\r\n\t\t\tvar action = {\r\n\t\t\t\t\"type\": \"equip\",\r\n\t\t\t\t\"source_path\": data.path,\r\n\t\t\t\t\"target_path\": targetPath,\r\n\t\t\t\t\"zone\" : data.zone\r\n\t\t\t};\r\n\t\t\t// if ctrl is pressed, we ask for the quantity\r\n\t\t\tif (e.ctrlKey) {\r\n\t\t\t\tnew stendhal.ui.DropNumberDialog(action, e.pageX - 50, e.pageY - 25);\r\n\t\t\t} else {\r\n\t\t\t\tmarauroa.clientFramework.sendAction(action);\r\n\t\t\t}\r\n\t\t}\r\n\t\te.stopPropagation();\r\n\t\te.preventDefault();\r\n\t}\r\n\r\n\tfunction onContextMenu(e) {\r\n\t\te.preventDefault();\r\n\t}\r\n\r\n\tfunction isRightClick(e) {\r\n\t\tif (+new Date() - stendhal.ui.timestampMouseDown > 300) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\tif (e.which) {\r\n\t\t\treturn (e.which === 3);\r\n\t\t} else {\r\n\t\t\treturn (e.button === 2);\r\n\t\t}\r\n\t}\r\n\r\n\tfunction onMouseDown(e) {\r\n\t\tstendhal.ui.timestampMouseDown = +new Date();\r\n\t}\r\n\r\n\tfunction onMouseUp(e) {\r\n\t\te.preventDefault();\r\n\t\tlet event = stendhal.ui.html.extractPosition(e);\r\n\t\tif (event.target.dataItem) {\r\n\t\t\tif (quickPickup) {\r\n\t\t\t\tmarauroa.clientFramework.sendAction({\r\n\t\t\t\t\ttype: \"equip\",\r\n\t\t\t\t\t\"source_path\": event.target.dataItem.getIdPath(),\r\n\t\t\t\t\t\"target_path\": \"[\" + marauroa.me[\"id\"] + \"\\tbag]\",\r\n\t\t\t\t\t\"clicked\": \"\", // useful for changing default target in equip action\r\n\t\t\t\t\t\"zone\": marauroa.currentZoneName\r\n\t\t\t\t});\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tif (isRightClick(e)) {\r\n\t\t\t\tnew stendhal.ui.Menu(event.target.dataItem, event.pageX - 50, event.pageY - 5);\r\n\t\t\t} else {\r\n\t\t\t\tmarauroa.clientFramework.sendAction({\r\n\t\t\t\t\ttype: \"use\",\r\n\t\t\t\t\t\"target_path\": event.target.dataItem.getIdPath(),\r\n\t\t\t\t\t\"zone\": marauroa.currentZoneName\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t\tdocument.getElementById(\"gamewindow\").focus();\r\n\t}\r\n\r\n\tfor (var i = 0; i < size; i++) {\r\n\t\tvar e = document.getElementById(slot + suffix + i);\r\n\t\te.setAttribute(\"draggable\", true);\r\n\t\te.addEventListener(\"dragstart\", onDragStart);\r\n\t\te.addEventListener(\"dragover\", onDragOver);\r\n\t\te.addEventListener(\"drop\", onDrop);\r\n\t\te.addEventListener(\"mousedown\", onMouseDown);\r\n\t\te.addEventListener(\"mouseup\", onMouseUp);\r\n\t\te.addEventListener(\"touchstart\", onMouseDown);\r\n\t\te.addEventListener(\"touchend\", onMouseUp);\r\n\t\te.addEventListener(\"contextmenu\", onContextMenu);\r\n\t}\r\n};\r\n\r\n\r\nstendhal.ui.equip = {\r\n\tslotNames: [\"head\", \"lhand\", \"rhand\", \"finger\", \"armor\", \"cloak\", \"legs\", \"feet\", \"pouch\", \"bag\", \"keyring\", \"portfolio\"],\r\n\tslotSizes: [   1,       1,      1,       1,        1,       1,       1,     1,       1,      12,       8,         9     ],\r\n\tslotImages: [\"slot-helmet.png\", \"slot-shield.png\", \"slot-weapon.png\", \"slot-ring.png\", \"slot-armor.png\", \"slot-cloak.png\",\r\n\t\t\"slot-legs.png\", \"slot-boots.png\", \"slot-pouch.png\", null, \"slot-key.png\", \"slot-portfolio.png\"],\r\n\tcounter: 0,\r\n\r\n\tpouchVisible: false,\r\n\r\n\tinit: function() {\r\n\t\tstendhal.ui.equip.inventory = [];\r\n\t\tfor (var i in this.slotNames) {\r\n\t\t\tstendhal.ui.equip.inventory.push(\r\n\t\t\t\tnew stendhal.ui.ItemContainerWindow(\r\n\t\t\t\t\tthis.slotNames[i], this.slotSizes[i], null, \"\", false, this.slotImages[i]));\r\n\t\t}\r\n\r\n\t\t// hide pouch by default\r\n\t\tstendhal.ui.showPouch(false);\r\n\t},\r\n\r\n\tupdate: function() {\r\n\t\tfor (var i in this.inventory) {\r\n\t\t\tstendhal.ui.equip.inventory[i].update();\r\n\t\t}\r\n\r\n\t\tif (!this.pouchVisible) {\r\n\t\t\tvar features = null\r\n\t\t\tif (marauroa.me != null) {\r\n\t\t\t\tfeatures = marauroa.me[\"features\"];\r\n\t\t\t}\r\n\r\n\t\t\tif (features != null) {\r\n\t\t\t\tif (features[\"pouch\"] != null) {\r\n\t\t\t\t\tstendhal.ui.showPouch(true);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\tcreateInventoryWindow: function(slot, sizeX, sizeY, object, title, quickPickup) {\r\n\t\tstendhal.ui.equip.counter++;\r\n\t\tvar suffix = \".\" + stendhal.ui.equip.counter + \".\";\r\n\t\tvar html = \"<div class=\\\"inventorypopup inventorypopup_\" + sizeX;\r\n\t\tif (quickPickup) {\r\n\t\t\thtml += \" quickPickup\";\r\n\t\t}\r\n\t\thtml += \"\\\">\";\r\n\t\tfor (var i = 0; i < sizeX * sizeY; i++) {\r\n\t\t\thtml += \"<div id='\" + slot + suffix + i + \"' class='itemSlot'></div>\";\r\n\t\t}\r\n\t\thtml += \"</div>\";\r\n\r\n\t\tvar popup = new stendhal.ui.Popup(title, html, 160, 370);\r\n\t\tvar itemContainer = new stendhal.ui.ItemContainerWindow(slot, sizeX * sizeY, object, suffix, quickPickup, null);\r\n\t\tstendhal.ui.equip.inventory.push(itemContainer);\r\n\t\titemContainer.update();\r\n\t\tpopup.onClose = function() {\r\n\t\t\tstendhal.ui.equip.inventory.splice(stendhal.ui.equip.inventory.indexOf(itemContainer), 1);\r\n\t\t}\r\n\t\treturn popup;\r\n\t}\r\n};\r\n\r\nstendhal.ui.showSlot = function(id, show) {\r\n\tvar slot = document.getElementById(id);\r\n\tvar prevState = slot.style.display;\r\n\r\n\tif (show === true) {\r\n\t\tslot.style.display = \"block\";\r\n\t} else {\r\n\t\tslot.style.display = \"none\";\r\n\t}\r\n\r\n\treturn prevState != slot.style.display;\r\n};\r\n\r\nstendhal.ui.showPouch = function(show) {\r\n\tif (stendhal.ui.showSlot(\"pouch0\", show)) {\r\n\t\t// resize the inventory window\r\n\t\tvar equip = document.getElementById(\"equipment\");\r\n\t\tif (show) {\r\n\t\t\tequip.style.height = \"200px\";\r\n\t\t} else {\r\n\t\t\tequip.style.height = \"160px\";\r\n\t\t}\r\n\t\tpouchVisible = show;\r\n\t}\r\n}\r\n\r\nstendhal.ui.equip.init();\r\n","/***************************************************************************\r\n *                   (C) Copyright 2003-2018 - Stendhal                    *\r\n ***************************************************************************\r\n *                                                                         *\r\n *   This program is free software; you can redistribute it and/or modify  *\r\n *   it under the terms of the GNU Affero General Public License as        *\r\n *   published by the Free Software Foundation; either version 3 of the    *\r\n *   License, or (at your option) any later version.                       *\r\n *                                                                         *\r\n ***************************************************************************/\r\n\r\n\"use strict\";\r\n\r\nwindow.marauroa = window.marauroa || {};\r\nwindow.stendhal = window.stendhal || {};\r\nstendhal.ui = stendhal.ui || {};\r\n\r\n/**\r\n * game window aka world view\r\n */\r\nstendhal.ui.menu = {\r\n\r\n\tonOpenAppMenu: function(e) {\r\n\t\tif (stendhal.ui.globalpopup) {\r\n\t\t\tstendhal.ui.globalpopup.popup.close();\r\n\t\t}\r\n\r\n\t\tvar actions = [\r\n\t\t\t{\r\n\t\t\t\ttitle: \"Account\",\r\n\t\t\t\tchildren: [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\ttitle: \"Change Password\",\r\n\t\t\t\t\t\taction: \"changepassword\",\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\ttitle: \"Select character\",\r\n\t\t\t\t\t\taction: \"characterselector\",\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\ttitle: \"Login History\",\r\n\t\t\t\t\t\taction: \"loginhistory\",\r\n\t\t\t\t\t}\r\n\t\t\t\t]\r\n\t\t\t},\r\n/*\r\n\t\t\t{\r\n\t\t\t\ttitle: \"Tools\",\r\n\t\t\t\tchildren: [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\ttitle: \"Take Screenshot\",\r\n\t\t\t\t\t\taction: \"takescreenshot\",\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\ttitle: \"Settings\",\r\n\t\t\t\t\t\taction: \"settings\",\r\n\t\t\t\t\t}\r\n\t\t\t\t]\r\n\t\t\t},\r\n*/\r\n\t\t\t{\r\n\t\t\t\ttitle: \"Commands\",\r\n\t\t\t\tchildren: [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\ttitle: \"Atlas\",\r\n\t\t\t\t\t\taction: \"atlas\",\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\ttitle: \"Online Players\",\r\n\t\t\t\t\t\taction: \"who\",\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\ttitle: \"Hall of Fame\",\r\n\t\t\t\t\t\taction: \"halloffame\",\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\ttitle: \"Travel Log\",\r\n\t\t\t\t\t\taction: \"progressstatus\",\r\n\t\t\t\t\t}\r\n\t\t\t\t]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\ttitle: \"Help\",\r\n\t\t\t\tchildren: [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\ttitle: \"Manual\",\r\n\t\t\t\t\t\taction: \"manual\",\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\ttitle: \"FAQ\",\r\n\t\t\t\t\t\taction: \"faq\",\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\ttitle: \"Beginners Guide\",\r\n\t\t\t\t\t\taction: \"beginnersguide\",\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\ttitle: \"Commands\",\r\n\t\t\t\t\t\taction: \"help\",\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\ttitle: \"Rules\",\r\n\t\t\t\t\t\taction: \"rules\",\r\n\t\t\t\t\t}\r\n\t\t\t\t]\r\n\t\t\t},\r\n\t\t]\r\n\t\tvar that = this;\r\n\r\n\t\tvar content = \"<div class=\\\"actionmenu\\\">\";\r\n\t\tfor (var i = 0; i < actions.length; i++) {\r\n\t\t\tcontent += \"<div class=\\\"inlineblock\\\"><h4 class=\\\"menugroup\\\">\" + stendhal.ui.html.esc(actions[i].title) + \"</h4>\"\r\n\t\t\tfor (var j = 0; j < actions[i].children.length; j++) {\r\n\t\t\t\tcontent += \"<button id=\\\"menubutton.\" + actions[i].children[j].action + \"\\\">\" + stendhal.ui.html.esc(actions[i].children[j].title) + \"</button><br>\";\r\n\t\t\t}\r\n\t\t\tcontent += \"</div>\";\r\n\t\t}\r\n\t\tcontent += \"</div>\";\r\n\t\tthis.popup = new stendhal.ui.Popup(\"Action\", content, 150, e.pageY + 20);\r\n\r\n\t\tthis.popup.popupdiv.addEventListener(\"click\", function(e) {\r\n\t\t\tvar cmd = e.target.id.substring(11);\r\n\t\t\tthat.popup.close();\r\n\t\t\tif (cmd) {\r\n\t\t\t\tstendhal.slashActionRepository.execute(\"/\" + cmd);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tthis.close = function() {\r\n\t\t\tthis.popup.close();\r\n\t\t\tstendhal.ui.globalpopup = null;\r\n\t\t}\r\n\t\tstendhal.ui.globalpopup = this;\r\n\t}\r\n\r\n}\r\n","\"use strict\";\r\n\r\nvar marauroa = window.marauroa = window.marauroa || {};\r\nvar stendhal = window.stendhal = window.stendhal || {};\r\nstendhal.ui = stendhal.ui || {};\r\n\r\n\r\nstendhal.ui.outfitCount = {\r\n\t\"hat\": 14,\r\n\t\"hair\": 48,\r\n\t\"mask\": 9,\r\n\t\"eyes\": 26,\r\n\t\"mouth\": 5,\r\n\t\"head\":  4,\r\n\t\"dress\": 63,\r\n\t\"body\": 3\r\n}\r\n\r\nstendhal.ui.OutfitDialog = function() {\r\n\tif (stendhal.ui.OutfitDialog.instance != null) {\r\n\t\treturn;\r\n\t}\r\n\tconst self = this;\r\n\r\n\tclass PartSelector {\r\n\t\tconstructor(part, initialIndex, maxindex, onPartChanged) {\r\n\t\t\tthis._part = part;\r\n\t\t\tthis._onPartChanged = onPartChanged;\r\n\t\t\tthis._index = initialIndex;\r\n\t\t\tthis._maxindex = maxindex;\r\n\r\n\t\t\tconst canvas = document.getElementById('setoutfit' + part + 'canvas');\r\n\t\t\tcanvas.style.margin = \"5px\";\r\n\t\t\tthis._ctx = canvas.getContext(\"2d\");\r\n\t\t\tthis._width = canvas.width;\r\n\t\t\tthis._height = canvas.height;\r\n\t\t\tthis._color = null;\r\n\t\t\tthis._image = null;\r\n\t\t}\r\n\r\n\t\tdraw() {\r\n\t\t\tconst image = this._getPartSprite(this._part, this._index, this._color);\r\n\t\t\tthis._image = image;\r\n\t\t\tthis._ctx.fillStyle = \"white\";\r\n\t\t\tthis._ctx.fillRect(0, 0, this._width, this._height);\r\n\r\n\t\t\timage.then((img) => {\r\n\t\t\t\tthis._ctx.drawImage(img, -48, -128);\r\n\t\t\t\tthis._onPartChanged();\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tget image() {\r\n\t\t\treturn this._image;\r\n\t\t}\r\n\r\n\t\tget index() {\r\n\t\t\treturn indexString(this._index);\r\n\t\t}\r\n\r\n\t\tset index(newIndex) {\r\n\t\t\tthis._index = newIndex;\r\n\t\t\tthis.draw();\r\n\t\t}\r\n\r\n\t\tset color(newColor) {\r\n\t\t\tthis._color = newColor;\r\n\t\t\tthis.draw();\r\n\t\t}\r\n\r\n\t\tprevious() {\r\n\t\t\tconst numOutfits = this._maxindex + 1;\r\n\t\t\tthis._index += this._maxindex;\r\n\t\t\tthis._index %= numOutfits;\r\n\t\t\tthis.draw();\r\n\t\t\tthis._onPartChanged();\r\n\t\t}\r\n\r\n\t\tnext() {\r\n\t\t\tconst numOutfits = this._maxindex + 1;\r\n\t\t\tthis._index++;\r\n\t\t\tthis._index %= numOutfits;\r\n\t\t\tthis.draw();\r\n\t\t\tthis._onPartChanged();\r\n\t\t}\r\n\r\n\t\t_getPartSprite(part, index, color = null) {\r\n\t\t\tconst fname = \"/data/sprites/outfit/\" + part + \"/\" + part + \"_\" + indexString(index) + \".png\";\r\n\t\t\tif (color != null) {\r\n\t\t\t\treturn stendhal.data.sprites.getFilteredWithPromise(fname, \"trueColor\", color);\r\n\t\t\t}\r\n\t\t\treturn stendhal.data.sprites.getWithPromise(fname);\r\n\t\t}\r\n\t}\r\n\r\n\tclass ColorSelector {\r\n\t\tconstructor(canvas, gradientCanvas, onColorChanged) {\r\n\t\t\tthis.ctx = canvas.getContext(\"2d\");\r\n\t\t\tthis.gradCtx = gradientCanvas.getContext(\"2d\");\r\n\t\t\tthis.baseImage = this._createBaseImage(canvas.width, canvas.height);\r\n\t\t\tthis.onColorChanged = onColorChanged;\r\n\t\t\tthis._enabled = false;\r\n\t\t\tthis.x = this.baseImage.width / 2;\r\n\t\t\tthis.y = this.baseImage.height / 2;\r\n\t\t\tthis.hX = this.x;\r\n\t\t\tcanvas.addEventListener(\"mousedown\", (e) => this._onMouseDown(e));\r\n\t\t\tcanvas.addEventListener(\"mousemove\", (e) => this._onMouseMove(e));\r\n\r\n\t\t\tgradientCanvas.addEventListener(\"mousedown\", (e) => this._onMouseDownGrad(e));\r\n\t\t\tgradientCanvas.addEventListener(\"mousemove\", (e) => this._onMouseMoveGrad(e));\r\n\t\t\tgradientCanvas.style.margin = \"5px 0px 0px 0px\";\r\n\t\t}\r\n\r\n\t\tset enabled(value) {\r\n\t\t\tthis._enabled = value ? true : false;\r\n\t\t\tthis.draw();\r\n\t\t\tthis.onColorChanged(this.color);\r\n\t\t}\r\n\r\n\t\tget enabled() {\r\n\t\t\treturn this._enabled;\r\n\t\t}\r\n\r\n\t\tget color() {\r\n\t\t\tif (this.enabled) {\r\n\t\t\t\tconst hsl = [this.x / this.baseImage.width, 1 - this.y / this.baseImage.height,\r\n\t\t\t\t\tthis.hX / this.baseImage.width];\r\n\t\t\t\tconst rgbArray = stendhal.data.sprites.filter.hsl2rgb(hsl);\r\n\t\t\t\treturn stendhal.data.sprites.filter.mergergb(rgbArray);\r\n\t\t\t}\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tset color(rgb) {\r\n\t\t\tif (rgb != null) {\r\n\t\t\t\tconst hsl = stendhal.data.sprites.filter.rgb2hsl(stendhal.data.sprites.filter.splitrgb(rgb));\r\n\t\t\t\tthis.x = hsl[0] * this.baseImage.width;\r\n\t\t\t\tthis.y = (1 - hsl[1]) * this.baseImage.height;\r\n\t\t\t\tthis.hX = hsl[2] * this.baseImage.width;\r\n\t\t\t\tthis.enabled = true;\r\n\t\t\t} else {\r\n\t\t\t\tthis.enabled = false;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t_createBaseImage(width, height) {\r\n\t\t\tconst img = document.createElement(\"canvas\");\r\n\t\t\timg.width  = width;\r\n\t\t\timg.height = height;\r\n\t\t\tconst ctx = img.getContext(\"2d\");\r\n\t\t\tfor (let x = 0; x < width; x++) {\r\n\t\t\t\tfor (let y = 0; y < height; y++) {\r\n\t\t\t\t\tconst hsl = [x / width, 1 - y / height, 0.5];\r\n\t\t\t\t\tconst rgb = stendhal.data.sprites.filter.hsl2rgb(hsl);\r\n\t\t\t\t\tctx.fillStyle = this._rgbToCssString(rgb);\r\n\t\t\t\t\tctx.fillRect(x, y, 1, 1);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn img;\r\n\t\t}\r\n\r\n\t\t_rgbToCssString(rgb) {\r\n\t\t\treturn \"rgb(\".concat(rgb[0], \",\", rgb[1], \",\", rgb[2], \")\");\r\n\t\t}\r\n\r\n\t\tdraw() {\r\n\t\t\tif (this.enabled) {\r\n\t\t\t\tthis.ctx.drawImage(this.baseImage, 0, 0);\r\n\t\t\t\tthis._drawSelection();\r\n\t\t\t} else {\r\n\t\t\t\tthis.ctx.fillStyle = \"gray\";\r\n\t\t\t\tthis.ctx.fillRect(0, 0, this.baseImage.width, this.baseImage.height);\r\n\t\t\t}\r\n\t\t\tthis._drawGradientPart();\r\n\t\t}\r\n\r\n\t\t_drawSelection() {\r\n\t\t\tthis.ctx.strokeStyle = \"black\";\r\n\t\t\tthis.ctx.beginPath();\r\n\t\t\tthis.ctx.moveTo(this.x, 0);\r\n\t\t\tthis.ctx.lineTo(this.x, this.baseImage.height);\r\n\t\t\tthis.ctx.moveTo(0, this.y);\r\n\t\t\tthis.ctx.lineTo(this.baseImage.width, this.y);\r\n\t\t\tthis.ctx.stroke();\r\n\t\t}\r\n\r\n\t\t_drawGradientPart() {\r\n\t\t\tif (this.enabled) {\r\n\t\t\t\tconst gradient = this.gradCtx.createLinearGradient(0, 0, this.baseImage.width, 0);\r\n\t\t\t\tconst stops = this._calculateGradientStops();\r\n\t\t\t\tgradient.addColorStop(0, this._rgbToCssString(stops[0]));\r\n\t\t\t\tgradient.addColorStop(0.5, this._rgbToCssString(stops[1]));\r\n\t\t\t\tgradient.addColorStop(1, this._rgbToCssString(stops[2]));\r\n\r\n\t\t\t\tconst ctx = this.gradCtx;\r\n\t\t\t\tctx.fillStyle = gradient;\r\n\t\t\t\tctx.fillRect(0, 0, this.baseImage.width, 10);\r\n\r\n\t\t\t\tctx.fillStyle = \"black\";\r\n\t\t\t\tctx.beginPath();\r\n\t\t\t\tctx.moveTo(this.hX, 0);\r\n\t\t\t\tctx.lineTo(this.hX, 10);\r\n\t\t\t\tctx.stroke();\r\n\t\t\t} else {\r\n\t\t\t\tthis.gradCtx.fillStyle = \"gray\";\r\n\t\t\t\tthis.gradCtx.fillRect(0, 0, this.baseImage.width, 10);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t_calculateGradientStops() {\r\n\t\t\tconst width = this.baseImage.width;\r\n\t\t\tconst height = this.baseImage.height;\r\n\t\t\tconst hslLeft = [this.x / width, 1 - this.y / height, 0.08];\r\n\t\t\tconst hslMiddle = [this.x / width, 1 - this.y / height, 0.5];\r\n\t\t\tconst hslRight = [this.x / width, 1 - this.y / height, 0.92];\r\n\t\t\tconst rgbLeft = stendhal.data.sprites.filter.hsl2rgb(hslLeft);\r\n\t\t\tconst rgbMiddle = stendhal.data.sprites.filter.hsl2rgb(hslMiddle);\r\n\t\t\tconst rgbRight = stendhal.data.sprites.filter.hsl2rgb(hslRight);\r\n\r\n\t\t\treturn [rgbLeft, rgbMiddle, rgbRight];\r\n\t\t}\r\n\r\n\t\t_onMouseDown(event) {\r\n\t\t\tif (!this.enabled) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tthis.x = event.offsetX;\r\n\t\t\tthis.y = event.offsetY;\r\n\t\t\tthis.draw();\r\n\t\t\tthis.onColorChanged(this.color);\r\n\t\t}\r\n\r\n\t\t_onMouseMove(event) {\r\n\t\t\tif (event.buttons) {\r\n\t\t\t\tthis._onMouseDown(event);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t_onMouseDownGrad(event) {\r\n\t\t\tif (!this.enabled) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tthis.hX = event.offsetX;\r\n\t\t\tthis.draw();\r\n\t\t\tthis.onColorChanged(this.color);\r\n\t\t}\r\n\r\n\t\t_onMouseMoveGrad(event) {\r\n\t\t\tif (event.buttons) {\r\n\t\t\t\tthis._onMouseDownGrad(event);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tclass PaletteColorSelector extends ColorSelector {\r\n\t\tconstructor(canvas, gradientCanvas, onColorChanged) {\r\n\t\t\tsuper(canvas, gradientCanvas, onColorChanged);\r\n\t\t\tthis._blockWidth = this.baseImage.width / 4;\r\n\t\t\tthis._blockHeight = this.baseImage.height / 4;\r\n\t\t\tthis._x = 0;\r\n\t\t\tthis._y = 0;\r\n\t\t\tthis.hX = this.baseImage.width / 2;\r\n\t\t\t// These are stupid, but they make closure compiler shut up about\r\n\t\t\t// undefined properties. (And there's no standard way to define\r\n\t\t\t// fields in JS, duh).\r\n\t\t\tthis._colorMap = this._colorMap;\r\n\t\t\tthis._hsMap = this._hsMap;\r\n\t\t}\r\n\r\n\t\tset x(newX) {\r\n\t\t\tthis._x = Math.floor(newX / this._blockWidth);\r\n\t\t}\r\n\r\n\t\tget x() {\r\n\t\t\treturn this._x;\r\n\t\t}\r\n\r\n\t\tset y(newY) {\r\n\t\t\tthis._y = Math.floor(newY / this._blockHeight);\r\n\t\t}\r\n\r\n\t\tget y() {\r\n\t\t\treturn this._y;\r\n\t\t}\r\n\r\n\t\tget color() {\r\n\t\t\tif (this.enabled) {\r\n\t\t\t\tconst hs = this._hsMap[this.x][this.y];\r\n\t\t\t\tconst hsl = [hs[0], hs[1], this.hX / this.baseImage.width];\r\n\t\t\t\tconst rgbArray = stendhal.data.sprites.filter.hsl2rgb(hsl);\r\n\t\t\t\treturn stendhal.data.sprites.filter.mergergb(rgbArray);\r\n\t\t\t}\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tset color(rgb) {\r\n\t\t\tif (rgb != null) {\r\n\t\t\t\tthis.enabled = true;\r\n\t\t\t\tconst hsl = stendhal.data.sprites.filter.rgb2hsl(stendhal.data.sprites.filter.splitrgb(rgb));\r\n\t\t\t\tthis.hX = hsl[2] * this.baseImage.width;\r\n\t\t\t\tlet bestDelta = Number.MAX_VALUE;\r\n\t\t\t\tfor (let i = 0; i < 4; i++) {\r\n\t\t\t\t\tfor (let j = 0; j < 4; j++) {\r\n\t\t\t\t\t\tconst hs = this._hsMap[i][j];\r\n\t\t\t\t\t\tconst hueDelta = hs[0] - hsl[0];\r\n\t\t\t\t\t\tconst satDelta = hs[1] - hsl[1];\r\n\t\t\t\t\t\tconst delta = (hueDelta * hueDelta) + (satDelta * satDelta);\r\n\t\t\t\t\t\tif (delta < bestDelta) {\r\n\t\t\t\t\t\t\tbestDelta = delta;\r\n\t\t\t\t\t\t\tthis._x = i;\r\n\t\t\t\t\t\t\tthis._y = j;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tthis.enabled = false;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t_createColorMap() {\r\n\t\t\tconst hues = [0.05, 0.07, 0.09, 0.11];\r\n\t\t\tconst saturations = [0.70, 0.55, 0.40, 0.25];\r\n\t\t\tconst hsMap = [[],[],[],[]];\r\n\t\t\tconst colors = [[],[],[],[]];\r\n\t\t\tfor (let i = 0; i < 4; i++) {\r\n\t\t\t\tfor (let j = 0; j < 4; j++) {\r\n\t\t\t\t\tconst hue = hues[j];\r\n\t\t\t\t\tconst sat = saturations[i];\r\n\t\t\t\t\thsMap[i].push([hue, sat]);\r\n\t\t\t\t\tconst color = stendhal.data.sprites.filter.hsl2rgb([hue, sat, 0.5]);\r\n\t\t\t\t\tcolors[i].push(color);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis._hsMap = hsMap;\r\n\t\t\tthis._colorMap = colors;\r\n\t\t}\r\n\r\n\t\t_createBaseImage(width, height) {\r\n\t\t\tthis._createColorMap();\r\n\t\t\tconst img = document.createElement(\"canvas\");\r\n\t\t\timg.width  = width;\r\n\t\t\timg.height = height;\r\n\t\t\tconst ctx = img.getContext(\"2d\");\r\n\r\n\t\t\tconst blockWidth = width / 4;\r\n\t\t\tconst blockHeight = height / 4;\r\n\r\n\t\t\tfor (let x = 0; x < 4; x++) {\r\n\t\t\t\tfor (let y = 0; y < 4; y++) {\r\n\t\t\t\t\tconst rgb = this._colorMap[x][y];\r\n\t\t\t\t\tctx.fillStyle = this._rgbToCssString(rgb);\r\n\t\t\t\t\tctx.fillRect(x * blockWidth, y * blockHeight, blockWidth, blockHeight);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn img;\r\n\t\t}\r\n\r\n\t\t_calculateGradientStops() {\r\n\t\t\tlet hs = this._hsMap[this.x][this.y];\r\n\t\t\tconst hslLeft = [hs[0], hs[1], 0.08];\r\n\t\t\tconst hslMiddle = [hs[0], hs[1], 0.5];\r\n\t\t\tconst hslRight = [hs[0], hs[1], 0.92];\r\n\t\t\tconst rgbLeft = stendhal.data.sprites.filter.hsl2rgb(hslLeft);\r\n\t\t\tconst rgbMiddle = stendhal.data.sprites.filter.hsl2rgb(hslMiddle);\r\n\t\t\tconst rgbRight = stendhal.data.sprites.filter.hsl2rgb(hslRight);\r\n\r\n\t\t\treturn [rgbLeft, rgbMiddle, rgbRight];\r\n\t\t}\r\n\r\n\t\t_drawSelection() {\r\n\t\t\tthis.ctx.strokeStyle = \"white\";\r\n\t\t\tthis.ctx.strokeRect(this.x * this._blockWidth, this.y * this._blockHeight, this._blockWidth, this._blockHeight);\r\n\t\t}\r\n\r\n\r\n\t}\r\n\r\n\tconst content = \"<div class='background'>\" +\r\n\t\"<div class='horizontalgroup'>\" +\r\n\r\n\t\"<div class='verticalgroup'>\" + // part selectors\r\n\t\"<div class='horizontalgroup'>\" +\r\n\t\"<button type='button' id='setoutfitprevhair'>&lt;</button>\"+\r\n\t\"<canvas id='setoutfithaircanvas' width='48' height='64'></canvas>\" +\r\n\t\"<button type='button' id='setoutfitnexthair'>&gt;</button>\" +\r\n\t\"</div>\" +\r\n\r\n\t\"<div class='horizontalgroup'>\" +\r\n\t\"<button type='button' id='setoutfitpreveyes'>&lt;</button>\" +\r\n\t\"<canvas id='setoutfiteyescanvas' width='48' height='64'></canvas>\" +\r\n\t\"<button type='button' id='setoutfitnexteyes'>&gt;</button><br>\" +\r\n\t\"</div>\" +\r\n\r\n\t\"<div class='horizontalgroup'>\" +\r\n\t\"<button type='button' id='setoutfitprevmouth'>&lt;</button>\" +\r\n\t\"<canvas id='setoutfitmouthcanvas' width='48' height='64'></canvas>\" +\r\n\t\"<button type='button' id='setoutfitnextmouth'>&gt;</button><br>\" +\r\n\t\"</div>\" +\r\n\r\n\t\"<div class='horizontalgroup'>\" +\r\n\t\"<button type='button' id='setoutfitprevhead'>&lt;</button>\" +\r\n\t\"<canvas id='setoutfitheadcanvas' width='48' height='64'></canvas>\" +\r\n\t\"<button type='button' id='setoutfitnexthead'>&gt;</button><br>\" +\r\n\t\"</div>\" +\r\n\r\n\t\"<div class='horizontalgroup'>\" +\r\n\t\"<button type='button' id='setoutfitprevbody'>&lt;</button>\" +\r\n\t\"<canvas id='setoutfitbodycanvas' width='48' height='64'></canvas>\" +\r\n\t\"<button type='button' id='setoutfitnextbody'>&gt;</button><br>\" +\r\n\t\"</div>\" +\r\n\r\n\t\"<div class='horizontalgroup'>\" +\r\n\t\"<button type='button' id='setoutfitprevdress'>&lt;</button>\" +\r\n\t\"<canvas id='setoutfitdresscanvas' width='48' height='64'></canvas>\" +\r\n\t\"<button type='button' id='setoutfitnextdress'>&gt;</button>\" +\r\n\t\"</div>\" +\r\n\t\"</div>\" + // part selectors\r\n\r\n\t\"<div class='verticalgroup'>\" + // color selectors\r\n\t\"<div class='verticalgroup'>\" +\r\n\t\"<div class='horizontalgroup'>\" +\r\n\t\"<input type='checkbox' id='setoutfithaircolortoggle'>\" +\r\n\t\"<label for='setoutfithaircolortoggle'>Hair color</label>\" +\r\n\t\"</div>\" +\r\n\t\"<canvas id='setoutfithaircolorcanvas' width='80' height='52'></canvas>\" +\r\n\t\"<canvas id='setoutfithaircolorgradient' width='80' height='10'></canvas>\" +\r\n\t\"</div>\" +\r\n\r\n\t\"<div class='verticalgroup'>\" +\r\n\t\"<div class='horizontalgroup'>\" +\r\n\t\"<input type='checkbox' id='setoutfiteyescolortoggle'>\" +\r\n\t\"<label for='setoutfiteyescolortoggle'>Eyes color</label>\" +\r\n\t\"</div>\" +\r\n\t\"<canvas id='setoutfiteyescolorcanvas' width='80' height='52'></canvas>\" +\r\n\t\"<canvas id='setoutfiteyescolorgradient' width='80' height='10'></canvas>\" +\r\n\t\"</div>\" +\r\n\r\n\t\"<div class='verticalgroup'>\" +\r\n\t\"<div class='horizontalgroup'>\" +\r\n\t\"<input type='checkbox' id='setoutfitskincolortoggle'>\" +\r\n\t\"<label for='setoutfitskincolortoggle'>Skin color</label>\" +\r\n\t\"</div>\" +\r\n\t\"<canvas id='setoutfitskincolorcanvas' width='80' height='52'></canvas>\" +\r\n\t\"<canvas id='setoutfitskincolorgradient' width='80' height='10'></canvas>\" +\r\n\t\"</div>\" +\r\n\r\n\t\"<div class='verticalgroup'>\" +\r\n\t\"<div class='horizontalgroup'>\" +\r\n\t\"<input type='checkbox' id='setoutfitdresscolortoggle'>\" +\r\n\t\"<label for='setoutfitdresscolortoggle'>Dress color</label>\" +\r\n\t\"</div>\" +\r\n\t\"<canvas id='setoutfitdresscolorcanvas' width='80' height='52'></canvas>\" +\r\n\t\"<canvas id='setoutfitdresscolorgradient' width='80' height='10'></canvas>\" +\r\n\t\"</div>\" +\r\n\t\"</div>\" + // color selectors\r\n\r\n\t\"<div class='verticalgroup'>\" + // hat & mask part selectors\r\n\r\n\t\"<div class='horizontalgroup'>\" +\r\n\t\"<button type='button' id='setoutfitprevhat'>&lt;</button>\"+\r\n\t\"<canvas id='setoutfithatcanvas' width='48' height='64'></canvas>\" +\r\n\t\"<button type='button' id='setoutfitnexthat'>&gt;</button>\" +\r\n\t\"</div>\" +\r\n\r\n\t\"<div class='horizontalgroup'>\" +\r\n\t\"<button type='button' id='setoutfitprevmask'>&lt;</button>\"+\r\n\t\"<canvas id='setoutfitmaskcanvas' width='48' height='64'></canvas>\" +\r\n\t\"<button type='button' id='setoutfitnextmask'>&gt;</button>\" +\r\n\t\"</div>\" +\r\n\r\n\t\"</div>\" + // hat & mask part selectors\r\n\r\n\t\"<div><canvas id='setoutfitcompositecanvas' width='48' height='64'></canvas></div>\" +\r\n\t\"</div>\" + // horizontal group\r\n\t\"<div align='right'><button type='button' id='setoutfitcancel'>Cancel</button>\" +\r\n\t\"<button type='button' id='setoutfitapply'>Change Outfit</button></div>\" +\r\n\r\n\t\"</div>\"; //bg\r\n\r\n\tfunction indexString(index) {\r\n\t\tif (index > -1 && index < 100) {\r\n\t\t\tif (index < 10) {\r\n\t\t\t\treturn \"00\" + index;\r\n\t\t\t} else {\r\n\t\t\t\treturn \"0\" + index;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn \"\" + index;\r\n\t}\r\n\r\n\tfunction makeSelector(part, index, partChanged) {\r\n\t\t// FIXME: selector should be showing a default if index is less than 0\r\n\t\tif (index < 0) {\r\n\t\t\tindex = 0;\r\n\t\t}\r\n\r\n\t\tconst selector = new PartSelector(part, index, stendhal.ui.outfitCount[part] - 1, partChanged);\r\n\r\n\t\tdocument.getElementById(\"setoutfitprev\" + part).addEventListener(\"click\", function(e) {\r\n\t\t\tselector.previous();\r\n\t\t});\r\n\t\tdocument.getElementById(\"setoutfitnext\" + part).addEventListener(\"click\", function(e) {\r\n\t\t\tselector.next();\r\n\t\t});\r\n\t\tselector.draw();\r\n\r\n\t\treturn selector;\r\n\t}\r\n\r\n\tfunction drawComposite() {\r\n\t\tfunction draw(ctx, selector) {\r\n\t\t\tconst image = selector.image;\r\n\t\t\timage.then((img) => ctx.drawImage(img, -48, -128));\r\n\t\t}\r\n\t\tconst canvas = document.getElementById('setoutfitcompositecanvas');\r\n\t\tconst ctx = canvas.getContext(\"2d\");\r\n\t\tctx.fillStyle = \"white\";\r\n\t\tctx.fillRect(0, 0, canvas.width, canvas.height);\r\n\r\n\t\tvar drawHair = true;\r\n\t\t// hair is not drawn under certain hats/helmets\r\n\t\tif (stendhal.HATS_NO_HAIR !== null && stendhal.HATS_NO_HAIR !== undefined) {\r\n\t\t\tdrawHair = !stendhal.HATS_NO_HAIR.includes(parseInt(hatSelector.index));\r\n\t\t}\r\n\r\n\t\tdraw(ctx, bodySelector);\r\n\t\tdraw(ctx, dressSelector);\r\n\t\tdraw(ctx, headSelector);\r\n\t\tdraw(ctx, mouthSelector);\r\n\t\tdraw(ctx, eyesSelector);\r\n\t\tdraw(ctx, maskSelector);\r\n\t\tif (drawHair) {\r\n\t\t\tdraw(ctx, hairSelector);\r\n\t\t}\r\n\t\tdraw(ctx, hatSelector);\r\n\t}\r\n\r\n\tfunction partChanged() {\r\n\t\tdrawComposite();\r\n\t}\r\n\r\n\tself.popup = new stendhal.ui.Popup(\"Set outfit\", content, 300, 200);\r\n\tself.popup.onClose = function(e) {\r\n\t\tstendhal.ui.OutfitDialog.instance = null;\r\n\t}\r\n\tstendhal.ui.OutfitDialog.instance = self;\r\n\r\n\r\n\tconst outfit = marauroa.me[\"outfit_ext\"];\r\n\r\n\tlet entries = outfit.split(\",\");\r\n\tlet currentOutfit = {};\r\n\tfor (let i = 0; i < entries.length; i++) {\r\n\t\t let entry = entries[i].split(\"=\");\r\n\t\t currentOutfit[entry[0]] = entry[1];\r\n\t}\r\n\r\n\tconst hatSelector = makeSelector(\"hat\", currentOutfit[\"hat\"], partChanged);\r\n\tconst hairSelector = makeSelector(\"hair\", currentOutfit[\"hair\"], partChanged);\r\n\tconst maskSelector = makeSelector(\"mask\", currentOutfit[\"mask\"], partChanged);\r\n\tconst eyesSelector = makeSelector(\"eyes\", currentOutfit[\"eyes\"], partChanged);\r\n\tconst mouthSelector = makeSelector(\"mouth\", currentOutfit[\"mouth\"], partChanged);\r\n\tconst headSelector = makeSelector(\"head\", currentOutfit[\"head\"], partChanged);\r\n\tconst bodySelector = makeSelector(\"body\", currentOutfit[\"body\"], partChanged);\r\n\tconst dressSelector = makeSelector(\"dress\", currentOutfit[\"dress\"], partChanged);\r\n\r\n\tfunction initialColorValue(part) {\r\n\t\tconst colors = marauroa.me[\"outfit_colors\"];\r\n\t\tif (colors != null) {\r\n\t\t\tlet colorName = part;\r\n\t\t\tif (part === \"body\" || part === \"head\") {\r\n\t\t\t\tcolorName = \"skin\";\r\n\t\t\t}\r\n\t\t\treturn colors[colorName];\r\n\t\t}\r\n\t\treturn null;\r\n\t}\r\n\r\n\tfunction createColorSelector(classObject, part, ...partSelectors) {\r\n\t\tconst toggle = document.getElementById(\"setoutfit\" + part + \"colortoggle\");\r\n\t\tconst canvas = document.getElementById(\"setoutfit\" + part + \"colorcanvas\");\r\n\t\tconst gradientCanvas = document.getElementById(\"setoutfit\" + part + \"colorgradient\");\r\n\t\tconst selector = new classObject(canvas, gradientCanvas, (color) => {\r\n\t\t\tfor (const partSelector of partSelectors) {\r\n\t\t\t\tpartSelector.color = color;\r\n\t\t\t}\r\n\t\t});\r\n\t\tconst initialColor = initialColorValue(part);\r\n\t\tif (initialColor != null) {\r\n\t\t\ttoggle.checked = true;\r\n\t\t\tselector.color = initialColor;\r\n\t\t}\r\n\t\ttoggle.addEventListener(\"change\", function(e) {\r\n\t\t\tselector.enabled = toggle.checked;\r\n\t\t});\r\n\t\tselector.draw();\r\n\t\treturn selector;\r\n\t}\r\n\r\n\tconst hairColorSelector = createColorSelector(ColorSelector, \"hair\", hairSelector);\r\n\tconst eyesColorSelector = createColorSelector(ColorSelector, \"eyes\", eyesSelector);\r\n\tconst dressColorSelector = createColorSelector(ColorSelector, \"dress\", dressSelector);\r\n\tconst skinColorSelector = createColorSelector(PaletteColorSelector, \"skin\", headSelector, bodySelector);\r\n\r\n\tdrawComposite();\r\n\r\n\tdocument.getElementById(\"setoutfitcancel\").addEventListener(\"click\", function(e) {\r\n\t\tself.popup.close();\r\n\t});\r\n\tdocument.getElementById(\"setoutfitapply\").addEventListener(\"click\", function(e) {\r\n\t\tconst outfitString =\r\n\t\t\t\t\"body=\" + bodySelector.index.toString() + \",\" +\r\n\t\t\t\t\"dress=\" + dressSelector.index.toString() + \",\" +\r\n\t\t\t\t\"head=\" + headSelector.index.toString() + \",\" +\r\n\t\t\t\t\"mouth=\" + mouthSelector.index.toString() + \",\" +\r\n\t\t\t\t\"eyes=\" + eyesSelector.index.toString() + \",\" +\r\n\t\t\t\t\"mask=\" + maskSelector.index.toString() + \",\" +\r\n\t\t\t\t\"hair=\" + hairSelector.index.toString() + \",\" +\r\n\t\t\t\t\"hat=\" + hatSelector.index.toString();\r\n\r\n\t\tconst action = {\r\n\t\t\t\t\"type\": \"outfit_ext\",\r\n\t\t\t\t\"zone\": marauroa.currentZoneName,\r\n\t\t\t\t\"value\": outfitString\r\n\t\t};\r\n\r\n\t\tlet color = hairColorSelector.color;\r\n\t\tif (color != null) {\r\n\t\t\taction[\"hair\"] = color.toString();\r\n\t\t}\r\n\t\tcolor = eyesColorSelector.color;\r\n\t\tif (color != null) {\r\n\t\t\taction[\"eyes\"] = color.toString();\r\n\t\t}\r\n\t\tcolor = dressColorSelector.color;\r\n\t\tif (color != null) {\r\n\t\t\taction[\"dress\"] = color.toString();\r\n\t\t}\r\n\t\tcolor = skinColorSelector.color;\r\n\t\tif (color != null) {\r\n\t\t\taction[\"skin\"] = color.toString();\r\n\t\t}\r\n\t\tmarauroa.clientFramework.sendAction(action);\r\n\t\tself.popup.close();\r\n\t});\r\n}\r\n","/***************************************************************************\r\n *                   (C) Copyright 2007-2019 - Stendhal                    *\r\n ***************************************************************************\r\n *                                                                         *\r\n *   This program is free software; you can redistribute it and/or modify  *\r\n *   it under the terms of the GNU Affero General Public License as        *\r\n *   published by the Free Software Foundation; either version 3 of the    *\r\n *   License, or (at your option) any later version.                       *\r\n *                                                                         *\r\n ***************************************************************************/\r\n\r\n\"use strict\";\r\n\r\nvar marauroa = window.marauroa = window.marauroa || {};\r\nvar stendhal = window.stendhal = window.stendhal || {};\r\nstendhal.ui = stendhal.ui || {};\r\n\r\n/**\r\n * handling of key presses and releases\r\n */\r\nstendhal.ui.travellog = {\r\n\tcurrentProgressType: \"\",\r\n\r\n\topen: function(dataItems) {\r\n\t\tif (!document.getElementById(\"tavellogpopup\")) {\r\n\t\t\tstendhal.ui.travellog.createWindow(dataItems);\r\n\t\t}\r\n\r\n\t\t// trigger loading of content for first entry\r\n\t\tstendhal.ui.travellog.currentProgressType = dataItems[0];\r\n\t\tvar action = {\r\n\t\t\t\"type\":           \"progressstatus\",\r\n\t\t\t\"progress_type\":  stendhal.ui.travellog.currentProgressType\r\n\t\t}\r\n\t\tmarauroa.clientFramework.sendAction(action);\r\n\t},\r\n\r\n\r\n\tprogressTypeData: function(progressType, dataItems) {\r\n\t\tif (progressType !== stendhal.ui.travellog.currentProgressType) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar html = \"\";\r\n\t\tfor (var i = 0; i < dataItems.length; i++) {\r\n\t\t\thtml += \"<option value=\\\"\" + stendhal.ui.html.esc(dataItems[i]) + \"\\\">\"\r\n\t\t\t\t+ stendhal.ui.html.esc(dataItems[i]) + \"</option>\";\r\n\t\t}\r\n\t\tdocument.getElementById(\"travellogitems\").innerHTML = html;\r\n\r\n\t\t// trigger loading of content for first entry\r\n\t\tif (dataItems) {\r\n\t\t\tdocument.getElementById(\"travellogitems\").value = dataItems[0];\r\n\t\t\tvar action = {\r\n\t\t\t\t\"type\":           \"progressstatus\",\r\n\t\t\t\t\"progress_type\":  progressType,\r\n\t\t\t\t\"item\":           dataItems[0]\r\n\t\t\t}\r\n\t\t\tmarauroa.clientFramework.sendAction(action);\r\n\t\t}\r\n\t},\r\n\r\n\r\n\titemData: function(progressType, selectedItem, description, dataItems) {\r\n\t\tvar html = \"<h3>\" + stendhal.ui.html.esc(selectedItem) + \"</h3>\";\r\n\t\thtml += \"<p id=\\\"travellogdescription\\\">\" + stendhal.ui.html.esc(description) + \"</p>\";\r\n\t\thtml += \"<ul>\";\r\n\t\tfor (var i = 0; i < dataItems.length; i++) {\r\n\t\t\thtml += \"<li>\" + stendhal.ui.html.esc(dataItems[i]);\r\n\t\t}\r\n\t\thtml += \"</ul>\";\r\n\t\tdocument.getElementById(\"travellogdetails\").innerHTML = html;\r\n\t},\r\n\r\n\r\n\tcreateWindow: function(dataItems) {\r\n\t\tvar html = \"<div class=\\\"tavellogpopup\\\">\";\r\n\t\tfor (var i = 0; i < dataItems.length; i++) {\r\n\t\t\thtml += \"<button id=\\\"\" + stendhal.ui.html.esc(dataItems[i]) + \"\\\" class=\\\"progressTypeButton\\\">\"\r\n\t\t\t\t+ stendhal.ui.html.esc(dataItems[i]) + \"</button>\";\r\n\t\t}\r\n\t\thtml += \"<div>\";\r\n\t\thtml += \"<select id=\\\"travellogitems\\\" size=\\\"20\\\"></select>\";\r\n\t\thtml += \"<div id=\\\"travellogdetails\\\"></div>\";\r\n\t\thtml += \"</div>\"\r\n\t\thtml += \"</div>\";\r\n\r\n\t\tvar popup = new stendhal.ui.Popup(\"Travel Log\", html, 160, 50);\r\n\r\n\t\tprogressTypeButtons = document.querySelectorAll(\".progressTypeButton\").forEach(function(button) {\r\n\t\t\tbutton.addEventListener(\"click\", function(e) {\r\n\t\t\t\tstendhal.ui.travellog.currentProgressType = e.target.id;\r\n\t\t\t\tvar action = {\r\n\t\t\t\t\t\"type\":           \"progressstatus\",\r\n\t\t\t\t\t\"progress_type\":  stendhal.ui.travellog.currentProgressType\r\n\t\t\t\t}\r\n\t\t\t\tmarauroa.clientFramework.sendAction(action);\r\n\t\t\t});\r\n\t\t});\r\n\t\tdocument.getElementById(\"travellogitems\").addEventListener(\"change\", function(e) {\r\n\t\t\tvar action = {\r\n\t\t\t\t\"type\":           \"progressstatus\",\r\n\t\t\t\t\"progress_type\":  stendhal.ui.travellog.currentProgressType,\r\n\t\t\t\t\"item\":           e.target.value\r\n\t\t\t}\r\n\t\t\tmarauroa.clientFramework.sendAction(action);\r\n\t\t});\r\n\r\n\t\treturn popup;\r\n\t}\r\n}\r\n","/***************************************************************************\r\n *                    Copyright 2003-2020 \u00a9 - Stendhal                     *\r\n ***************************************************************************\r\n *                                                                         *\r\n *   This program is free software; you can redistribute it and/or modify  *\r\n *   it under the terms of the GNU Affero General Public License as        *\r\n *   published by the Free Software Foundation; either version 3 of the    *\r\n *   License, or (at your option) any later version.                       *\r\n *                                                                         *\r\n ***************************************************************************/\r\n\r\n\"use strict\";\r\n\r\nwindow.marauroa = window.marauroa || {};\r\nwindow.stendhal = window.stendhal || {};\r\nstendhal.ui = stendhal.ui || {};\r\n\r\nstendhal.ui.settings = {\r\n\r\n\t// FIXME: needs to open a popup for the settings menu\r\n\tonOpenSettingsMenu: function(e) {\r\n\t\t// DEBUG:\r\n\t\tconsole.log(\"FIXME: not yet functional\");\r\n\r\n\t\t/*\r\n\t\tif (stendhal.ui.globalpopup) {\r\n\t\t\tstendhal.ui.globalpopup.popup.close();\r\n\t\t}\r\n\r\n\t\tvar content = \"<div class=\\\"settingsmenu\\\"></div>\";\r\n\t\tthis.popup = new stendhal.ui.Popup(\"Settings\", content, 150, 150);\r\n\r\n\t\tthis.close = function() {\r\n\t\t\tthis.popup.close();\r\n\t\t\tstendhal.ui.globalpopup = null;\r\n\t\t}\r\n\t\tstendhal.ui.globalpopup = this;\r\n\t\t//this.popup.open();\r\n\r\n\t\t//stendhal.ui.globalpopup.popup.open();\r\n\t\t*/\r\n\t}\r\n}\r\n","/***************************************************************************\r\n *                   (C) Copyright 2003-2021 - Stendhal                    *\r\n ***************************************************************************\r\n *                                                                         *\r\n *   This program is free software; you can redistribute it and/or modify  *\r\n *   it under the terms of the GNU Affero General Public License as        *\r\n *   published by the Free Software Foundation; either version 3 of the    *\r\n *   License, or (at your option) any later version.                       *\r\n *                                                                         *\r\n ***************************************************************************/\r\n\r\n\"use strict\";\r\n\r\nvar marauroa = window.marauroa = window.marauroa || {};\r\nvar stendhal = window.stendhal = window.stendhal || {};\r\n\r\nstendhal.main = {\r\n\terrorCounter: 0,\r\n\tzoneFile: null,\r\n\tloaded: false,\r\n\r\n\tonDataMap: function(data) {\r\n\t\tvar zoneinfo = {};\r\n\t\tvar deserializer = marauroa.Deserializer.fromBase64(data);\r\n\t\tdeserializer.readAttributes(zoneinfo);\r\n\t\tdocument.getElementById(\"zoneinfo\").textContent = zoneinfo[\"readable_name\"];\r\n\t\tstendhal.main.zoneFile = zoneinfo[\"file\"];\r\n\t\t// Object { file: \"Level 0/semos/city_easter.tmx\", danger_level: \"0.036429932929822995\", zoneid: \"\", readable_name: \"Semos city\", id: \"-1\", color_method: \"multiply\" }\r\n\t},\r\n\r\n\r\n\t/**\r\n\t * register marauroa event handlers.\r\n\t */\r\n\tregisterMarauroaEventHandlers: function() {\r\n\r\n\t\tmarauroa.clientFramework.onDisconnect = function(reason, error){\r\n\t\t\tstendhal.ui.chatLog.addLine(\"error\", \"Disconnected: \" + error);\r\n\t\t};\r\n\r\n\t\tmarauroa.clientFramework.onLoginRequired = function() {\r\n\t\t\twindow.location = \"/index.php?id=content/account/login&url=\"\r\n\t\t\t\t+ escape(window.location.pathname + window.location.hash);\r\n\t\t};\r\n\r\n\t\tmarauroa.clientFramework.onLoginFailed = function(reason, text) {\r\n\t\t\talert(\"Login failed. Please login on the Stendhal website first and make sure you open the client on an https://-URL\");\r\n\t\t\tmarauroa.clientFramework.close();\r\n\t\t\tdocument.getElementById(\"chatinput\").disabled = true;\r\n\t\t\tdocument.getElementById(\"chat\").style.backgroundColor = \"#AAA\";\r\n\t\t};\r\n\r\n\t\tmarauroa.clientFramework.onAvailableCharacterDetails = function(characters) {\r\n\t\t\tvar name = null;\r\n\t\t\tif (window.location.hash) {\r\n\t\t\t\tname = window.location.hash.substring(1);\r\n\t\t\t} else {\r\n\t\t\t\tname = marauroa.util.first(characters)[\"a\"][\"name\"];\r\n\t\t\t\tvar admin = 0;\r\n\t\t\t\tfor (var i in characters) {\r\n\t\t\t\t\tif (characters.hasOwnProperty(i)) {\r\n\t\t\t\t\t\tif (characters[i][\"a\"][\"adminlevel\"] > admin) {\r\n\t\t\t\t\t\t\tadmin = characters[i][\"a\"][\"adminlevel\"];\r\n\t\t\t\t\t\t\tname = characters[i][\"a\"][\"name\"];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tmarauroa.clientFramework.chooseCharacter(name);\r\n\t\t\tvar body = document.getElementById(\"body\")\r\n\t\t\tbody.style.cursor = \"auto\";\r\n\t\t\tstendhal.ui.chatLog.addLine(\"client\", \"Loading world...\");\r\n\t\t};\r\n\r\n\r\n\t\tmarauroa.clientFramework.onTransferREQ = function(items) {\r\n\t\t\tfor (var i in items) {\r\n\t\t\t\tif (typeof(items[i][\"name\"]) == \"undefined\") {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\titems[i][\"ack\"] = true;\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tmarauroa.clientFramework.onTransfer = function(items) {\r\n\t\t\tvar data = {};\r\n\t\t\tvar zoneName = \"\"\r\n\t\t\tfor (var i in items) {\r\n\t\t\t\tvar name = items[i][\"name\"];\r\n\t\t\t\tzoneName = name.substring(0, name.indexOf(\".\"));\r\n\t\t\t\tname = name.substring(name.indexOf(\".\") + 1);\r\n\t\t\t\tdata[name] = items[i][\"data\"];\r\n\t\t\t\tif (name === \"data_map\") {\r\n\t\t\t\t\tstendhal.main.onDataMap(items[i][\"data\"]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tstendhal.data.map.onTransfer(zoneName, data);\r\n\t\t};\r\n\r\n\t\t// update user interface on perceptions\r\n\t\tif (document.getElementById(\"gamewindow\")) {\r\n\t\t\tmarauroa.perceptionListener.onPerceptionEnd = function(type, timestamp) {\r\n\t\t\t\tstendhal.zone.sortEntities();\r\n\t\t\t\tstendhal.ui.minimap.draw();\r\n\t\t\t\tstendhal.ui.buddyList.update();\r\n\t\t\t\tstendhal.ui.equip.update();\r\n\t\t\t\tstendhal.ui.stats.update();\r\n\t\t\t\tif (!stendhal.main.loaded) {\r\n\t\t\t\t\tstendhal.main.loaded = true;\r\n\t\t\t\t\t// delay visibile change of client a little to allow for initialisation in the background for a smoother experience\r\n\t\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\t\tdocument.getElementById(\"client\").style.display = \"block\";\r\n\t\t\t\t\t\tdocument.getElementById(\"loginpopup\").style.display = \"none\";\r\n\t\t\t\t\t}, 300);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\ttoggleSound: function() {\r\n\t\tstendhal.config.sound.play = !stendhal.config.sound.play;\r\n\r\n\t\tstendhal.main.onSoundToggled();\r\n\t},\r\n\r\n\tonSoundToggled: function() {\r\n\t\tvar soundbutton = document.getElementById(\"soundbutton\");\r\n\t\tif (stendhal.config.sound.play) {\r\n\t\t\tsoundbutton.textContent = \"\ud83d\udd0a\";\r\n\t\t} else {\r\n\t\t\tsoundbutton.textContent = \"\ud83d\udd07\";\r\n\t\t}\r\n\t},\r\n\r\n\t/**\r\n\t * registers global browser event handlers.\r\n\t */\r\n\tregisterBrowserEventHandlers: function() {\r\n\t\tdocument.addEventListener(\"keydown\", stendhal.ui.keyhandler.onKeyDown);\r\n\t\tdocument.addEventListener(\"keyup\", stendhal.ui.keyhandler.onKeyUp);\r\n\t\tdocument.addEventListener(\"contextmenu\", stendhal.main.preventContextMenu);\r\n\r\n\t\tvar gamewindow = document.getElementById(\"gamewindow\");\r\n\t\tgamewindow.setAttribute(\"draggable\", true);\r\n\t\tgamewindow.addEventListener(\"mousedown\", stendhal.ui.gamewindow.onMouseDown);\r\n\t\tgamewindow.addEventListener(\"touchstart\", stendhal.ui.gamewindow.onMouseDown);\r\n\t\tgamewindow.addEventListener(\"dblclick\", stendhal.ui.gamewindow.onMouseDown);\r\n\t\tgamewindow.addEventListener(\"dragstart\", stendhal.ui.gamewindow.onDragStart);\r\n\t\tgamewindow.addEventListener(\"mousemove\", stendhal.ui.gamewindow.onMouseMove);\r\n\t\tgamewindow.addEventListener(\"touchmove\", stendhal.ui.gamewindow.onMouseMove);\r\n\t\tgamewindow.addEventListener(\"dragover\", stendhal.ui.gamewindow.onDragOver);\r\n\t\tgamewindow.addEventListener(\"drop\", stendhal.ui.gamewindow.onDrop);\r\n\t\tgamewindow.addEventListener(\"contextmenu\", stendhal.ui.gamewindow.onContentMenu);\r\n\r\n\t\tvar minimap = document.getElementById(\"minimap\");\r\n\t\tminimap.addEventListener(\"click\", stendhal.ui.minimap.onClick);\r\n\t\tminimap.addEventListener(\"dblclick\", stendhal.ui.minimap.onClick);\r\n\r\n\t\tvar buddyList = document.getElementById(\"buddyList\");\r\n\t\tbuddyList.addEventListener(\"mouseup\", stendhal.ui.buddyList.onMouseUp);\r\n\t\tbuddyList.addEventListener(\"contextmenu\", stendhal.ui.gamewindow.onContentMenu);\r\n\r\n\t\tvar menubutton = document.getElementById(\"menubutton\");\r\n\t\tmenubutton.addEventListener(\"click\", stendhal.ui.menu.onOpenAppMenu);\r\n\r\n\t\tvar soundbutton = document.getElementById(\"soundbutton\");\r\n\t\tsoundbutton.addEventListener(\"click\", stendhal.main.toggleSound);\r\n\t\t// update button state\r\n\t\tstendhal.main.onSoundToggled();\r\n\r\n\t\tvar chatinput = document.getElementById(\"chatinput\");\r\n\t\tchatinput.addEventListener(\"keydown\", stendhal.ui.chatinput.onKeyDown);\r\n\t\tchatinput.addEventListener(\"keypress\", stendhal.ui.chatinput.onKeyPress);\r\n\t},\r\n\r\n\tdevWarning: function() {\r\n\t\tconsole.log(\"%c \", \"padding: 30px; background: url(\" + window.location.protocol + \"://\" + window.location.host + \"/images/buttons/devtools-warning.png) no-repeat; color: #AF0\");\r\n\t\tconsole.log(\"%cIf someone told you, to copy and paste something here, it's a scam and will give them access to your account.\", \"color:#A00; background-color:#FFF\");\r\n\t\tconsole.log(\"If you are a developer and curious about Stendhal, have a look at https://stendhalgame.org/development/introduction.html to get the source code. And perhaps, contribute a feature or a bugfix. \");\r\n\t\tconsole.log(\"\");\r\n\t\tconsole.log(\"\");\r\n\t\twindow[\"eval\"] = undefined;\r\n\t},\r\n\r\n\t/**\r\n\t * starts the Stendhal web client and connects to the Stendhal server.\r\n\t */\r\n\tstartup: function() {\r\n\t\tstendhal.main.devWarning();\r\n\r\n\t\tstendhal.ui.chatLog.addLine(\"error\", \"This is an early stage of an experimental web-based client. Please use the official client at https://stendhalgame.org to play Stendhal.\");\r\n\t\tstendhal.ui.chatLog.addLine(\"client\", \"Client loaded. Connecting...\");\r\n\r\n\t\tstendhal.main.registerMarauroaEventHandlers();\r\n\t\tstendhal.main.registerBrowserEventHandlers();\r\n\t\tmarauroa.clientFramework.connect(null, null);\r\n\r\n\t\tif (document.getElementById(\"gamewindow\")) {\r\n\t\t\tstendhal.ui.gamewindow.draw.apply(stendhal.ui.gamewindow, arguments);\r\n\t\t}\r\n\t},\r\n\r\n\tonerror: function(error) {\r\n\t\tstendhal.main.errorCounter++;\r\n\t\tif (stendhal.main.errorCounter > 5) {\r\n\t\t\tconsole.log(\"Too many errors, stopped reporting\");\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar text = error.message + \"\\r\\n\";\r\n\t\ttext += error.filename + \":\" + error.lineno;\r\n\t\tif (error.colno) {\r\n\t\t\ttext += \":\" + error.colno;\r\n\t\t}\r\n\t\tif (error.error) {\r\n\t\t\ttext += \"\\r\\n\" + error.error.stack;\r\n\t\t}\r\n\t\ttext += \"\\r\\n\" + window.navigator.userAgent;\r\n\t\ttry {\r\n\t\t\tconsole.log(text);\r\n\t\t\tvar action = {\r\n\t\t\t\t\"type\": \"report_error\",\r\n\t\t\t\t\"text\": text,\r\n\t\t\t};\r\n\t\t\tmarauroa.clientFramework.sendAction(action);\r\n\t\t} catch (e) {\r\n\t\t\t// ignore\r\n\t\t}\r\n\t\treturn true;\r\n\t},\r\n\r\n\tpreventContextMenu: function(event) {\r\n\t\tevent.preventDefault();\r\n\t}\r\n}\r\n\r\ndocument.addEventListener('DOMContentLoaded', stendhal.main.startup);\r\nwindow.addEventListener('error', stendhal.main.onerror);\r\n"],
"names":["$jscomp.arrayIteratorImpl","$jscomp.objectCreate","$jscomp.defineProperty","$jscomp.global","$jscomp.getGlobal","$jscomp.setPrototypeOf","$jscomp.polyfill","$jscomp.makeIterator","$jscomp.typedArrayFill","$jscomp.iteratorPrototype","$jscomp.iteratorFromArray","marauroa","window","debug","messages","unknownEvents","console","log","window.console.log","info","window.console.info","warn","window.console.warn","error","window.console.error","text","alert","util","isEmpty","obj","i","hasOwnProperty","isEmptyExceptId","first","fromProto","proto","def","F","prototype","merge","a","b","key","clientFramework","clientid","connect","host","port","protocol","location","hostname","socket","WebSocket","onmessage","onMessage","onopen","socket.onopen","setInterval","sendMessage","msg","onConnect","onclose","onDisonnect","reason","onDisconnect","onLoginRequired","login","username","password","onServerInfo","contents","onPreviousLogins","previousLogins","onLoginFailed","e","JSON","parse","data","messageFactory","addDispatchMethod","dispatch","myMessage","send","stringify","resync","chooseCharacter","character","onChooseCharacterNack","sendAction","action","logout","onLogoutOutAck","onLogoutOutNack","close","onPerception","perceptionMessage","perceptionHandler","apply","onTransferREQ","items","onTransfer","onAvailableCharacterDetails","characters","createCharacter","createAccount","email","onCreateAccountAck","onCreateAccountNack","charname","template","onCreateCharacterAck","onCreateCharacterNack","eval","unknownMessage","this.unknownMessage","this.addDispatchMethod","t","perceptionListener","onAdded","onModifiedAdded","onModifiedDeleted","onDeleted","onMyRPObject","onClear","onPerceptionBegin","onPerceptionEnd","onException","exception","perception","currentZone","clear","destroy","currentZoneName","applyPerceptionAddedRPObjects","applyPerceptionModifiedRPObjects","applyPerceptionDeletedRPObjects","applyPerceptionMyRPObject","o","rpobjectFactory","create","addChanges","tmp","deleteChanges","id","addMyRPObjectToWorldIfPrivate","me","added","object","diff","unset","del","j","unsetMapEntry","set","setMapEntry","createSlot","get","newObject","_parent","add","onEvent","event","rpeventFactory","slot","execute","value","map","name","rpslotFactory","init","this.create","rpclass","ctor","temp","rpobject","_objects","push","idx","getIndex","getByIndex","count","length","c","splice","_name","r","d","split","aa","execScript","shift","k","u","Number","POSITIVE_INFINITY","l","p","s","f","Uint32Array","Array","g","h","n","m","x","w","input","Uint8Array","y","index","bufferSize","bufferType","resize","A","Error","B","D","Uint16Array","DataView","w.prototype.t","subarray","ba","ca","C","M","T","q","Q","v","z","R","slice","S","E","G","H","I","J","K","L","N","O","P","da","U","V","W","ea","w.prototype.j","w.prototype.s","w.prototype.e","w.prototype.u","w.prototype.m","buffer","w.prototype.r","X","ADAPTIVE","BLOCK","fa","Object","keys","Y","Z","$","call","Deserializer","marauroa.Deserializer","offset","view","readShort","this.readShort","getInt16","readInt","this.readInt","getInt32","readByteArray","this.readByteArray","size","getUint32","readString","this.readString","decode","TextDecoder","readAttributes","this.readAttributes","code","binaryStringToUint","marauroa.Deserializer.binaryStringToUint","binary","len","bytes","charCodeAt","fromDeflatedBase64","marauroa.Deserializer.fromDeflatedBase64","base64","atob","substring","inflate","fromBase64","marauroa.Deserializer.fromBase64","fromBinaryString","marauroa.Deserializer.fromBinaryString","stendhal","config","sound","play","gamescreen","blood","build","version","dist","JXG","Util","Unzip","JXG.Util.Unzip","fpos","Base64","_keyStr","encode","output","_utf8_encode","chr1","chr2","chr3","enc1","enc2","enc3","enc4","isNaN","charAt","join","utf8","replace","indexOf","String","fromCharCode","_utf8_decode","string","utftext","c2","c3","_destrip","stripped","wrap","lines","destripped","lineno","substr","decodeAsArray","dec","ar","decodeGEONExT","destrip","asciiCharCodeAt","JXG.Util.asciiCharCodeAt","str","utf8Decode","JXG.Util.utf8Decode","cache","requestAllItems","storeName","callback","tx","db","transaction","IDBTransaction","READ_ONLY","store","objectStore","oncomplete","tx.oncomplete","cursorRequest","openCursor","onerror","cursorRequest.onerror","onsuccess","cursorRequest.onsuccess","evt","cursor","target","result","continue","sync","indexedDB","open","onupgradeneeded","open.onupgradeneeded","createObjectStore","keyPath","open.onsuccess","put","toString","Math","random","open.onerror","cstatus","setTimeout","group","members","lootmode","leader","updateGroupStatus","memberArray","ImagePreloader","images","nProcessed","nLoaded","aImages","nImages","oImage","Image","onload","onabort","oImagePreloader","preload","bLoaded","src","image","ImagePreloader.prototype.onComplete","ImagePreloader.prototype.onload","onComplete","ImagePreloader.prototype.onerror","ImagePreloader.prototype.onabort","offsetX","offsetY","zoneSizeX","zoneSizeY","sizeX","sizeY","tileWidth","tileHeight","zoom","layerNames","layers","firstgids","drawingError","targetTileWidth","targetTileHeight","getTilesetForGid","gidsindex","zoneName","content","document","getElementById","body","style","decodeTileset","decodeMapLayer","protection","collisionData","deserializer","layerData","amount","source","firstgid","filename","pos","lastStart","parseInt","layerRaw","layer","tileId","getUint8","collision","isProtected","encoding","numRounds","lastIndexOf","update","this.update","binLen","search","ArrayBuffer","byteLength","define","amd","exports","module","jsSHA","sprites","counter","getWithPromise","Promise","resolve","image.onload","clean","getAreaOf","width","height","canvas","createElement","getContext","ctx","drawImage","newImage","toDataURL","getFiltered","fileName","filter","param","img","filterFn","filteredName","filtered","imgData","getImageData","putImageData","getFilteredWithPromise","imgPromise","then","splitrgb","rgb","mergergb","rgbArray","rgb2hsl","max","min","maxVar","hsl2rgb","hsl","floor","tmp1","tmp2","gf","hue2rgb","limitHue","bf","rf","hue","val1","val2","res","color","hslColor","end","resultRgb","resultHsl","minimapShow","minimapStyle","zIndex","arguments","isNextTo","other","isVisibleToAction","actionAliasToAction","actionAlias","actionAliases","actionCommand","buildActions","list","title","type","toLowerCase","ui","html","niceName","updatePosition","draw","sprite","drawSprite","drawSpriteAt","drawOutlineText","lineWidth","strokeStyle","fillStyle","lineJoin","strokeText","fillText","getIdPath","say","isInHearingRange","chatLog","addLine","getCursor","getDefaultAction","getResistance","isObstacle","entity","onclick","that","autoOpenedAlready","fFilename","autoOpenIfDesired","closeCorpseInventory","inventory","openCorpseInventory","popupdiv","parentNode","content_row","content_col","content_count","ceil","equip","createInventoryWindow","OPEN_SPRITE","CLOSED_SPRITE","openInventoryWindow","_amount","undefined","_image","yStart","drawAt","formatQuantity","measureText","textMetrics","time","serverX","parseFloat","serverY","oldX","oldY","movement","abs","collidesMap","collidesEntities","startX","endX","endY","startY","thisStartX","thisStartY","thisEndX","thisEndY","zone","entities","otherStartX","otherStartY","otherEndY","otherEndX","HATS_NO_HAIR","drawY","spritePath","titleStyle","_target","attackSprite","attackResult","dir","oldValue","onHPChanged","onAttackStopped","onTargeted","addFloater","onXPChanged","isAdmin","getTitle","match","addSpeechBubble","gamewindow","addTextSprite","realText","timeStamp","Date","now","font","strokeRect","fillRect","beginPath","moveTo","lineTo","stroke","closePath","fill","drawMultipartOutfit","outfit","part","includes","getOutfitPart","colors","colorname","drawCombat","drawAttack","drawFloaters","drawStatusIcons","drawAnimatedIcon","iconPath","delay","icon","dim","drawAnimatedIconWithFrames","nFrames","xdim","ydim","attackers","ellipse","Function","xRad","yRad","SQRT2","centerX","centerY","PI","getAttackTarget","topY","currentFloaters","floaters","floater","localX","localY","nDirections","yRow","frame","drawX","animLength","drawTop","drawHealthBar","drawTitle","HEALTH_BAR_HEIGHT","rect","hpRatio","concat","red","green","expired","onDamaged","createResultIcon","sounds","playLocalizedEffect","onBlocked","onMissed","change","message","self","initTime","textOffset","timeDiff","imagePath","onAttackPerformed","nature","ranged","tgt","targetX","targetY","entityWidth","entityHeight","yLength","xLength","drawHeight","drawWidth","attacker","stats","dirty","playerName","isUnknown","isIgnored","OutfitDialog","largeWeight","entityAt","ground","sortEntities","sort","entity1","entity2","rv","calculateZoneChangeDirection","worldX","worldY","dblclick","gameX","gameY","extend","setDragImageIEPreload","window.setDragImageIEPreload","bodyEl","preloadEl","background","position","opacity","appendChild","removeChild","DataTransfer","setDragImage","DataTransfer.prototype.setDragImage","randomDraggingClassName","round","pow","dragStylesCSS","dragStylesEl","innerText","headEl","getElementsByTagName","eventTarget","classList","remove","buddyList","buddies","buddy","entry","isOnline","status","esc","lastHtml","buddyListUL","innerHTML","compare","setBuddyStatus","removeBuddy","newEntry","hasBuddy","arrayLength","actions","current","className","chatinput","setText","textContent","trim","onMouseUp","tagName","parentElement","stendhal.ui.Menu","pageX","pageY","chatElement","date","getHours","getMinutes","div","formatLogEntry","isAtBottom","scrollHeight","clientHeight","scrollTop","delims","inHighlight","inUnderline","inHighlightQuote","inUnderlineQuote","textSprites","startTime","getTime","visibilityState","globalAlpha","adjustView","tileOffsetX","tileOffsetY","drawingLayer","paintLayer","drawEntities","drawEntitiesTop","drawTextSprites","yMax","xMax","gid","flip","tileset","base","drawTile","tilesPerRow","pixelX","pixelY","translate","restore","transform","reverse","args","currentTime","setTransform","onMouseDown","extractPosition","timestampMouseDown","which","button","cleanUp","focus","preventDefault","onDrag","xDiff","yDiff","removeEventListener","_onMouseDown","globalpopup","addEventListener","onMouseMove","onDragStart","draggedEntity","dataTransfer","setData","path","onDragOver","dropEffect","onDrop","datastr","getData","test","drop","ctrlKey","stendhal.ui.DropNumberDialog","stopPropagation","onContentMenu","extractKeyCode","keyCode","toUpperCase","changedTouches","offsetLeft","offsetTop","minimap","titleHeight","minimumScale","zoneChange","mapWidth","mapHeight","scale","createBackgroundImage","updateBasePosition","xOffset","yOffset","imageWidth","imageHeight","xpos","ypos","drawBackground","save","imageSmoothingEnabled","mozImageSmoothingEnabled","msImageSmoothingEnabled","bgImage","lastZone","createImageData","onClick","keyhandler","pressedKeys","extractMoveOrFaceActionFromEvent","shiftKey","extractDirectionFromKeyCode","onKeyDown","altKey","metaKey","activeElement","localName","onKeyUp","radius","soundName","volume","xdist","ydist","dist2","Audio","autoplay","playGlobalizedEffect","history","historyIndex","fromHistory","onKeyPress","remember","val","array","slashActionRepository","params","getMinParams","getMaxParams","remainder","killtype","creature","quantity","duration","lastPlayerTell","state","settings","onOpenSettingsMenu","nameBuilder","url","line","Boolean","damage","stendhal.ui.ImageViewer","progressType","dataItems","travellog","itemData","progressTypeData","header","hasRare","hasAbnormal","subheader","enemies","shared","solo","stendhal.ui.Popup","onMouseMovedDuringDrag","left","clientX","top","clientY","onMouseUpDuringDrag","this.close","onClose","popupcontainer","contains","querySelector","box","getBoundingClientRect","pageXOffset","pageYOffset","closeSound","popup","caption","stendhal.ui.ItemContainerWindow","suffix","quickPickup","defaultImage","myobject","item","slotNumber","onContextMenu","dataItem","cnt","backgroundImage","setAttribute","slotNames","slotSizes","slotImages","pouchVisible","showPouch","features","itemContainer","popup.onClose","showSlot","stendhal.ui.showSlot","show","prevState","display","stendhal.ui.showPouch","menu","onOpenAppMenu","children","cmd","outfitCount","stendhal.ui.OutfitDialog","indexString","makeSelector","partChanged","selector","PartSelector","previous","next","drawComposite","drawHair","hatSelector","bodySelector","dressSelector","headSelector","mouthSelector","eyesSelector","maskSelector","hairSelector","initialColorValue","colorName","createColorSelector","classObject","$jscomp.getRestArguments.apply","toggle","gradientCanvas","partSelectors","partSelector","initialColor","checked","enabled","instance","constructor","initialIndex","maxindex","onPartChanged","_part","_onPartChanged","_index","_maxindex","margin","_ctx","_width","_height","_color","_getPartSprite","numOutfits","fname","$jscomp.global.Object.defineProperties","newIndex","newColor","ColorSelector","onColorChanged","gradCtx","baseImage","_createBaseImage","_enabled","hX","_onMouseMove","_onMouseDownGrad","_onMouseMoveGrad","_rgbToCssString","_drawSelection","_drawGradientPart","gradient","createLinearGradient","stops","_calculateGradientStops","addColorStop","rgbLeft","hslLeft","rgbMiddle","hslMiddle","rgbRight","hslRight","buttons","PaletteColorSelector","_blockWidth","_blockHeight","_x","_y","_colorMap","_hsMap","$jscomp.inherits","_createColorMap","hues","saturations","hsMap","sat","blockWidth","blockHeight","hs","newX","newY","bestDelta","MAX_VALUE","hueDelta","satDelta","delta","self.popup.onClose","entries","currentOutfit","hairColorSelector","eyesColorSelector","dressColorSelector","skinColorSelector","currentProgressType","createWindow","selectedItem","description","progressTypeButtons","querySelectorAll","forEach","main","errorCounter","zoneFile","loaded","onDataMap","zoneinfo","registerMarauroaEventHandlers","marauroa.clientFramework.onDisconnect","marauroa.clientFramework.onLoginRequired","escape","pathname","hash","marauroa.clientFramework.onLoginFailed","disabled","backgroundColor","marauroa.clientFramework.onAvailableCharacterDetails","admin","marauroa.clientFramework.onTransferREQ","marauroa.clientFramework.onTransfer","marauroa.perceptionListener.onPerceptionEnd","toggleSound","onSoundToggled","soundbutton","registerBrowserEventHandlers","preventContextMenu","menubutton","devWarning","startup","colno","stack","navigator","userAgent"]
}
